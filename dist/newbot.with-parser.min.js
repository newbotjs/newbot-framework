!function(t){var e={};function n(r){if(e[r])return e[r].exports;var s=e[r]={i:r,l:!1,exports:{}};return t[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(r,s,function(e){return t[e]}.bind(null,s));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=277)}([function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e,n){var r=n(48),s="object"==typeof self&&self&&self.Object===Object&&self,i=r||s||Function("return this")();t.exports=i},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){var r=n(9),s=n(99),i=n(100),u="[object Null]",o="[object Undefined]",a=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?o:u:a&&a in Object(t)?s(t):i(t)}},function(t,e,n){const r=n(240),s=n(225),i=n(242),u=n(226),o=n(83),{Container:a,defaultContainer:c}=n(6),l=n(82),p=n(227),h=n(228),f=n(229),g=n(81),d=n(230),A=n(80),{hasUnicode:m,unicodeToArray:v,asciiToArray:E,stringToArray:y,compareWildcars:C,loadEnv:b}=n(79),F=n(231),x=n(244),D=n(245),_=n(246);t.exports={Among:r,ArrToObj:s,BaseStemmer:i,containerBootstrap:u,Clonable:o,Container:a,defaultContainer:c,hasUnicode:m,unicodeToArray:v,asciiToArray:E,stringToArray:y,compareWildcars:C,loadEnv:b,Normalizer:l,ObjToArr:p,Stemmer:h,Stopwords:f,Tokenizer:g,Timer:d,logger:A,MemoryStorage:F,uuid:x,dock:D,Context:_,dockStart:async function(t,e){return await D.start(t,e),D}}},function(t,e,n){const{compareWildcars:r}=n(79),s=n(241),i=n(80);class u{constructor(t=!1){this.classes={},this.factory={},this.pipelines={},this.configurations={},this.compilers={},this.registerCompiler(s),t||this.use(i)}registerCompiler(t,e){const n=new t(this);this.compilers[e||n.name]=n}addClass(t,e){this.classes[e||t.name]=t}toJSON(t){const e=t.toJSON?t.toJSON():{...t};return e.className=t.constructor.name,e}fromJSON(t,e){const n=this.classes[t.className];let r;return n?(r=new n(e),r.fromJSON?r.fromJSON(t):Object.assign(r,t)):r={...t},delete r.className,r}register(t,e,n=!0){const r="function"==typeof e,s={name:t,isSingleton:n};s.instance=n?r?new e:e:r?e:e.constructor,this.factory[t]=s}getBestKey(t,e){for(let n=0;n<e.length;n+=1)if(r(t,e[n]))return e[n]}get(t,e){let n=this.factory[t];if(!n){if(this.parent)return this.parent.get(t,e);const r=this.getBestKey(t,Object.keys(this.factory));if(r&&(n=this.factory[r]),!n)return}if(n.isSingleton)return n.instance&&n.instance.applySettings&&n.instance.applySettings(n.instance.settings,e),n.instance;return new(0,n.instance)(e,this)}buildLiteral(t,e,n,r){return{type:"literal",subtype:t,src:e,value:n,context:r,container:this}}resolvePathWithType(t,e,n,r){const s=t.split(".");let i=s[0].trim();if(i||(i=t.startsWith(".")?"this":"context"),/^\d+$/.test(i))return this.buildLiteral("number",t,parseFloat(i),e);if(i.startsWith('"'))return this.buildLiteral("string",t,i.replace(/^"(.+(?="$))"$/,"$1"),e);if(i.startsWith("'"))return this.buildLiteral("string",t,i.replace(/^'(.+(?='$))'$/,"$1"),e);if("true"===i)return this.buildLiteral("boolean",t,!0,e);if("false"===i)return this.buildLiteral("boolean",t,!1,e);let u=e;"input"===i||"output"===i?u=n:i&&"context"!==i&&"this"!==i?u=this.get(i)||u[i]:i&&"context"===i?u=e:"this"===i&&(u=r);for(let e=1;e<s.length;e+=1){const n=s[e];if((!u||!u[n])&&e<s.length-1)throw Error(`Path not found in pipeline "${t}"`);const r=u;u=u[n],"function"==typeof u&&(u=u.bind(r))}return"function"==typeof u?{type:"function",src:t,value:u,context:e,container:this}:{type:"reference",src:t,value:u,context:e,container:this}}resolvePath(t,e,n,r){const s=this.resolvePathWithType(t,e,n,r);return s?s.value:s}setValue(t,e,n,r,s){const i=this.resolvePath(e,n,r,s),u=t.split("."),o=u.slice(0,-1).join(".");this.resolvePath(o,n,r,s)[u[u.length-1]]=i}incValue(t,e,n,r,s){const i=this.resolvePath(e,n,r,s),u=t.split(".");t.startsWith(".")&&u.push("this");const o=u.slice(0,-1).join(".");this.resolvePath(o,n,r,s)[u[u.length-1]]+=i}decValue(t,e,n,r,s){const i=this.resolvePath(e,n,r,s),u=t.split("."),o=u.slice(0,-1).join(".");this.resolvePath(o,n,r,s)[u[u.length-1]]-=i}eqValue(t,e,n,r,s){const i=n,u=this.resolvePath(t,i,r,s),o=this.resolvePath(e,i,r,s);i.floating=u===o}neqValue(t,e,n,r,s){const i=n,u=this.resolvePath(t,i,r,s),o=this.resolvePath(e,i,r,s);i.floating=u!==o}gtValue(t,e,n,r,s){const i=n,u=this.resolvePath(t,i,r,s),o=this.resolvePath(e,i,r,s);i.floating=u>o}geValue(t,e,n,r,s){const i=n,u=this.resolvePath(t,i,r,s),o=this.resolvePath(e,i,r,s);i.floating=u>=o}ltValue(t,e,n,r,s){const i=n,u=this.resolvePath(t,i,r,s),o=this.resolvePath(e,i,r,s);i.floating=u<o}leValue(t,e,n,r,s){const i=n,u=this.resolvePath(t,i,r,s),o=this.resolvePath(e,i,r,s);i.floating=u<=o}deleteValue(t,e,n,r){const s=t.split("."),i=s.slice(0,-1).join(".");delete this.resolvePath(i,e,n,r)[s[s.length-1]]}getValue(t="floating",e,n,r){const s=t.split("."),i=s.slice(0,-1).join(".");return this.resolvePath(i,e,n,r)[s[s.length-1]]}async runPipeline(t,e,n,r=0){if(r>10)throw new Error("Pipeline depth is too high: perhaps you are using recursive pipelines?");const s="string"==typeof t?this.getPipeline(t):t;if(!s)throw new Error(`Pipeline not found ${t}`);if(!s.compiler){const t=JSON.stringify(s);this.registerPipeline(t,s,!1);const i=this.getPipeline(t);return i.compiler.execute(i.compiled,e,n,r)}return s.compiler.execute(s.compiled,e,n,r)}use(t,e,n,r=!1){let s;if("function"==typeof t){if(t.name.endsWith("Compiler"))return this.registerCompiler(t),t.name;s=new t({container:this})}else s=t;s.register&&s.register(this);const i=s.settings?s.settings.tag:void 0,u=e||s.name||i||t.name||s.constructor.name;return r&&this.get(u)||this.register(u,s,n),u}getCompiler(t){const e=this.compilers[t];return e||(this.parent?this.parent.getCompiler(t):this.compilers.default)}buildPipeline(t,e=[]){const n=[];if(t&&t.length>0)for(let r=0;r<t.length;r+=1){const s=t[r];if("$super"===s.trim())for(let t=0;t<e.length;t+=1){e[t].trim().startsWith("->")||n.push(e[t])}else n.push(s)}const r=n.length&&n[0].startsWith("// compiler=")?n[0].slice(12):"default",s=this.getCompiler(r),i=s.compile(n);return{pipeline:n,compiler:s,compiled:i}}registerPipeline(t,e,n=!0){if(n||!this.pipelines[t]){const n=this.getPipeline(t);this.pipelines[t]=this.buildPipeline(e,n?n.pipeline:[])}}registerPipelineForChilds(t,e,n,r=!0){this.childPipelines||(this.childPipelines={}),this.childPipelines[t]||(this.childPipelines[t]=[]),this.childPipelines[t].push({tag:e,pipeline:n,overwrite:r})}getPipeline(t){if(this.pipelines[t])return this.pipelines[t];const e=Object.keys(this.pipelines);for(let n=0;n<e.length;n+=1)if(r(t,e[n]))return this.pipelines[e[n]]}registerConfiguration(t,e,n=!0){!n&&this.configurations[t]||(this.configurations[t]=e)}getConfiguration(t){if(this.configurations[t])return this.configurations[t];const e=Object.keys(this.configurations);for(let n=0;n<e.length;n+=1)if(r(t,e[n]))return this.configurations[e[n]]}loadPipelinesFromString(t=""){const e=t.split(/\n|\r|\r\n/);let n="",r=[],s="";for(let t=0;t<e.length;t+=1){const i=e[t];""!==i&&(i.startsWith("# ")?(n&&(s&&!["default","pipelines"].includes(s.toLowerCase())?this.registerPipelineForChilds(s,n,r):this.registerPipeline(n,r)),s=i.slice(1).trim(),n="",r=[]):i.startsWith("## ")?(n&&(s&&!["default","pipelines"].includes(s.toLowerCase())?this.registerPipelineForChilds(s,n,r):this.registerPipeline(n,r)),n=i.slice(2).trim(),r=[]):n&&r.push(i))}n&&(s&&!["default","pipelines"].includes(s.toLowerCase())?this.registerPipelineForChilds(s,n,r):this.registerPipeline(n,r))}async start(t="main"){const e=Object.keys(this.factory);for(let t=0;t<e.length;t+=1){const n=this.factory[e[t]];n.isSingleton&&n.instance&&n.instance.start&&await n.instance.start()}this.getPipeline(t)&&await this.runPipeline(t,{},this)}}const o=new u;t.exports={Container:u,defaultContainer:o}},function(t,e,n){const r=n(86),s=n(135),i=n(0),u=n(15),o=n(136),a=n(160),c=n(3),l=n(161),p=n(169),h=n(171),f=n(172),g=n(173),d=n(174),A=n(178),m=n(179),v=n(180),E=n(182),y=n(59),C=n(73);t.exports={merge:r,isString:s,isObjectLike:i,isPlainObject:y,isFunction:u,clone:o,cloneDeep:a,isArray:c,get:p,set:l,isUndefined:h,isNull:f,isBoolean:g,isNumber:C,random:d,last:A,flatten:v,isNaN:m,difference:E}},function(t,e,n){var r=n(98),s=n(103);t.exports=function(t,e){var n=s(t,e);return r(n)?n:void 0}},function(t,e,n){var r=n(1).Symbol;t.exports=r},function(t,e,n){var r=n(34),s=n(26);t.exports=function(t,e,n,i){var u=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var c=e[o],l=i?i(n[c],t[c],c,n,t):void 0;void 0===l&&(l=t[c]),u?s(n,c,l):r(n,c,l)}return n}},function(t,e,n){(function(e){const r=n(7),s=n(194),i=n(195),u=n(198),o=n(199),a=n(75),c=n(211),l=(n(218),n(219)),p=n(220),h=n(77),f=n(22),g=n(222);class d{constructor(t={},{loadSkills:e,model:n,modelLangs:s}={}){this._nlp={},this.config={},this._format={},this._constants={},this._conditions={},this._canActivated=[],this._propagateNlp=null,this._dbHook={},this._hooks={},this.model=n,this.modelLangs=s,this._originNlpObject={},this.script="",this._obj=[],this._skills=new Map,this._users=new Map,this.namespace="default",this._functions=c,this.lang=i.instance(),this.options=t,r.isString(t)&&(t={file:t}),Object.keys(t).length>0&&this.loadOptions(t,e)}static get version(){return g.version}static loader({systemjs:t}){t.config({meta:{"*.converse":{loader:e+"/../loader/converse-loader.js"}}}),d.SystemJS=t}async loadNativeNlp(){return this.nlp("__native__",await d.nlpManager(this.model,this.modelLangs)),this}async setModelNlp(t,e,n){this.model=t,this.modelLangs=e,await this.loadNativeNlp(!0),this.propagateNlp("__native__"),n||await this.setSkills(this.options.skills)}async loadOptions(t,e=!0){if(t.file&&this.file(t.file),t.code&&this.code(t.code),t.languages&&this.configure({languages:t.languages}),t.nlp)for(let e in t.nlp)this.nlp(e,t.nlp[e]);if(!this.parent&&this.model&&await this.setModelNlp(this.model,this.modelLangs,!0),t.conditions&&this.conditions(t.conditions),t.functions&&this.functions(t.functions),t.constants&&this.constants(t.constants),t.formats)for(let e in t.formats)this.format(e,t.formats[e]);t.canActivated&&this.canActivated(t.canActivated),t.shareFormats&&this.shareFormats(),t.shareNlp&&this.shareNlp(),t.propagateNlp&&this.propagateNlp(t.propagateNlp),t.propagateFormats&&this.propagateFormats(),e&&t.skills&&await this.setSkills(t.skills),this.load()}get users(){return this._users}configure(t){return this.config=r.merge(this.config,t),this}file(t){return this._file=t,this}code(t){return t.code?this.script=t.code:this.script=t,(t.compiled||r.isArray(this.script))&&(this._compiled=t.compiled||this.script),this}async open(t){return this._file&&d.SystemJS&&this.code(await d.SystemJS.import(this._file)),this.script?this._compiled?this._obj=r.merge([],this._compiled):(this._transpiler=new o(this.script,this.namespace),this._obj=this._transpiler.run(t)):this._obj=[],this._interpreter=new a(this._obj,this.users,this),this}continue(t,e,n){return this.exec({type:"continue",data:t},e,n)}exec(t,e,n,s={globalNoExec:!0}){let i;return new Promise(async(o,a)=>{let c;if(await this.open(a),!n){if(!f.is())throw"On NodeJS, you must give an identifier to the user. `.exec(input, userId, output)`";n=e,e="conversescript-user"}if(r.isObjectLike(t)||(t={text:t}),i=this._users.get(e),r.isFunction(n)&&(n={output:n}),i||(i=new u(e),this._users.set(e,i),s.start=!0),n.magicVariables)for(let t in n.magicVariables)i.setMagicVariable(t,n.magicVariables[t]);i.setMagicVariable("userId",e),i.resetHistory(),"continue"==t.type&&i.setMagicVariable("event",t.data);let l=Promise.resolve().then(()=>{if(n.preUser)return n.preUser(i,this)}).then(()=>{!this.parent&&n.debug&&n.debug("begin",{user:i,data:n.data})}).then(()=>this.propagateExec(t,e,n,s)).then(t=>{c=!!t,c=c||!c&&i.getAddress(this.namespace)});l="event"!==t.type&&"continue"!==t.type?l.then(()=>c?this.execNlp(t,e):t):l.then(()=>t),l.then(async t=>{let e={};c&&(e=await this._interpreter.exec(i,t,n,s),e&&(s.globalNoExec&=e.nothing)),o(e)}).catch(t=>{a(t)})}).then(e=>(this.parent||(s.globalNoExec&&this._hooks.nothing&&this._hooks.nothing(t.text,{user:i},n.data),this._hooks.finished&&this._hooks.finished(t.text,{user:i,data:n.data}),n.debug&&n.debug("finish",{nothing:s.globalNoExec,user:i,data:n.data}),i._nlpCache={}),e))}propagateExec(t,e,n,s){const i=this._users.get(e);let u=r.clone(n),o=!0,a=Promise.resolve();return this._skills.forEach(n=>{r.isArray(n)||(n=[n]);for(let c of n)a=a.then(()=>new Promise((n,a)=>{let l=Promise.resolve();if(this._canActivated.length>0&&!this._canActivated.includes(c.name)){c._canActivated=[...this._canActivated,...c._canActivated];for(let t of this._canActivated)this.name!=t&&c._skills.set(t,this._skills.get(t))}c._shareFormat&&(this._format=r.merge(c._format,this._format)),c._users=this._users,c._condition&&(l=c._condition(u.data,i),h(l)||(l=Promise.resolve(l))),l.then((r=!0)=>{if(r)return c.exec(t,e,u,s).then((t={})=>{o&=t.noExec,n()}).catch(a);n()})}))}),a.then(()=>o)}skills(){return this._skills}execNlp(t,e){t.intents={};const n=this.users.get(e);let s=Promise.resolve(),i=Object.keys(this._nlp).map(t=>this._nlp[t]);i=i.sort((t,e)=>(e.priority||0)-(t.priority||0));for(let u of i){const i=u.uuid;s=s.then(r=>{if("break"==r)return;const s=n._nlpCache[u.name];return s&&Object.is(s.object,this._originNlpObject[i])?s.result:u.exec(t.text,e,this)}).then(e=>{if(!e)return;n._nlpCache[u.name]={object:this._originNlpObject[i],result:e};const s=Object.keys(e).length;if(!r.isUndefined(u.priority)&&s>0)return t.intents=e,"break";t.intents=r.merge(t.intents,e)})}return s.then(()=>t)}event(t,...e){let n,s,i,u=Promise.resolve();switch(e.length){case 2:r.isArray(e[0])?s=e[0]:i=e[0],n=e[1];break;case 3:i=e[0],s=e[1],n=e[2];break;default:s=this.users}return s&&!r.isArray(s)&&(s=[s]),s.forEach(e=>{u=u.then(()=>(e.id&&(e=e.id),this.exec({type:"event",name:t,data:i},e,n)))}),u}saveSession(t,e){const n=this.users.get(e);if(!n)throw`Unable to save the user ${e} session because there is no exists`;return n.saveSession(t),this}format(t,e){return this._format[t]=e,this}functions(t){return this._functions=r.merge(this._functions,t),this}execFunction(t,e,n,s,{deep:i,data:u,execution:o,level:a,ins:c}){let l=t;if(i&&(l+="."+i),!this._functions[t])throw`${i.join(".")+"."+t}() not exists`;let p,{$call:h,$mock:f,$params:g}=this._functions[t];this._functions[t].namespace=this.namespace,h||(h=this._functions[t]),i&&i.length>0&&(h=r.get(h,i)),g&&(g=g.map(t=>{switch(t){case"users":return this.users;case"user":return s;case"data":return u;case"execution":return o;case"level":return a;case"ins":return c}return t}),e=e.concat(g));const d={users:this.users,user:s,data:u,execution:o,level:a,ins:c};return this.testing&&this._mock[l]?(p=this._mock[l].call(s,...e),f&&(i&&(f=r.get(f,i)),p=f.call(this._mock[l],p,...g))):(this._functions[t].converse=d,p=h.call(this._functions[t],...e)),n?p&&p.then?p.then(()=>{s.setMagicVariable("error",null),n()}).catch(t=>{s.setMagicVariable("error",t),n()}):void n(p):p}nlp(t,e,n){const r=Symbol();return this._originNlpObject[r]=e,this._nlp[t]||(this._nlp[t]=new l(t,this,{...n,uuid:r})),e&&this._nlp[t].add(e),this._nlp[t]}useNlp(t){return this.currentNlp=t,this}getCurrentNlp(){return this._nlp[this.currentNlp]}async loadLanguage(){if(!this.config.languages)return;const t=this.config.languages.path||"./languages";let{packages:e,default:n}=this.config.languages;r.isArray(e)?this.lang.init(e,t+"/"):(n||(n=Object.keys(e)[0]),this.lang.packages(e).default(n))}load(){return this.loadLanguage(),this}loadUsers(t){for(let e of t){let t=e.id||e._id,n=new u(t).fromJson(e);this.users.set(t,n)}}use(t){this._hooks=t}_findParentPath(){const t=stack(),n=e;for(let e of t){let t=e.getFileName(),r=s.dirname(t);if(r!==n&&!/testing$/.test(r))return r}}async openSkills(t){let e;f.is()||(e=await new Promise(async(t,e)=>{try{const e=await p.readFile(`${this.parentPath}/package.json`,{encoding:"utf-8"});t(JSON.parse(e))}catch(n){if(n)return"ENOENT"==n.code?t():e(n)}})),e&&e.converse&&e.converse.dependencies&&(this.setSkills(e.converse.dependencies),t&&t())}async skill(t,e=t){let n=e.skill||e;n.hasOwnProperty("default")&&(n=n.default);let s,i=n;if(r.isArray(n)){for(let e of n)await this.skill(t,e);return}if(r.isString(n)){let t=n.split(":");if(t.length>1?(i=n=t[1],t=t[0]):t=null,f.is()&&"node"==t)return this;if(!f.is()&&"browser"==t)return this;/\//.test(n)||(i=this.config.pathSkills||"skills",i+=`/${n}`)}else s=n;if(s.hasOwnProperty("default")&&(s=s.default),r.isFunction(s)){const t=e.params||[];s=r.isPlainObject(t)?s.call(s,t):s.apply(s,t),s.then&&(s=await s)}let u=s.skills;if(r.isPlainObject(s)&&(this._propagateNlp&&(s.propagateNlp=this._propagateNlp),this._propagateFormats&&(s.propagateFormats=!0),s=new d(s,{loadSkills:!1})),s.namespace=(this.namespace?this.namespace+"-":"")+t,s.parent=this,s.name=t,s._condition=e.condition,s._shareNlp&&(this._nlp=r.merge(this._nlp,s._nlp),s._nlp={}),this._propagateNlp){if(this.allPropagate)s._nlp=r.merge(this._nlp,s._nlp);else{let t={};for(let e of this._propagateNlp)t[e]=this._nlp[e];s._nlp=r.merge(t,s._nlp)}s._originNlpObject=r.merge(this._originNlpObject,s._originNlpObject)}if(this._propagateFormats&&(s._format=r.merge(this._format,s._format)),this._skills.has(t)){const e=this._skills.get(t);s=r.isArray(e)?[...e,s]:[e,s]}return this._skills.set(t,s),u&&await s.setSkills(u),this}async setSkills(t){for(let e in t)await this.skill(e,t[e]);return this}getSkill(t){return this._skills.get(t)}shareFormats(){this._shareFormat=!0}shareNlp(){this._shareNlp=!0}propagateNlp(t){return this._propagateNlp||(this._propagateNlp=[]),r.isArray(t)?(this._propagateNlp=[...this._propagateNlp,...t],this):(r.isString(t)&&this._propagateNlp.push(t),this)}get allPropagate(){return 0==this._propagateNlp.length}propagateFormats(){this._propagateFormats=!0}conditions(t){this._conditions=r.merge(this._conditions,t)}constants(t){this._constants=r.merge(this._constants,t)}canActivated(t){this._canActivated=t}getAllIntents(){let t=[],e=this.open().then(()=>{t=this._interpreter.decorators.get("Intent"),t=t.map(t=>(t._skill=this,t))});return this._skills.forEach(n=>{r.isArray(n)||(n=[n]);for(let r of n)e=e.then(()=>r.getAllIntents()).then(e=>t=t.concat(e))}),e.then(()=>t)}}t.exports=d}).call(this,"/")},function(t,e,n){var r=n(88),s=n(89),i=n(90),u=n(91),o=n(92);function a(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=s,a.prototype.get=i,a.prototype.has=u,a.prototype.set=o,t.exports=a},function(t,e,n){var r=n(14);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(4),s=n(2),i="[object AsyncFunction]",u="[object Function]",o="[object GeneratorFunction]",a="[object Proxy]";t.exports=function(t){if(!s(t))return!1;var e=r(t);return e==u||e==o||e==i||e==a}},function(t,e,n){var r=n(8)(Object,"create");t.exports=r},function(t,e,n){var r=n(112);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){var r=n(15),s=n(58);t.exports=function(t){return null!=t&&s(t.length)&&!r(t)}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){var r=n(62),s=n(126),i=n(18);t.exports=function(t){return i(t)?r(t,!0):s(t)}},function(t,e,n){var r=n(4),s=n(0),i="[object Symbol]";t.exports=function(t){return"symbol"==typeof t||s(t)&&r(t)==i}},function(t,e){t.exports=new class{is(){return"undefined"!=typeof navigator}}},function(t,e,n){const r=n(7);t.exports=class{constructor(t,e){this.decorator=t,this.otherDecorators={},this.name=this.decorator.name,this.instructions=t.instructions,this.params=t.params,this.fnName=e}findParam(t){return 0===r.difference(this.params,t).length}}},function(t,e,n){var r=n(8)(n(1),"Map");t.exports=r},function(t,e,n){var r=n(104),s=n(111),i=n(113),u=n(114),o=n(115);function a(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=s,a.prototype.get=i,a.prototype.has=u,a.prototype.set=o,t.exports=a},function(t,e,n){var r=n(51);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var r=n(119);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},function(t,e,n){var r=n(56)(Object.getPrototypeOf,Object);t.exports=r},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){var r=n(121),s=n(0),i=Object.prototype,u=i.hasOwnProperty,o=i.propertyIsEnumerable,a=r(function(){return arguments}())?r:function(t){return s(t)&&u.call(t,"callee")&&!o.call(t,"callee")};t.exports=a},function(t,e,n){(function(t){var r=n(1),s=n(122),i=e&&!e.nodeType&&e,u=i&&"object"==typeof t&&t&&!t.nodeType&&t,o=u&&u.exports===i?r.Buffer:void 0,a=(o?o.isBuffer:void 0)||s;t.exports=a}).call(this,n(27)(t))},function(t,e,n){(function(t){var r=n(48),s=e&&!e.nodeType&&e,i=s&&"object"==typeof t&&t&&!t.nodeType&&t,u=i&&i.exports===s&&r.process,o=function(){try{var t=i&&i.require&&i.require("util").types;return t||u&&u.binding&&u.binding("util")}catch(t){}}();t.exports=o}).call(this,n(27)(t))},function(t,e,n){var r=n(26),s=n(14),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var u=t[e];i.call(t,e)&&s(u,n)&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e){var n=9007199254740991,r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var s=typeof t;return!!(e=null==e?n:e)&&("number"==s||"symbol"!=s&&r.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){var r=n(62),s=n(139),i=n(18);t.exports=function(t){return i(t)?r(t):s(t)}},function(t,e,n){var r=n(143),s=n(67),i=Object.prototype.propertyIsEnumerable,u=Object.getOwnPropertySymbols,o=u?function(t){return null==t?[]:(t=Object(t),r(u(t),(function(e){return i.call(t,e)})))}:s;t.exports=o},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,s=t.length;++n<r;)t[s+n]=e[n];return t}},function(t,e,n){var r=n(147),s=n(24),i=n(148),u=n(149),o=n(150),a=n(4),c=n(49),l=c(r),p=c(s),h=c(i),f=c(u),g=c(o),d=a;(r&&"[object DataView]"!=d(new r(new ArrayBuffer(1)))||s&&"[object Map]"!=d(new s)||i&&"[object Promise]"!=d(i.resolve())||u&&"[object Set]"!=d(new u)||o&&"[object WeakMap]"!=d(new o))&&(d=function(t){var e=a(t),n="[object Object]"==e?t.constructor:void 0,r=n?c(n):"";if(r)switch(r){case l:return"[object DataView]";case p:return"[object Map]";case h:return"[object Promise]";case f:return"[object Set]";case g:return"[object WeakMap]"}return e}),t.exports=d},function(t,e){const n={"variable.not.defined":["ReferenceError",t=>`${t.variable} is not defined`],"function.not.defined":["ReferenceError",t=>`${t.name}(...) function is not defined`],"arithmetic.error":["ArithmeticError",(t,e)=>"Expression is not correct. "+e.message],"type.error":["TypeError",(t,e)=>"Type is not correct. "+e.message]};t.exports=class{constructor(t,e,n){this.script=t,this.namespace=e,this.reject=n}throw(t,e,r){let s,i,u;if(!t)throw r;if(n[e]?(i=n[e][0],u=n[e][1]):(i="InternalError",u=()=>r.message),u=u(t,r),t._file){let{line:e,column:n}=t._file.start;s=this.makeError(i,u,{line:e,column:n})}else s=new Error(u);if(this.reject)return s;throw s}syntax(t){if(!t.location)throw t;const{line:e,column:n}=t.location.start,r=this.makeError("syntax","Syntax Error:"+t.message,{line:e,column:n});if(!this.reject)throw r;this.reject(r)}makeError(t,e,n){var r,s=n.line,i=n.column,u=(n.filename,this.script||n.src),o=s+(i?":"+i:"");const a=this.namespace?this.namespace.split("-").join(" / "):"unknow",c=`Skill : ${a}. Line ${s}`;if(u&&s>=1&&s<=u.split("\n").length){var l=u.split("\n"),p=Math.max(s-3,0),h=Math.min(l.length,s+3);r=c+"\n\n"+l.slice(p,h).map((function(t,e){var n=e+p+1,r=(n==s?"  > ":"    ")+n+"| ",u=r+t;return n===s&&i>0&&(u+="\n",u+=Array(r.length+i).join("-")+"^"),u})).join("\n")+"\n\n"+e}else r=c+":"+o+"\n\n"+e;const f=new Error(r);return f.skill=a,f.line=s,f.column=i,f}}},function(t,e,n){"use strict";n.r(e),n.d(e,"NewBot",(function(){return i}));var r=n(11),s=n.n(r);n.d(e,"Converse",(function(){return s.a})),window.Converse=s.a;const i=window.NewBot=s.a},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,r,s=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}function o(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(t){n=i}try{r="function"==typeof clearTimeout?clearTimeout:u}catch(t){r=u}}();var a,c=[],l=!1,p=-1;function h(){l&&a&&(l=!1,a.length?c=a.concat(c):p=-1,c.length&&f())}function f(){if(!l){var t=o(h);l=!0;for(var e=c.length;e;){for(a=c,c=[];++p<e;)a&&a[p].run();p=-1,e=c.length}a=null,l=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===u||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function g(t,e){this.fun=t,this.array=e}function d(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new g(t,e)),1!==c.length||l||o(f)},g.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=d,s.addListener=d,s.once=d,s.off=d,s.removeListener=d,s.removeAllListeners=d,s.emit=d,s.prependListener=d,s.prependOnceListener=d,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,n){"use strict";var r={range:function(t,e){var n,r,s=e-t,i=new Array(s);for(n=0,r=t;n<s;n++,r++)i[n]=r;return i},find:function(t,e){var n,r=t.length;if("function"==typeof e){for(n=0;n<r;n++)if(e(t[n]))return t[n]}else for(n=0;n<r;n++)if(t[n]===e)return t[n]},indexOf:function(t,e){var n,r=t.length;if("function"==typeof e){for(n=0;n<r;n++)if(e(t[n]))return n}else for(n=0;n<r;n++)if(t[n]===e)return n;return-1},contains:function(t,e){return-1!==r.indexOf(t,e)},each:function(t,e){var n,r=t.length;for(n=0;n<r;n++)e(t[n],n)},map:function(t,e){var n,r=t.length,s=new Array(r);for(n=0;n<r;n++)s[n]=e(t[n],n);return s},pluck:function(t,e){return r.map(t,(function(t){return t[e]}))},every:function(t,e){var n,r=t.length;for(n=0;n<r;n++)if(!e(t[n]))return!1;return!0},some:function(t,e){var n,r=t.length;for(n=0;n<r;n++)if(e(t[n]))return!0;return!1}};t.exports=r},function(t,e,n){"use strict";var r=n(84),s=n(44),i={build:function(t){function e(e){return t[e.type].apply(null,arguments)}function n(){}function i(t){var n=Array.prototype.slice.call(arguments,1);e.apply(null,[t.expression].concat(n))}function u(t){return function(n){var r=Array.prototype.slice.call(arguments,1);s.each(n[t],(function(t){e.apply(null,[t].concat(r))}))}}var o={grammar:function(t){var n=Array.prototype.slice.call(arguments,1);t.initializer&&e.apply(null,[t.initializer].concat(n)),s.each(t.rules,(function(t){e.apply(null,[t].concat(n))}))},initializer:n,rule:i,named:i,choice:u("alternatives"),action:i,sequence:u("elements"),labeled:i,text:i,simple_and:i,simple_not:i,optional:i,zero_or_more:i,one_or_more:i,group:i,semantic_and:n,semantic_not:n,rule_ref:n,literal:n,class:n,any:n};return r.defaults(t,o),e}};t.exports=i},function(t,e){function n(t,e,n){const r=t,s=e;s.start<=r.end&&s.end>=r.start&&(s.accuracy<r.accuracy?s.discarded=!0:s.accuracy>r.accuracy?r.discarded=!0:(n||s.entity===r.entity||"number"===s.entity)&&s.len<=r.len||(n||s.entity===r.entity||"number"===r.entity)&&s.len>r.len&&(r.discarded=!0))}t.exports=function(t,e=!0){const r=t.length;for(let s=0;s<r;s+=1){const i=t[s];if(!i.discarded)for(let u=s+1;u<r;u+=1){const r=t[u];i.discarded||n(i,r,e)}}return t.filter(t=>!t.discarded)}},function(t,e,n){var r=n(12),s=n(93),i=n(94),u=n(95),o=n(96),a=n(97);function c(t){var e=this.__data__=new r(t);this.size=e.size}c.prototype.clear=s,c.prototype.delete=i,c.prototype.get=u,c.prototype.has=o,c.prototype.set=a,t.exports=c},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(42))},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e,n){var r=n(26),s=n(14);t.exports=function(t,e,n){(void 0===n||s(t[e],n))&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(8),s=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=s},function(t,e,n){(function(t){var r=n(1),s=e&&!e.nodeType&&e,i=s&&"object"==typeof t&&t&&!t.nodeType&&t,u=i&&i.exports===s?r.Buffer:void 0,o=u?u.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=o?o(n):new t.constructor(n);return t.copy(r),r}}).call(this,n(27)(t))},function(t,e,n){var r=n(28);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},function(t,e,n){var r=n(120),s=n(29),i=n(30);t.exports=function(t){return"function"!=typeof t.constructor||i(t)?{}:r(s(t))}},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var r=n(18),s=n(0);t.exports=function(t){return s(t)&&r(t)}},function(t,e){var n=9007199254740991;t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=n}},function(t,e,n){var r=n(4),s=n(29),i=n(0),u="[object Object]",o=Function.prototype,a=Object.prototype,c=o.toString,l=a.hasOwnProperty,p=c.call(Object);t.exports=function(t){if(!i(t)||r(t)!=u)return!1;var e=s(t);if(null===e)return!0;var n=l.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==p}},function(t,e,n){var r=n(123),s=n(19),i=n(33),u=i&&i.isTypedArray,o=u?s(u):r;t.exports=o},function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},function(t,e,n){var r=n(125),s=n(31),i=n(3),u=n(32),o=n(35),a=n(60),c=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=i(t),l=!n&&s(t),p=!n&&!l&&u(t),h=!n&&!l&&!p&&a(t),f=n||l||p||h,g=f?r(t.length,String):[],d=g.length;for(var A in t)!e&&!c.call(t,A)||f&&("length"==A||p&&("offset"==A||"parent"==A)||h&&("buffer"==A||"byteLength"==A||"byteOffset"==A)||o(A,d))||g.push(A);return g}},function(t,e,n){var r=n(64),s=n(129),i=n(131);t.exports=function(t,e){return i(s(t,e,r),t+"")}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(14),s=n(18),i=n(35),u=n(2);t.exports=function(t,e,n){if(!u(n))return!1;var o=typeof e;return!!("number"==o?s(n)&&i(e,n.length):"string"==o&&e in n)&&r(n[e],t)}},function(t,e,n){var r=n(47),s=n(137),i=n(34),u=n(138),o=n(141),a=n(52),c=n(54),l=n(142),p=n(144),h=n(145),f=n(146),g=n(39),d=n(151),A=n(152),m=n(55),v=n(3),E=n(32),y=n(156),C=n(2),b=n(158),F=n(36),x=1,D=2,_=4,B="[object Arguments]",w="[object Function]",k="[object GeneratorFunction]",S="[object Object]",P={};P[B]=P["[object Array]"]=P["[object ArrayBuffer]"]=P["[object DataView]"]=P["[object Boolean]"]=P["[object Date]"]=P["[object Float32Array]"]=P["[object Float64Array]"]=P["[object Int8Array]"]=P["[object Int16Array]"]=P["[object Int32Array]"]=P["[object Map]"]=P["[object Number]"]=P[S]=P["[object RegExp]"]=P["[object Set]"]=P["[object String]"]=P["[object Symbol]"]=P["[object Uint8Array]"]=P["[object Uint8ClampedArray]"]=P["[object Uint16Array]"]=P["[object Uint32Array]"]=!0,P["[object Error]"]=P[w]=P["[object WeakMap]"]=!1,t.exports=function t(e,n,j,O,N,$){var T,R=n&x,L=n&D,I=n&_;if(j&&(T=N?j(e,O,N,$):j(e)),void 0!==T)return T;if(!C(e))return e;var M=v(e);if(M){if(T=d(e),!R)return c(e,T)}else{var V=g(e),z=V==w||V==k;if(E(e))return a(e,R);if(V==S||V==B||z&&!N){if(T=L||z?{}:m(e),!R)return L?p(e,o(T,e)):l(e,u(T,e))}else{if(!P[V])return N?e:{};T=A(e,V,R)}}$||($=new r);var U=$.get(e);if(U)return U;$.set(e,T),b(e)?e.forEach((function(r){T.add(t(r,n,j,r,e,$))})):y(e)&&e.forEach((function(r,s){T.set(s,t(r,n,j,s,e,$))}));var H=I?L?f:h:L?keysIn:F,J=M?void 0:H(e);return s(J||e,(function(r,s){J&&(r=e[s=r]),i(T,s,t(r,n,j,s,e,$))})),T}},function(t,e){t.exports=function(){return[]}},function(t,e,n){var r=n(38),s=n(29),i=n(37),u=n(67),o=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)r(e,i(t)),t=s(t);return e}:u;t.exports=o},function(t,e,n){var r=n(38),s=n(3);t.exports=function(t,e,n){var i=e(t);return s(t)?i:r(i,n(t))}},function(t,e,n){var r=n(3),s=n(163),i=n(164),u=n(167);t.exports=function(t,e){return r(t)?t:s(t,e)?[t]:i(u(t))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,s=Array(r);++n<r;)s[n]=e(t[n],n,t);return s}},function(t,e,n){var r=n(21),s=1/0;t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-s?"-0":e}},function(t,e,n){var r=n(4),s=n(0),i="[object Number]";t.exports=function(t){return"number"==typeof t||s(t)&&r(t)==i}},function(t,e,n){var r=n(38),s=n(181);t.exports=function t(e,n,i,u,o){var a=-1,c=e.length;for(i||(i=s),o||(o=[]);++a<c;){var l=e[a];n>0&&i(l)?n>1?t(l,n-1,i,u,o):r(o,l):u||(o[o.length]=l)}return o}},function(t,e,n){const r=n(7),s=n(200),i=n(203),u=n(204),o=n(77),a=n(205),c=n(206),l=n(78),p=n(40);class h{static isSystemFunction(t){return-1!=["Input","Prompt","Pause"].findIndex(e=>e==t)}constructor(t,e,n,r,s){this._nothing=!1,this.user=t,this._input=e,this.input=""+e.text,this.intents=e.intents,"event"===e.type&&(this.event={type:e.type,name:e.name,data:e.data}),this.output=n.output,this.session=n.session,this.propagate=r,this.start=r.start,this.options=n,this.interpreter=s,this.converse=this.interpreter.converse,this.parent=this.converse.parent,this.decorators=s.decorators,this.hooks=s.converse._hooks,this.obj=s._obj,this.namespace=s.namespace,this._finishScript=this.options._finishScript,this._errorScript=this.options._errorScript,this.error=new p(s.converse.script,this.namespace,this._errorScript),this.user.setMagicVariable("text",this.input),this.instructionsRoot(()=>{this.event?this.triggerEvent():this.go().catch(this._errorScript)})}deepBlock(t,e,n=0){const s=e[n],{index:i}=this.interpreter.index[s];let u=t.instructions[i];u.conditionsElse&&s==u.conditionsElse.id&&(u=u.conditionsElse);const o=r.merge(u,{indexBlock:i});return e[n+1]?[o,...this.deepBlock(u,e,n+1)]:[o]}triggerEvent(){let t=this.decorators.get("Event",["on",this.event.name]);"start"==this.event.name&&(t=t.concat(this.decorators.get("Event","start"))),t.length>0?(this.event.data&&this.user.setMagicVariable("event",this.event.data),this.decorators.exec(t,this)):(this._noExec=!0,this.end())}triggerAction(){const t=this.action(this.input);if(t){this.user.setMagicVariable("action",t.value);const e=this.decorators.get("Action",t.name);if(e.length>0)return this.decorators.exec(e,this),!0}}action(t){const e=t.match(/^action\?([a-zA-Z0-9_-]+)(=?)(.*)$/);if(!e)return!1;const n={name:e[1]};return e[3]&&(n.value=e[3]),n}async go(t=0){const e=this,n=this.interpreter.index[this.user.getAddress(this.namespace)];let s=!1,i=!1;const u={start:this.decorators.get("Event","start"),startAndIntent:this.decorators.get("Event","startAndIntent"),nothing:this.decorators.get("Event","nothing")};if(this.user.addressStackIslocked(this.namespace))return this.stopScript();if(this.triggerAction())return this.stopScript();if(this.decorators.get("Intent").length&&(i=await this.decorators.execMethod("Intent","run",this),i&&(s=!0)),!i&&n){let{index:e,level:i,deep:u}=n,o=this.interpreter.fn[i];this.user.popAddress(this.namespace);const a=e=>{this.execFn(o,e+1,e=>{if(e.hasActivateDecorator)if(!0!==e.value)this.user.popAddress(this.parent.namespace);else if(this.parent){const t=this.parent._canActivated.indexOf(this.converse.name);if(-1!=t&&this.parent._canActivated.length>t+1){const e=this.parent._canActivated[t+1],n=this.parent._skills.get(e);for(let t in n._interpreter.index){const e=n._interpreter.index[t];if(e.hasActivateDecorator){this.user.addAddress(t,e.namespace);break}}}else{const t=this.user._infoAddress.actived[this.parent.namespace];this.unlockParent(t,{activated:!0})}}const n=this.user.getAddress(this.namespace);if(n){const t=this.converse._interpreter.index[n];this.setReturnVariable({name:e.level},e.value,t.level)}else if(this.parent){const t=this.user.getAddress(this.parent.namespace);if(t){const n=this.parent._interpreter.index[t],s=r.last(this.namespace.split("-"));this.parent.bufferFunction=t=>{t.setReturnVariable({name:s+"-"+e.level},e.value,n.level)}}}this.go(t+1)})},c=(t,e,n,r)=>{let s=t[n];n<0?r(t[0]):this.execBlock(s,e+1,i,()=>c(t,s.indexBlock,n-1,r))};if(u.length>0){let t=this.deepBlock(o,u);c(t,e,t.length-1,t=>{a(t.indexBlock)})}else a(e);s=!0}else!i&&this.start&&u.start.length?s=await this.decorators.exec(u.start,this):i&&this.start&&u.startAndIntent.length&&(s=await this.decorators.exec(u.startAndIntent,this),i&&!s&&(s=!0));s||async function(){0===t&&(e._noExec=!0,e._nothing=!0,u.nothing.length&&(e.user.nothingSkill||(e.user.nothingSkill=e)),!e.parent&&e.user.nothingSkill&&await e.user.nothingSkill.execNothing()),e.end()}()}execNothing(){const t=this.decorators.get("Event","nothing");return this._noExec=!1,this.decorators.exec(t,this)}stopScript(){this.parent||(this.user.nothingSkill=null),this._finishScript({noExec:this._noExec,nothing:this._nothing})}end(){this.options.finish&&this.options.finish.call(this),this.user.clearAddress(this.namespace),this.stopScript()}unlockParent(t){this.parent&&this.user.unlockAddressStack(this.parent.namespace,t)}instructionsRoot(t){this.converse.bufferFunction&&(this.converse.bufferFunction(this),this.converse.bufferFunction=null),this.instructions(this.obj,0,"root",t)}async instructions(t,e,n="root",s,i={}){let u=t[e];try{const{isBlock:o}=i,a=({stop:r,value:u}={})=>(r&&(e=t.length,i.value=u,i.stop=r),this.instructions(t,e+1,n,s,i));if(!u){if(o||(this.unlockParent(n),this.options.finishFn&&this.options.finishFn.call(this,n)),s){const t=this.interpreter.fn[n];let e=!1;t&&(e=-1!=t.decorators.findIndex(t=>"Event"==t.name&&t.params&&t.params[0]==l.CAN_ACTIVATE)),s({stop:i.stop,value:i.value,level:n,hasActivateDecorator:e})}return void(o||this.user.garbage(n,this.namespace))}if(!r.isUndefined(u.return)){const t=await this.getValue(u,u.return,n);return void(o?s({stop:!0,value:t}):a({stop:!0,value:t}))}if(u._pointer=e,u._instructions=t,this.debug("ins",{level:n,...u}),u.group){let t=u.group[r.random(0,u.group.length-1)];t.decorators=u.decorators,u=t}if(u.condition)await this.execCondition(u,n,a);else if(u.variable)await this.execVariable(u,n,a);else if(u.loop)await this.execLoop(u,n,a);else if(u.output&&"root"!=n)this.execOutput(u,n,a);else if(u.type&&!i.refresh)switch(u.type){case"function":a();break;case"executeFn":let t=await this.findFunctionAndExec(u,n);this.setReturnVariable(u,t,n),a()}}catch(t){throw this._errorScript(t),this.error.throw(u,t.id,t)}}debug(t,e){this.options.debug&&this.options.debug(t,{namespace:this.namespace,data:this.output.data,user:this.user,...e})}findFunctionAndExec(t,e,n){return t=r.cloneDeep(t),new Promise(async(s,i)=>{try{if(!r.isString(t.name)){const{variable:e,type:n,deep:r}=t.name;e&&(t.name=e),t.deep=r}const i=async(t,i,u)=>{if(t.interpreter.fn[i.name]){const n=i.params,o=t.interpreter.fn[i.name],a=o.params;u&&this.user.lockAddressStack(this.namespace,i.name),this.user.addAddress(i.id,this.namespace);let c=[];if(a)for(let s=0;s<a.length;s++)c.push(new Promise(async u=>{await t.execVariable({variable:a[s],value:r.isUndefined(n[s])?null:await this.getValue(i,n[s],e)},i.name,u)}));return Promise.all(c).then(()=>t.execFn(o,0,t=>{this.user.popAddress(this.namespace),s(t.value)})),!0}if(t.hasApiFn(i.name)){let r=await this.execApiFn(i,e,n,{deep:i.deep,data:this.options.data,context:t});return h.isSystemFunction(i.name)||s(r),!0}return!1};if(!await i(this,t)){const n=this.converse.skills().get(t.name);if(n){t.name=t.deep[0],t.deep.splice(0,1),await i(n._interpreter.execution,t,!0)||this.error.throw(t,"function.not.defined")}else if(t.deep){const n=t.deep.slice(0,-1),i={variable:t.name,deep:n};t.deep.length>1&&(i.type="object");const u=await this.getValue(t,i,e),o=u[r.last(t.deep)];o?s(o.apply(u,t.params)):this.error.throw(t,"function.not.defined")}else this.error.throw(t,"function.not.defined")}}catch(t){i(t)}})}getScope(t){return"root"==t?this.user.getVariables(this.namespace):this.user.getVariableInFonction(this.namespace,t)}getVariable(t,e,n){const s=!r.isUndefined(n);let i=t.variable;if(this.converse._constants[i]){if(s)throw new Error("TypeError: Assignment to constant variable");return this.converse._constants[i]}const u=this.user.getVariableInFonction(this.namespace,e,i);if(/^\$/.test(i)){const r=this.user.getVariable(this.namespace,i);return s&&!this.setDeepObject(t,r,n,e)&&this.user.setVariable(this.namespace,i,n),this.getDeepObject(t,r,e)}if(s&&!this.setDeepObject(t,u,n,e)&&this.user.setVariableInFonction(this.namespace,e,i,n),!r.isUndefined(u))return this.getDeepObject(t,u,e)}setVariable(t,e,n){this.getVariable(t,n,e)}setReturnVariable(t,e,n){let r=t.name;"object"==r.type&&(r=r.variable+"-"+r.deep.join("-")),this.setVariable({variable:"__return_"+r},e,n)}setMagicVar(t,e){this.user.magicVar[t]=e}getMagicVar(t,e,n){const r=this.user.magicVar[t.replace(":","")];return this.getDeepObject(e,r,n)}async _deepObject(t,e,n,s){const i=!r.isUndefined(s);let u=await this.execParams(t,t.deep,n);return r[i?"set":"get"](e,u,s)}getDeepObject(t,e,n){return"object"!=t.type?e:this._deepObject(t,e,n)}setDeepObject(t,e,n,r){return"assignObject"==t.type&&this._deepObject(t,e,r,n)}getValue(t,e,n,s){return new Promise(async(i,o)=>{try{this.getScope(n);let o=e;if(null===o)return i(o);if(e.regexp)o=new RegExp(e.regexp,e.flags.join(""));else if(r.isArray(e))o=await u.map(e,e=>this.getValue(t,e,n));else if(e.expression)o=await this.execExpression(t,e.expression,e.variables,n);else if(e.variable)if(/^:/.test(e.variable)){let t=o.variable;o=this.getMagicVar(t,o,n)}else o=await this.getVariable(e,n);else if(e.text&&!e.__deepIndex)o=await a(e.text,/\{([^\}]+)\}/g,async(r,s)=>this.getValue(t,e.variables[s].value,n));else if("executeFn"==e.type)o=await this.findFunctionAndExec({...e,id:t.id},n);else if(o.__deepIndex)for(let e of o.__deepIndex){let i=await this.getValue(t,r.get(o,e),n,s);r.set(o,e,i)}r.isString(o)&&"#"===o[0]&&(o=await this.translate(t,o.substr(1),n)),i(o)}catch(t){o(t)}})}async execBlock(t,e=0,n,s){let i;if(t.varLocal){let e=await this.getValue(t,t.array,n);if(r.isNumber(e))e=new Array(e+1).fill(0).map((t,e)=>e);else if(r.isPlainObject(e))delete e.__deepIndex,e=Object.values(e);else if(!r.isString(e)&&!r.isArray(e)){const t=new Error("Number, Object, String and Array are only accepted for this loop");throw t.id="type.error",t}t.array=e,i=this.getVariable({variable:"__"+t.varLocal.variable},n),this.setVariable(t.varLocal,t.array[i],n)}await this.instructions(t.instructions,e,n,async e=>{t.loop?t.varLocal?i<t.array.length-1?(this.setVariable({variable:"__"+t.varLocal.variable},i+1,n),await this.execBlock(t,0,n,s)):s(e):this.execCondition(t,n,s):s(e)},{isBlock:!0})}async execLoop(t,e,n){this.setVariable({variable:"__"+t.varLocal.variable},0,e),await this.execBlock(t,0,e,n)}execCondition(t,e,n){return new Promise((n,r)=>{this.getValue(t,t.condition,e).then(n).catch(r)}).then(s=>{switch(t.keyword){case"unknown":s=r.isUndefined(s)||r.isNull(s);break;case"defined":s=!r.isUndefined(s)&&!r.isNull(s)}s?this.execBlock(t,0,e,n):t.conditionsElse?this.execBlock(t.conditionsElse,0,e,n):n()})}execExpression(t,e,n,s){return new Promise(async(u,o)=>{e=(e=(e=(e=(e=await a(e,/\{([0-9]+)\}/g,async(e,i)=>{let u=await this.getValue(t,n[i],s);return/^[0-9]+(\.[0-9]+)?$/.test(u)||r.isBoolean(u)||null===u||(u=`"${u}"`),u})).replace(/'/g,'"')).replace(/not/g,"!")).replace(/and/g,"&&")).replace(/or/g,"||");try{const t=i(e);u(this.arithmetic(t))}catch(t){t.id="arithmetic.error",o(t)}})}arithmetic(t){let e,n;switch(t.left&&(e=this.arithmetic(t.left)),t.right&&(n=this.arithmetic(t.right)),t.type){case"BinaryExpression":switch(t.operator){case"+":return e+n;case"-":return e-n;case"*":return e*n;case"/":return e/n;case"==":return e==n;case">=":return e>=n;case"<=":return e<=n;case">":return e>n;case"<":return e<n}break;case"LogicalExpression":switch(t.operator){case"&&":return e&&n;case"||":return e||n}break;case"UnaryExpression":switch(t.operator){case"!":return!this.arithmetic(t.argument);case"-":return-this.arithmetic(t.argument)}break;default:return t.value}}execVariable(t,e,n){return new Promise((n,r)=>{this.getValue(t,t.value,e).then(n).catch(r)}).then(s=>{let i=this.getScope(e);r.isUndefined(i[t.variable.replace("$","")])||"root"!=e||this.start?(this.setVariable(t,s,e),n()):n()})}async translate(t,e,n,s=[]){const{converse:i}=this.interpreter,u=this.user.getLang()||i.lang.current;let o=i.lang.data[u]&&i.lang.get(e,null,u);if(!o&&i.lang.data[u]){const t=i.lang.getGroup(e);t.length>0&&(e=t[r.random(0,t.length-1)],o=!0)}return o&&(s=await this.execParams(t,s,n),e=i.lang.translate(e,u,...s)),e}execOutput(t,e,n){return new Promise(async(s,i)=>{const{converse:u}=this.interpreter;let a=t.output;if(!this.output)return;if(t.output.variables&&(a=await this.getValue(t,t.output,e)),a=a.replace(/\r$/,""),a=await this.translate(t,a,e,t.params),t.decorators)for(let n of t.decorators)if("Format"==n.name){let r=[...n.params];r=await this.execParams(t,r,e);let s=r[0];u._format[s]&&(r.splice(0,1),a=u._format[s].call(this.converse,a,r,this.options.data,this.user),o(a)&&(a=await a))}const c=t=>{const e=t||a,s=this.output(e,n,{user:this.user});r.isUndefined(s)||n()};this._triggerHook("sending",a,{user:this.user,data:this.options.data},(t,e)=>{if(t)throw t;c(e)})||c()})}execFn(t,e,n){r.isUndefined(this.interpreter.fn[t.name])&&this.error.throw(t,"function.not.defined"),this.instructions(t.instructions,e,t.name,n)}execParams(t,e,n,r){return e?u.map(e,e=>this.getValue(t,e,n,r)):Promise.resolve([])}async execApiFn(t,e,n,r){return h.isSystemFunction(t.name)?(this.user.addAddress(t.id,this.namespace),this._triggerHook("prompt",t.params,{user:this.user,data:this.options.data,level:e}),this.options.waintingInput&&this.options.waintingInput.call(this,t.params,e),void this.stopScript()):(r.execution=r.context||this,r.level=e,r.ins=t,(r.context||this).interpreter.converse.execFunction(t.name,await this.execParams(t,t.params,e,n),n,this.user,r))}hasApiFn(t){return this.converse._functions[t]||h.isSystemFunction(t)}_triggerHook(t,e,n,r,s=!0){let i=!1;return this.hooks[t]&&(i=!0,this.hooks[t](this.input,e,n,r)),s&&this.parent&&this.parent._hooks[t]&&(i=!0,this.parent._hooks[t](this.input,e,n,r)),i}}t.exports=class{constructor(t,e,n){this._obj=t,this.index={},this._users=e,this.var=[],this.fn={},this.converse=n,this.namespace=this.converse.namespace,this.decorators=new c(this),this.organize(this._obj)}organize(t,e="root",n=[]){const r=s=>{let i=t[s];if(i){if(i.id=this.setId(i,e),i.type&&"function"==i.type){this.fn[i.name]=i,this.decorators.add(i);const t=-1!=i.decorators.findIndex(t=>"Event"==t.name&&t.params&&t.params[0]==l.CAN_ACTIVATE);return this.organize(i.instructions,i.name),s++,this.index[i.id]={level:i.name,namespace:this.namespace,index:-1,deep:n,hasActivateDecorator:t},void r(s)}(i.condition||i.loop)&&this.organize(i.instructions,e,n.concat(i.id)),i.conditionsElse&&(i.conditionsElse.id=this.setId(i.conditionsElse,e),this.organize(i.conditionsElse.instructions,e,n.concat(i.conditionsElse.id)),this.index[i.conditionsElse.id]={level:e,index:s,namespace:this.namespace,deep:n},s++),this.index[i.id]={level:e,index:s,namespace:this.namespace,deep:n},s++,r(s)}};r(0)}setId(t,e){let n=e+"-"+s(JSON.stringify(t));this.namespace&&(n+="-"+this.namespace);let r=1;for(;this.index[n+"-"+r];)r++;return n+"-"+r}exec(t,e,n,s){return new Promise((i,u)=>{this.execution=new h(t,e,r.merge({_finishScript:i,_errorScript:u},n),s,this)})}}},function(t,e){var n={utf8:{stringToBytes:function(t){return n.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(n.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e},bytesToString:function(t){for(var e=[],n=0;n<t.length;n++)e.push(String.fromCharCode(t[n]));return e.join("")}}};t.exports=n},function(t,e){t.exports=function(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then}},function(t,e,n){const r=n(23);t.exports=class extends r{static get CAN_ACTIVATE(){return"canActivate"}start(){return"start"==this.params[0]}nothing(){return"nothing"==this.params[0]}}},function(t,e,n){(function(e){const n="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\u1ab0-\\u1aff\\u1dc0-\\u1dff",r="[\\ud800-\\udfff]",s=`[${n}]`,i="\\ud83c[\\udffb-\\udfff]",u="[^\\ud800-\\udfff]",o="(?:\\ud83c[\\udde6-\\uddff]){2}",a="[\\ud800-\\udbff][\\udc00-\\udfff]",c=`${`(?:${s}|${i})`}?`,l="[\\ufe0e\\ufe0f]?"+c+`(?:\\u200d(?:${[u,o,a].join("|")})${"[\\ufe0e\\ufe0f]?"+c})*`,p=`(?:${[`${u}${s}?`,s,o,a,r].join("|")})`,h=RegExp(`[${"\\u200d\\ud800-\\udfff"+n+"\\ufe0e\\ufe0f"}]`),f=RegExp(`${i}(?=${i})|${p+l}`,"g"),g=t=>h.test(t),d=t=>t.match(f)||[],A=t=>t.split("");t.exports={hasUnicode:g,unicodeToArray:d,asciiToArray:A,stringToArray:t=>g(t)?d(t):A(t),compareWildcars:function(t,e){const n=`^${e.split("*").map(t=>t.replace(/([.*+^=!:${}()|[\]/\\])/g,"\\$1")).join(".*")}$`.replace(/\?/g,".");return new RegExp(n).test(t)},loadEnvFromJson:function(t,n={}){const r=Object.keys(n);t=t?`${t}_`:"";for(let s=0;s<r.length;s+=1){const i=`${t}${r[s]}`;e.env[i]=n[r[s]]}}}}).call(this,n(43))},function(t,e){const n=new class{constructor(){this.name="logger"}debug(...t){console.debug(...t)}info(...t){console.info(...t)}warn(...t){console.warn(...t)}error(...t){console.error(...t)}log(...t){console.log(...t)}trace(...t){console.trace(...t)}fatal(...t){console.error(...t)}};t.exports=n},function(t,e,n){const{defaultContainer:r}=n(6),s=n(82);t.exports=class{constructor(t=r,e=!1){this.container=t.container||t,this.name="tokenize",this.shouldNormalize=e}getNormalizer(){return this.normalizer||(this.normalizer=this.container.get(`normalizer-${this.name.slice(-2)}`)||new s),this.normalizer}normalize(t,e){if(void 0===e&&this.shouldNormalize||!0===e){return this.getNormalizer().normalize(t)}return t}innerTokenize(t){return t.split(/[\s,.!?;:([\]'")/]+/).filter(t=>t)}tokenize(t,e){return this.innerTokenize(this.normalize(t,e))}run(t){const e=t,n=e.locale||"en",r=this.container.get(`tokenizer-${n}`)||this;return e.tokens=r.tokenize(e.text,e).filter(t=>t),e}}},function(t,e,n){const{defaultContainer:r}=n(6);t.exports=class{constructor(t=r){this.container=t.container||t,this.name="normalize"}normalize(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}run(t){const e=t,n=e.locale||"en",r=this.container.get(`normalizer-${n}`)||this;return e.text=r.normalize(e.text,e),e}}},function(t,e,n){const{defaultContainer:r}=n(6);t.exports=class{constructor(t={},e=r){this.container=t.container||e,this.applySettings(this,t)}get logger(){return this.container.get("logger")}applySettings(t,e={}){const n=t||{};return Object.keys(e).forEach(t=>{void 0===n[t]&&(n[t]=e[t])}),n}toJSON(){const t=this.jsonExport||{},e={},n=Object.keys(this);for(let r=0;r<n.length;r+=1){const s=n[r];if("jsonExport"!==s&&"jsonImport"!==s&&"container"!==s&&!s.startsWith("pipeline")){const n=void 0===t[s]||t[s];if("function"==typeof n){const t=n.bind(this)(e,this,s,this[s]);t&&(e[s]=t)}else"boolean"==typeof n?n&&(e[s]=this[s],"settings"===s&&delete e[s].container):"string"==typeof n&&(e[n]=this[s])}}return e}fromJSON(t){const e=this.jsonImport||{},n=Object.keys(t);for(let r=0;r<n.length;r+=1){const s=n[r],i=void 0===e[s]||e[s];if("function"==typeof i){const e=i.bind(this)(this,t,s,t[s]);e&&(this[s]=e)}else"boolean"==typeof i?i&&(this[s]=t[s]):"string"==typeof i&&(this[i]=t[s])}}objToValues(t,e){const n=e||Object.keys(t),r=[];for(let e=0;e<n.length;e+=1)r.push(t[n[e]]);return r}valuesToObj(t,e){const n={};for(let r=0;r<t.length;r+=1)n[e[r]]=t[r];return n}getPipeline(t){return this.container.getPipeline(t)}async runPipeline(t,e){return this.container.runPipeline(e||this.pipeline,t,this)}use(t){this.container.use(t)}}},function(t,e,n){"use strict";t.exports={keys:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(e);return n},values:function(t){var e,n=[];for(e in t)t.hasOwnProperty(e)&&n.push(t[e]);return n},clone:function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n},defaults:function(t,e){var n;for(n in e)e.hasOwnProperty(n)&&(n in t||(t[n]=e[n]))}}},function(t,e,n){"use strict";function r(t,e){this.name="GrammarError",this.message=t,this.location=e,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}n(280).subclass(r,Error),t.exports=r},function(t,e,n){var r=n(87),s=n(128)((function(t,e,n){r(t,e,n)}));t.exports=s},function(t,e,n){var r=n(47),s=n(50),i=n(116),u=n(118),o=n(2),a=n(20),c=n(61);t.exports=function t(e,n,l,p,h){e!==n&&i(n,(function(i,a){if(h||(h=new r),o(i))u(e,n,a,l,t,p,h);else{var f=p?p(c(e,a),i,a+"",e,n,h):void 0;void 0===f&&(f=i),s(e,a,f)}}),a)}},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(13),s=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0)&&(n==e.length-1?e.pop():s.call(e,n,1),--this.size,!0)}},function(t,e,n){var r=n(13);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(13);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(13);t.exports=function(t,e){var n=this.__data__,s=r(n,t);return s<0?(++this.size,n.push([t,e])):n[s][1]=e,this}},function(t,e,n){var r=n(12);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(12),s=n(24),i=n(25),u=200;t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var o=n.__data__;if(!s||o.length<u-1)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new i(o)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(15),s=n(101),i=n(2),u=n(49),o=/^\[object .+?Constructor\]$/,a=Function.prototype,c=Object.prototype,l=a.toString,p=c.hasOwnProperty,h=RegExp("^"+l.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||s(t))&&(r(t)?h:o).test(u(t))}},function(t,e,n){var r=n(9),s=Object.prototype,i=s.hasOwnProperty,u=s.toString,o=r?r.toStringTag:void 0;t.exports=function(t){var e=i.call(t,o),n=t[o];try{t[o]=void 0;var r=!0}catch(t){}var s=u.call(t);return r&&(e?t[o]=n:delete t[o]),s}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r,s=n(102),i=(r=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!i&&i in t}},function(t,e,n){var r=n(1)["__core-js_shared__"];t.exports=r},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(105),s=n(12),i=n(24);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||s),string:new r}}},function(t,e,n){var r=n(106),s=n(107),i=n(108),u=n(109),o=n(110);function a(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}a.prototype.clear=r,a.prototype.delete=s,a.prototype.get=i,a.prototype.has=u,a.prototype.set=o,t.exports=a},function(t,e,n){var r=n(16);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(16),s="__lodash_hash_undefined__",i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return n===s?void 0:n}return i.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(16),s=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:s.call(e,t)}},function(t,e,n){var r=n(16),s="__lodash_hash_undefined__";t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?s:e,this}},function(t,e,n){var r=n(17);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(17);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(17);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(17);t.exports=function(t,e){var n=r(this,t),s=n.size;return n.set(t,e),this.size+=n.size==s?0:1,this}},function(t,e,n){var r=n(117)();t.exports=r},function(t,e){t.exports=function(t){return function(e,n,r){for(var s=-1,i=Object(e),u=r(e),o=u.length;o--;){var a=u[t?o:++s];if(!1===n(i[a],a,i))break}return e}}},function(t,e,n){var r=n(50),s=n(52),i=n(53),u=n(54),o=n(55),a=n(31),c=n(3),l=n(57),p=n(32),h=n(15),f=n(2),g=n(59),d=n(60),A=n(61),m=n(124);t.exports=function(t,e,n,v,E,y,C){var b=A(t,n),F=A(e,n),x=C.get(F);if(x)r(t,n,x);else{var D=y?y(b,F,n+"",t,e,C):void 0,_=void 0===D;if(_){var B=c(F),w=!B&&p(F),k=!B&&!w&&d(F);D=F,B||w||k?c(b)?D=b:l(b)?D=u(b):w?(_=!1,D=s(F,!0)):k?(_=!1,D=i(F,!0)):D=[]:g(F)||a(F)?(D=b,a(b)?D=m(b):f(b)&&!h(b)||(D=o(F))):_=!1}_&&(C.set(F,D),E(D,F,v,y,C),C.delete(F)),r(t,n,D)}}},function(t,e,n){var r=n(1).Uint8Array;t.exports=r},function(t,e,n){var r=n(2),s=Object.create,i=function(){function t(){}return function(e){if(!r(e))return{};if(s)return s(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=i},function(t,e,n){var r=n(4),s=n(0),i="[object Arguments]";t.exports=function(t){return s(t)&&r(t)==i}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(4),s=n(58),i=n(0),u={};u["[object Float32Array]"]=u["[object Float64Array]"]=u["[object Int8Array]"]=u["[object Int16Array]"]=u["[object Int32Array]"]=u["[object Uint8Array]"]=u["[object Uint8ClampedArray]"]=u["[object Uint16Array]"]=u["[object Uint32Array]"]=!0,u["[object Arguments]"]=u["[object Array]"]=u["[object ArrayBuffer]"]=u["[object Boolean]"]=u["[object DataView]"]=u["[object Date]"]=u["[object Error]"]=u["[object Function]"]=u["[object Map]"]=u["[object Number]"]=u["[object Object]"]=u["[object RegExp]"]=u["[object Set]"]=u["[object String]"]=u["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&s(t.length)&&!!u[r(t)]}},function(t,e,n){var r=n(10),s=n(20);t.exports=function(t){return r(t,s(t))}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(2),s=n(30),i=n(127),u=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=s(t),n=[];for(var o in t)("constructor"!=o||!e&&u.call(t,o))&&n.push(o);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){var r=n(63),s=n(65);t.exports=function(t){return r((function(e,n){var r=-1,i=n.length,u=i>1?n[i-1]:void 0,o=i>2?n[2]:void 0;for(u=t.length>3&&"function"==typeof u?(i--,u):void 0,o&&s(n[0],n[1],o)&&(u=i<3?void 0:u,i=1),e=Object(e);++r<i;){var a=n[r];a&&t(e,a,r,u)}return e}))}},function(t,e,n){var r=n(130),s=Math.max;t.exports=function(t,e,n){return e=s(void 0===e?t.length-1:e,0),function(){for(var i=arguments,u=-1,o=s(i.length-e,0),a=Array(o);++u<o;)a[u]=i[e+u];u=-1;for(var c=Array(e+1);++u<e;)c[u]=i[u];return c[e]=n(a),r(t,this,c)}}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var r=n(132),s=n(134)(r);t.exports=s},function(t,e,n){var r=n(133),s=n(51),i=n(64),u=s?function(t,e){return s(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:i;t.exports=u},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var n=800,r=16,s=Date.now;t.exports=function(t){var e=0,i=0;return function(){var u=s(),o=r-(u-i);if(i=u,o>0){if(++e>=n)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var r=n(4),s=n(3),i=n(0),u="[object String]";t.exports=function(t){return"string"==typeof t||!s(t)&&i(t)&&r(t)==u}},function(t,e,n){var r=n(66),s=4;t.exports=function(t){return r(t,s)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}},function(t,e,n){var r=n(10),s=n(36);t.exports=function(t,e){return t&&r(e,s(e),t)}},function(t,e,n){var r=n(30),s=n(140),i=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return s(t);var e=[];for(var n in Object(t))i.call(t,n)&&"constructor"!=n&&e.push(n);return e}},function(t,e,n){var r=n(56)(Object.keys,Object);t.exports=r},function(t,e,n){var r=n(10),s=n(20);t.exports=function(t,e){return t&&r(e,s(e),t)}},function(t,e,n){var r=n(10),s=n(37);t.exports=function(t,e){return r(t,s(t),e)}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,s=0,i=[];++n<r;){var u=t[n];e(u,n,t)&&(i[s++]=u)}return i}},function(t,e,n){var r=n(10),s=n(68);t.exports=function(t,e){return r(t,s(t),e)}},function(t,e,n){var r=n(69),s=n(37),i=n(36);t.exports=function(t){return r(t,i,s)}},function(t,e,n){var r=n(69),s=n(68),i=n(20);t.exports=function(t){return r(t,i,s)}},function(t,e,n){var r=n(8)(n(1),"DataView");t.exports=r},function(t,e,n){var r=n(8)(n(1),"Promise");t.exports=r},function(t,e,n){var r=n(8)(n(1),"Set");t.exports=r},function(t,e,n){var r=n(8)(n(1),"WeakMap");t.exports=r},function(t,e){var n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=t.length,r=new t.constructor(e);return e&&"string"==typeof t[0]&&n.call(t,"index")&&(r.index=t.index,r.input=t.input),r}},function(t,e,n){var r=n(28),s=n(153),i=n(154),u=n(155),o=n(53),a="[object Boolean]",c="[object Date]",l="[object Map]",p="[object Number]",h="[object RegExp]",f="[object Set]",g="[object String]",d="[object Symbol]",A="[object ArrayBuffer]",m="[object DataView]",v="[object Float32Array]",E="[object Float64Array]",y="[object Int8Array]",C="[object Int16Array]",b="[object Int32Array]",F="[object Uint8Array]",x="[object Uint8ClampedArray]",D="[object Uint16Array]",_="[object Uint32Array]";t.exports=function(t,e,n){var B=t.constructor;switch(e){case A:return r(t);case a:case c:return new B(+t);case m:return s(t,n);case v:case E:case y:case C:case b:case F:case x:case D:case _:return o(t,n);case l:return new B;case p:case g:return new B(t);case h:return i(t);case f:return new B;case d:return u(t)}}},function(t,e,n){var r=n(28);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},function(t,e){var n=/\w*$/;t.exports=function(t){var e=new t.constructor(t.source,n.exec(t));return e.lastIndex=t.lastIndex,e}},function(t,e,n){var r=n(9),s=r?r.prototype:void 0,i=s?s.valueOf:void 0;t.exports=function(t){return i?Object(i.call(t)):{}}},function(t,e,n){var r=n(157),s=n(19),i=n(33),u=i&&i.isMap,o=u?s(u):r;t.exports=o},function(t,e,n){var r=n(39),s=n(0),i="[object Map]";t.exports=function(t){return s(t)&&r(t)==i}},function(t,e,n){var r=n(159),s=n(19),i=n(33),u=i&&i.isSet,o=u?s(u):r;t.exports=o},function(t,e,n){var r=n(39),s=n(0),i="[object Set]";t.exports=function(t){return s(t)&&r(t)==i}},function(t,e,n){var r=n(66),s=1,i=4;t.exports=function(t){return r(t,s|i)}},function(t,e,n){var r=n(162);t.exports=function(t,e,n){return null==t?t:r(t,e,n)}},function(t,e,n){var r=n(34),s=n(70),i=n(35),u=n(2),o=n(72);t.exports=function(t,e,n,a){if(!u(t))return t;for(var c=-1,l=(e=s(e,t)).length,p=l-1,h=t;null!=h&&++c<l;){var f=o(e[c]),g=n;if(c!=p){var d=h[f];void 0===(g=a?a(d,f,h):void 0)&&(g=u(d)?d:i(e[c+1])?[]:{})}r(h,f,g),h=h[f]}return t}},function(t,e,n){var r=n(3),s=n(21),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,u=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!s(t))||(u.test(t)||!i.test(t)||null!=e&&t in Object(e))}},function(t,e,n){var r=n(165),s=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,u=r((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(s,(function(t,n,r,s){e.push(r?s.replace(i,"$1"):n||t)})),e}));t.exports=u},function(t,e,n){var r=n(166),s=500;t.exports=function(t){var e=r(t,(function(t){return n.size===s&&n.clear(),t})),n=e.cache;return e}},function(t,e,n){var r=n(25),s="Expected a function";function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(s);var n=function(){var r=arguments,s=e?e.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var u=t.apply(this,r);return n.cache=i.set(s,u)||i,u};return n.cache=new(i.Cache||r),n}i.Cache=r,t.exports=i},function(t,e,n){var r=n(168);t.exports=function(t){return null==t?"":r(t)}},function(t,e,n){var r=n(9),s=n(71),i=n(3),u=n(21),o=1/0,a=r?r.prototype:void 0,c=a?a.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(i(e))return s(e,t)+"";if(u(e))return c?c.call(e):"";var n=e+"";return"0"==n&&1/e==-o?"-0":n}},function(t,e,n){var r=n(170);t.exports=function(t,e,n){var s=null==t?void 0:r(t,e);return void 0===s?n:s}},function(t,e,n){var r=n(70),s=n(72);t.exports=function(t,e){for(var n=0,i=(e=r(e,t)).length;null!=t&&n<i;)t=t[s(e[n++])];return n&&n==i?t:void 0}},function(t,e){t.exports=function(t){return void 0===t}},function(t,e){t.exports=function(t){return null===t}},function(t,e,n){var r=n(4),s=n(0),i="[object Boolean]";t.exports=function(t){return!0===t||!1===t||s(t)&&r(t)==i}},function(t,e,n){var r=n(175),s=n(65),i=n(176),u=parseFloat,o=Math.min,a=Math.random;t.exports=function(t,e,n){if(n&&"boolean"!=typeof n&&s(t,e,n)&&(e=n=void 0),void 0===n&&("boolean"==typeof e?(n=e,e=void 0):"boolean"==typeof t&&(n=t,t=void 0)),void 0===t&&void 0===e?(t=0,e=1):(t=i(t),void 0===e?(e=t,t=0):e=i(e)),t>e){var c=t;t=e,e=c}if(n||t%1||e%1){var l=a();return o(t+l*(e-t+u("1e-"+((l+"").length-1))),e)}return r(t,e)}},function(t,e){var n=Math.floor,r=Math.random;t.exports=function(t,e){return t+n(r()*(e-t+1))}},function(t,e,n){var r=n(177),s=1/0,i=17976931348623157e292;t.exports=function(t){return t?(t=r(t))===s||t===-s?(t<0?-1:1)*i:t==t?t:0:0===t?t:0}},function(t,e,n){var r=n(2),s=n(21),i=NaN,u=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(s(t))return i;if(r(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=r(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(u,"");var n=a.test(t);return n||c.test(t)?l(t.slice(2),n?2:8):o.test(t)?i:+t}},function(t,e){t.exports=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}},function(t,e,n){var r=n(73);t.exports=function(t){return r(t)&&t!=+t}},function(t,e,n){var r=n(74);t.exports=function(t){return(null==t?0:t.length)?r(t,1):[]}},function(t,e,n){var r=n(9),s=n(31),i=n(3),u=r?r.isConcatSpreadable:void 0;t.exports=function(t){return i(t)||s(t)||!!(u&&t&&t[u])}},function(t,e,n){var r=n(183),s=n(74),i=n(63),u=n(57),o=i((function(t,e){return u(t)?r(t,s(e,1,u,!0)):[]}));t.exports=o},function(t,e,n){var r=n(184),s=n(187),i=n(192),u=n(71),o=n(19),a=n(193),c=200;t.exports=function(t,e,n,l){var p=-1,h=s,f=!0,g=t.length,d=[],A=e.length;if(!g)return d;n&&(e=u(e,o(n))),l?(h=i,f=!1):e.length>=c&&(h=a,f=!1,e=new r(e));t:for(;++p<g;){var m=t[p],v=null==n?m:n(m);if(m=l||0!==m?m:0,f&&v==v){for(var E=A;E--;)if(e[E]===v)continue t;d.push(m)}else h(e,v,l)||d.push(m)}return d}},function(t,e,n){var r=n(25),s=n(185),i=n(186);function u(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new r;++e<n;)this.add(t[e])}u.prototype.add=u.prototype.push=s,u.prototype.has=i,t.exports=u},function(t,e){var n="__lodash_hash_undefined__";t.exports=function(t){return this.__data__.set(t,n),this}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(188);t.exports=function(t,e){return!!(null==t?0:t.length)&&r(t,e,0)>-1}},function(t,e,n){var r=n(189),s=n(190),i=n(191);t.exports=function(t,e,n){return e==e?i(t,e,n):r(t,s,n)}},function(t,e){t.exports=function(t,e,n,r){for(var s=t.length,i=n+(r?1:-1);r?i--:++i<s;)if(e(t[i],i,t))return i;return-1}},function(t,e){t.exports=function(t){return t!=t}},function(t,e){t.exports=function(t,e,n){for(var r=n-1,s=t.length;++r<s;)if(t[r]===e)return r;return-1}},function(t,e){t.exports=function(t,e,n){for(var r=-1,s=null==t?0:t.length;++r<s;)if(n(e,t[r]))return!0;return!1}},function(t,e){t.exports=function(t,e){return t.has(e)}},function(t,e,n){(function(t){function n(t,e){for(var n=0,r=t.length-1;r>=0;r--){var s=t[r];"."===s?t.splice(r,1):".."===s?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}var r=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(t){return r.exec(t).slice(1)};function i(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}e.resolve=function(){for(var e="",r=!1,s=arguments.length-1;s>=-1&&!r;s--){var u=s>=0?arguments[s]:t.cwd();if("string"!=typeof u)throw new TypeError("Arguments to path.resolve must be strings");u&&(e=u+"/"+e,r="/"===u.charAt(0))}return(r?"/":"")+(e=n(i(e.split("/"),(function(t){return!!t})),!r).join("/"))||"."},e.normalize=function(t){var r=e.isAbsolute(t),s="/"===u(t,-1);return(t=n(i(t.split("/"),(function(t){return!!t})),!r).join("/"))||r||(t="."),t&&s&&(t+="/"),(r?"/":"")+t},e.isAbsolute=function(t){return"/"===t.charAt(0)},e.join=function(){var t=Array.prototype.slice.call(arguments,0);return e.normalize(i(t,(function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},e.relative=function(t,n){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=e.resolve(t).substr(1),n=e.resolve(n).substr(1);for(var s=r(t.split("/")),i=r(n.split("/")),u=Math.min(s.length,i.length),o=u,a=0;a<u;a++)if(s[a]!==i[a]){o=a;break}var c=[];for(a=o;a<s.length;a++)c.push("..");return(c=c.concat(i.slice(o))).join("/")},e.sep="/",e.delimiter=":",e.dirname=function(t){var e=s(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},e.basename=function(t,e){var n=s(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},e.extname=function(t){return s(t)[3]};var u="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return e<0&&(e=t.length+e),t.substr(e,n)}}).call(this,n(43))},function(t,e,n){const r=n(196);var s,i=((s=new r).instance=function(){return s=new r},String.prototype.t=function(...t){return s.translate(this,...t)},"undefined"!=typeof Handlebars&&s.load.Handlebars(Handlebars),"undefined"!=typeof angular&&s.load.Angular(angular),"undefined"!=typeof Vue&&Vue.use(s.load.Vue),s);t.exports=i},function(t,e,n){let r,s=!1;"undefined"==typeof window&&(r=n(197),s=!0),t.exports=class t{constructor(){this.current="en",this.data={},this.options={},this._path=null,this._cache={},this._list=[]}set(t,e){return this.init(t,this._path,e),this}add(t,e,n,r){this.init(t,e,r,{namespace:n})}packages(t,e={}){let n=[];const r=e.namespace||"self";this._cache[r]||(this._cache[r]={});for(let e in t)this._cache[r][e]=t[e],n.push(e);return this.init(n,!1,!1,e)}default(t){this.current=t}all(t,e,n={}){const s=r=>{let s=[],i=/\.json$/;for(let t of r)i.test(t)&&s.push(t.replace(i,""));this.init(s,t,e,n)};e?r.readdir(t,(t,e)=>{if(t)throw t;s(e)}):s(r.readdirSync(t))}init(t,e,n,s={}){let i,u;const o=s.namespace||"self";"function"==typeof e&&(n=e,e=!1),this._path=e,t instanceof Array||(t=[t]),this._list=t;let a=(t=>t+="_"+t.toUpperCase())(this.getUserLanguage().replace(/\-.+/,""));-1==this._list.indexOf(a)?this.current=this._list[0]:this.current=a,e&&(i=e+this.current+".json");let c=(t,r,s)=>{let i;r||(r=this.current),e?(t=t.toString("utf8"),i=JSON.parse(t)):i=t,this._cache[o]||(this._cache[o]={});let[u,a]=i;this.data[r]={},this.options[r]={},this.data[r][o]=this._initMultiple(u),this.options[r][o]=a,this._cache[o][r]=t,n&&!s&&n.call(self)};if(this._cache[o]&&this._cache[o][this.current]){for(let t in this._cache[o])c(this._cache[o][t],t);return this}if(r){if(n){let t=0;for(let s of this._list)r.readFile(e+s+".json",(e,r)=>{if(e)throw e;c(r,s,!0),t++,n&&t==this._list.length&&n.call(this)})}else for(let t of this._list)c(r.readFileSync(e+t+".json"),t,!0);return this}try{u=new XMLHttpRequest}catch(t){u=!1}return u.onreadystatechange=()=>{4==u.readyState&&200==u.status&&c(u.responseText)},u.open("GET",i,!0),u.send(),this}getUserLanguage(){const t=this._list[0];return s?t:navigator.language||navigator.userLanguage||t}_initMultiple(t){let e,n,r={},s={};function i(t,e,n,r){let s={},i=r?r[t]:e[t],u=n.split(" ");for(let r in i){let i=n.replace(t,r);e[n].text?s[i]={text:e[n].text,replacePattern:e[n].replacePattern.map(e=>t==e?r:e)}:s[i]={text:e[n],replacePattern:u.map(e=>t==e?r:e)}}return s}function u(t,e){for(let n in e)t[n]=e[n];return t}const o=JSON.parse(JSON.stringify(t));for(let a in o){let o=/^\$[^ ]+$/.test(a),c=/\[(.+)\]/,l=/\$[^ ]+/g;if(c.test(a)){e=c.exec(a)[1].split(",");for(let n of e)t[a.replace(c,n)]=t[a]}if(l.test(a)&&!o)if(r={},s={},n=a.match(l),r=i(n[0],t,a),n.length>1)for(let e in r)s=i(n[1],r,e,t),u(t,s);else u(t,r);if(o){if(t[a]instanceof Array){let e={},n=a.replace(/^\$/,"");for(let r=0;r<t[a].length;r++)e[n+"_"+r]=t[a][r];t[a]=e}for(let e in t[a])t[e]=t[a][e]}}return t}get(t,e,n){return n=n||this.current,e=e||"self",this.data[n]&&this.data[n][e]?this.replaceWorlds(this.data[n][e][t],t,e):""}capitalizeFirstLetter(t){return t.charAt(0).toUpperCase()+t.slice(1)}replaceWorlds(t,e,n){let r={};return t?(t.text&&(r=t,t=t.text),t.replace(/\{([0-9]+)\}/g,(t,s)=>{let i=r.replacePattern||e.split(" ");return this.get(i[s-1],n)})):t}getGroup(t,e="self"){let n=this.data[this.current][e]["$"+t],r=[];for(let t in n)r.push(t);return r}render(t,{patternStart:e="{{",patternEnd:n="}}",pipe:r="|",fnStart:s="",fnEnd:i="",paramsSeparator:u=":"}={},o){const a=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");e=a(e),n=a(n),r=a(r),s=a(s),i=a(i);let c=a(u);const l=new RegExp(`${e}([^${n}]+)${r}[ ]*t(${c}?${s}([^${n}]+)${i})?${n}`,"g");return t=t.replace(l,(t,e,n,r,s,i)=>(e=(e=e.replace(/["']/g,"")).trim(),r=r?(r=r.split(u)).map(t=>((t=t.trim())>=0||t<=0?t=+t:"true"==t?t="true"===t:"false"==t&&(t="false"===t),t)):[],o&&(r=[o,...r]),this.translate(e,...r)))}getPlurial(t,e,n,r){if(n=n||"self",r=r||this.current,t=Math.abs(t),!/^[0-9]+$/.test(t))return!1;let s=this.options[r][n].plurial[e];return s||(s=["s"]),t>2&&s[t-1]?s[t-1]:t>1?s[0]:s[1]||""}format(t,e,n,...r){let s,i,u=-1,o=t.match(/%[sdp]/g);if(!o)return t;for(let t of o)if(u++,"%d"==t)s=r[u];else if("%p"==t)break;return u=-1,t.replace(/%[sdp]([0-9]+)?/g,(t,o)=>(u++,i=void 0!==r[u]?r[u]:t,/^%p/.test(t)&&(null==s&&(s=i),"number"!=typeof s&&(s=0),i=this.getPlurial(s,t.replace("%",""),e,n)),i))}get load(){let e=this;return{Handlebars:t=>(t.registerHelper("t",(function(t,e){var n=e.hash.nb,r=e.hash.if;return void 0===n?t.t():void 0===r?t.t(+n):t.t(r,+n)})),t),Pug:(t={})=>(t.translate=t=>e.render(t),t),Angular(n){n.module("Languages",[]).provider("Languages",(function(){this.init=e.init.bind(t),this.$get=function(){return e}})).filter("t",(function(){return function(t,...e){return t.t(...e)}}))},get Vue(){return{install(t,n){t.Languages=e,t.filter("t",(t,...n)=>e.translate(t,...n))}}}}}translate(t,...e){var n,r,s;if(null==t)return"";let i=e[0];function u(){e.shift(),i=e[0]}if(-1!=this._list.indexOf(e[0])&&(s=i,u()),"boolean"==typeof i){let e=t.match(/\((.*?)\)/);e?(n=e[1].split("|"),r=i?t.replace(e[0],n[0].trim()):t.replace(e[0],n[1].trim())):(n=t.split("|"),r=i?n[0]:n[1]),u()}else r=t;let o=r.split("+"),a="";for(let t of o){let n,r;(n=/(.+)\.(.+)/.exec(t))&&(r=n[1],t=n[2]);let i=this.get(t.trim(),r,s);i&&(a+=this.format(i,r,s,...e)),a+=" "}return this.capitalizeFirstLetter(a.trim())}}},function(t,e){},function(t,e,n){const r=n(7);t.exports=class{constructor(t){this.address={},this._infoAddress={lock:{},actived:{}},this.varFn={},this.magicVar={},this.variables={},this.id=t,this.lang=null,this._history=[],this._nlpCache={}}_createNamespace(t){this.address[t]||(this.address[t]=[]),this.variables[t]||(this.variables[t]={}),this.varFn[t]||(this.varFn[t]={})}addAddress(t,e){this._createNamespace(e),this.address[e].push(t)}getAddress(t){return this._createNamespace(t),r.last(this.address[t])}hasAddress(t){return this._createNamespace(t),this.address[t].length>0}clearAddress(t){this._createNamespace(t),this.address[t]=[]}popAddress(t){this._createNamespace(t),this.address[t].pop()}garbage(t,e){this._createNamespace(e),delete this.varFn[e][t]}hasLockAddressStack(t){return!!this._infoAddress.lock[t]}lockAddressStack(t,e,{activated:n}={}){this._infoAddress.lock[t]=e,n&&(this._infoAddress.actived[t]=e)}unlockAddressStack(t,e,{activated:n}={}){this._infoAddress.lock[t]===e&&(delete this._infoAddress.lock[t],n&&delete this._infoAddress.actived[t])}addressStackIslocked(t){return this._infoAddress.lock[t]}getVariables(t){return this._createNamespace(t),this.variables[t]}getVariable(t,e){return e=e.replace(/^\$/,""),this._createNamespace(t),this.variables[t][e]}setVariable(t,e,n){e=e.replace(/^\$/,""),this._createNamespace(t),this.variables[t][e]=n}getVariableInFonction(t,e,n){return this._createNamespace(t),this.varFn[t][e]||(this.varFn[t][e]={}),n?this.varFn[t][e][n]:this.varFn[t][e]}setVariableInFonction(t,e,n,r){return this._createNamespace(t),this.varFn[t][e]||(this.varFn[t][e]={}),this.varFn[t][e][n]=r}getMagicVariable(t){return this.magicVar[t]}setMagicVariable(t,e){this.magicVar[t]=e}saveSession(t){this.session=t}retrieveSession(){return this.session}setLang(t){this.lang=t}getLang(){return this.lang}addHistory(t){this._history.push(t)}resetHistory(t){this._history=[]}toJson(){return{_current:{_address:this.address,_var:this.varFn,_magicVar:this.magicVar,_infoAddress:this._infoAddress},_session:this.session,data:this.variables,lang:this.lang,id:this.id}}fromJson(t){return this.address=t._current._address||{},this._infoAddress=t._current._infoAddress||{lock:{}},this.varFn=t._current._var||{},this.magicVar=t._current._magicVar||{},this.session=t._session||{},this.variables=t.data||{},this.lang=t.lang,this.id=t.id,this}}},function(t,e,n){(function(e){const r=n(7),s=n(22),i=n(40);let u;u=s.is()?window.newbotParser:e.newbotParser,"undefined"!=typeof window&&(window._=r);t.exports=class{constructor(t,e){this.variables={},this._script=t,this.namespace=e,this.parser=u}run(t){if(s.is()&&!this.parser)throw'You can not use the parser. Integrate rather the "newbot.with-parser.min.js" file';try{return this.parser.parse(this._script)}catch(t){new i(this._script,this.namespace).syntax(t)}}line(t){return t=t.trim(),this.parser.parse(t)}isVariable(){}}}).call(this,n(42))},function(t,e,n){var r,s,i,u,o;r=n(201),s=n(76).utf8,i=n(202),u=n(76).bin,(o=function(t,e){t.constructor==String?t=e&&"binary"===e.encoding?u.stringToBytes(t):s.stringToBytes(t):i(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());for(var n=r.bytesToWords(t),a=8*t.length,c=1732584193,l=-271733879,p=-1732584194,h=271733878,f=0;f<n.length;f++)n[f]=16711935&(n[f]<<8|n[f]>>>24)|4278255360&(n[f]<<24|n[f]>>>8);n[a>>>5]|=128<<a%32,n[14+(a+64>>>9<<4)]=a;var g=o._ff,d=o._gg,A=o._hh,m=o._ii;for(f=0;f<n.length;f+=16){var v=c,E=l,y=p,C=h;c=g(c,l,p,h,n[f+0],7,-680876936),h=g(h,c,l,p,n[f+1],12,-389564586),p=g(p,h,c,l,n[f+2],17,606105819),l=g(l,p,h,c,n[f+3],22,-1044525330),c=g(c,l,p,h,n[f+4],7,-176418897),h=g(h,c,l,p,n[f+5],12,1200080426),p=g(p,h,c,l,n[f+6],17,-1473231341),l=g(l,p,h,c,n[f+7],22,-45705983),c=g(c,l,p,h,n[f+8],7,1770035416),h=g(h,c,l,p,n[f+9],12,-1958414417),p=g(p,h,c,l,n[f+10],17,-42063),l=g(l,p,h,c,n[f+11],22,-1990404162),c=g(c,l,p,h,n[f+12],7,1804603682),h=g(h,c,l,p,n[f+13],12,-40341101),p=g(p,h,c,l,n[f+14],17,-1502002290),c=d(c,l=g(l,p,h,c,n[f+15],22,1236535329),p,h,n[f+1],5,-165796510),h=d(h,c,l,p,n[f+6],9,-1069501632),p=d(p,h,c,l,n[f+11],14,643717713),l=d(l,p,h,c,n[f+0],20,-373897302),c=d(c,l,p,h,n[f+5],5,-701558691),h=d(h,c,l,p,n[f+10],9,38016083),p=d(p,h,c,l,n[f+15],14,-660478335),l=d(l,p,h,c,n[f+4],20,-405537848),c=d(c,l,p,h,n[f+9],5,568446438),h=d(h,c,l,p,n[f+14],9,-1019803690),p=d(p,h,c,l,n[f+3],14,-187363961),l=d(l,p,h,c,n[f+8],20,1163531501),c=d(c,l,p,h,n[f+13],5,-1444681467),h=d(h,c,l,p,n[f+2],9,-51403784),p=d(p,h,c,l,n[f+7],14,1735328473),c=A(c,l=d(l,p,h,c,n[f+12],20,-1926607734),p,h,n[f+5],4,-378558),h=A(h,c,l,p,n[f+8],11,-2022574463),p=A(p,h,c,l,n[f+11],16,1839030562),l=A(l,p,h,c,n[f+14],23,-35309556),c=A(c,l,p,h,n[f+1],4,-1530992060),h=A(h,c,l,p,n[f+4],11,1272893353),p=A(p,h,c,l,n[f+7],16,-155497632),l=A(l,p,h,c,n[f+10],23,-1094730640),c=A(c,l,p,h,n[f+13],4,681279174),h=A(h,c,l,p,n[f+0],11,-358537222),p=A(p,h,c,l,n[f+3],16,-722521979),l=A(l,p,h,c,n[f+6],23,76029189),c=A(c,l,p,h,n[f+9],4,-640364487),h=A(h,c,l,p,n[f+12],11,-421815835),p=A(p,h,c,l,n[f+15],16,530742520),c=m(c,l=A(l,p,h,c,n[f+2],23,-995338651),p,h,n[f+0],6,-198630844),h=m(h,c,l,p,n[f+7],10,1126891415),p=m(p,h,c,l,n[f+14],15,-1416354905),l=m(l,p,h,c,n[f+5],21,-57434055),c=m(c,l,p,h,n[f+12],6,1700485571),h=m(h,c,l,p,n[f+3],10,-1894986606),p=m(p,h,c,l,n[f+10],15,-1051523),l=m(l,p,h,c,n[f+1],21,-2054922799),c=m(c,l,p,h,n[f+8],6,1873313359),h=m(h,c,l,p,n[f+15],10,-30611744),p=m(p,h,c,l,n[f+6],15,-1560198380),l=m(l,p,h,c,n[f+13],21,1309151649),c=m(c,l,p,h,n[f+4],6,-145523070),h=m(h,c,l,p,n[f+11],10,-1120210379),p=m(p,h,c,l,n[f+2],15,718787259),l=m(l,p,h,c,n[f+9],21,-343485551),c=c+v>>>0,l=l+E>>>0,p=p+y>>>0,h=h+C>>>0}return r.endian([c,l,p,h])})._ff=function(t,e,n,r,s,i,u){var o=t+(e&n|~e&r)+(s>>>0)+u;return(o<<i|o>>>32-i)+e},o._gg=function(t,e,n,r,s,i,u){var o=t+(e&r|n&~r)+(s>>>0)+u;return(o<<i|o>>>32-i)+e},o._hh=function(t,e,n,r,s,i,u){var o=t+(e^n^r)+(s>>>0)+u;return(o<<i|o>>>32-i)+e},o._ii=function(t,e,n,r,s,i,u){var o=t+(n^(e|~r))+(s>>>0)+u;return(o<<i|o>>>32-i)+e},o._blocksize=16,o._digestsize=16,t.exports=function(t,e){if(null==t)throw new Error("Illegal argument "+t);var n=r.wordsToBytes(o(t,e));return e&&e.asBytes?n:e&&e.asString?u.bytesToString(n):r.bytesToHex(n)}},function(t,e){var n,r;n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&r.rotl(t,8)|4278255360&r.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=r.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],n=0,r=0;n<t.length;n++,r+=8)e[r>>>5]|=t[n]<<24-r%32;return e},wordsToBytes:function(t){for(var e=[],n=0;n<32*t.length;n+=8)e.push(t[n>>>5]>>>24-n%32&255);return e},bytesToHex:function(t){for(var e=[],n=0;n<t.length;n++)e.push((t[n]>>>4).toString(16)),e.push((15&t[n]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],n=0;n<t.length;n+=2)e.push(parseInt(t.substr(n,2),16));return e},bytesToBase64:function(t){for(var e=[],r=0;r<t.length;r+=3)for(var s=t[r]<<16|t[r+1]<<8|t[r+2],i=0;i<4;i++)8*r+6*i<=8*t.length?e.push(n.charAt(s>>>6*(3-i)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],r=0,s=0;r<t.length;s=++r%4)0!=s&&e.push((n.indexOf(t.charAt(r-1))&Math.pow(2,-2*s+8)-1)<<2*s|n.indexOf(t.charAt(r))>>>6-2*s);return e}},t.exports=r},function(t,e){function n(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
t.exports=function(t){return null!=t&&(n(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&n(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e,n){!function(n){"use strict";var r=function(t,e){var n=new Error(t+" at character "+e);throw n.index=e,n.description=t,n},s={"-":!0,"!":!0,"~":!0,"+":!0},i={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},u=function(t){var e,n=0;for(var r in t)(e=r.length)>n&&t.hasOwnProperty(r)&&(n=e);return n},o=u(s),a=u(i),c={true:!0,false:!1,null:null},l=function(t){return i[t]||0},p=function(t,e,n){return{type:"||"===t||"&&"===t?"LogicalExpression":"BinaryExpression",operator:t,left:e,right:n}},h=function(t){return t>=48&&t<=57},f=function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=128&&!i[String.fromCharCode(t)]},g=function(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||t>=128&&!i[String.fromCharCode(t)]},d=function(t){for(var e,n,u=0,d=t.charAt,A=t.charCodeAt,m=function(e){return d.call(t,e)},v=function(e){return A.call(t,e)},E=t.length,y=function(){for(var t=v(u);32===t||9===t||10===t||13===t;)t=v(++u)},C=function(){var t,e,n=F();return y(),63!==v(u)?n:(u++,(t=C())||r("Expected expression",u),y(),58===v(u)?(u++,(e=C())||r("Expected expression",u),{type:"ConditionalExpression",test:n,consequent:t,alternate:e}):void r("Expected :",u))},b=function(){y();for(var e=t.substr(u,a),n=e.length;n>0;){if(i.hasOwnProperty(e)&&(!f(v(u))||u+e.length<t.length&&!g(v(u+e.length))))return u+=n,e;e=e.substr(0,--n)}return!1},F=function(){var t,e,n,s,i,o,a,c;if(o=x(),!(e=b()))return o;for(i={value:e,prec:l(e)},(a=x())||r("Expected expression after "+e,u),s=[o,i,a];(e=b())&&0!==(n=l(e));){for(i={value:e,prec:n};s.length>2&&n<=s[s.length-2].prec;)a=s.pop(),e=s.pop().value,o=s.pop(),t=p(e,o,a),s.push(t);(t=x())||r("Expected expression after "+e,u),s.push(i,t)}for(t=s[c=s.length-1];c>1;)t=p(s[c-1].value,s[c-2],t),c-=2;return t},x=function(){var e,n,r;if(y(),e=v(u),h(e)||46===e)return D();if(39===e||34===e)return _();if(91===e)return P();for(r=(n=t.substr(u,o)).length;r>0;){if(s.hasOwnProperty(n)&&(!f(v(u))||u+n.length<t.length&&!g(v(u+n.length))))return u+=r,{type:"UnaryExpression",operator:n,argument:x(),prefix:!0};n=n.substr(0,--r)}return!(!f(e)&&40!==e)&&k()},D=function(){for(var t,e,n="";h(v(u));)n+=m(u++);if(46===v(u))for(n+=m(u++);h(v(u));)n+=m(u++);if("e"===(t=m(u))||"E"===t){for(n+=m(u++),"+"!==(t=m(u))&&"-"!==t||(n+=m(u++));h(v(u));)n+=m(u++);h(v(u-1))||r("Expected exponent ("+n+m(u)+")",u)}return e=v(u),f(e)?r("Variable names cannot start with a number ("+n+m(u)+")",u):46===e&&r("Unexpected period",u),{type:"Literal",value:parseFloat(n),raw:n}},_=function(){for(var t,e="",n=m(u++),s=!1;u<E;){if((t=m(u++))===n){s=!0;break}if("\\"===t)switch(t=m(u++)){case"n":e+="\n";break;case"r":e+="\r";break;case"t":e+="\t";break;case"b":e+="\b";break;case"f":e+="\f";break;case"v":e+="\v";break;default:e+=t}else e+=t}return s||r('Unclosed quote after "'+e+'"',u),{type:"Literal",value:e,raw:n+e+n}},B=function(){var e,n=v(u),s=u;for(f(n)?u++:r("Unexpected "+m(u),u);u<E&&(n=v(u),g(n));)u++;return e=t.slice(s,u),c.hasOwnProperty(e)?{type:"Literal",value:c[e],raw:e}:"this"===e?{type:"ThisExpression"}:{type:"Identifier",name:e}},w=function(t){for(var e,n,s=[],i=!1;u<E;){if(y(),(e=v(u))===t){i=!0,u++;break}44===e?u++:((n=C())&&"Compound"!==n.type||r("Expected comma",u),s.push(n))}return i||r("Expected "+String.fromCharCode(t),u),s},k=function(){var t,e;for(e=40===(t=v(u))?S():B(),y(),t=v(u);46===t||91===t||40===t;)u++,46===t?(y(),e={type:"MemberExpression",computed:!1,object:e,property:B()}):91===t?(e={type:"MemberExpression",computed:!0,object:e,property:C()},y(),93!==(t=v(u))&&r("Unclosed [",u),u++):40===t&&(e={type:"CallExpression",arguments:w(41),callee:e}),y(),t=v(u);return e},S=function(){u++;var t=C();if(y(),41===v(u))return u++,t;r("Unclosed (",u)},P=function(){return u++,{type:"ArrayExpression",elements:w(93)}},j=[];u<E;)59===(e=v(u))||44===e?u++:(n=C())?j.push(n):u<E&&r('Unexpected "'+m(u)+'"',u);return 1===j.length?j[0]:{type:"Compound",body:j}};d.version="0.3.4",d.toString=function(){return"JavaScript Expression Parser (JSEP) v"+d.version},d.addUnaryOp=function(t){return o=Math.max(t.length,o),s[t]=!0,this},d.addBinaryOp=function(t,e){return a=Math.max(t.length,a),i[t]=e,this},d.addLiteral=function(t,e){return c[t]=e,this},d.removeUnaryOp=function(t){return delete s[t],t.length===o&&(o=u(s)),this},d.removeAllUnaryOps=function(){return s={},o=0,this},d.removeBinaryOp=function(t){return delete i[t],t.length===a&&(a=u(i)),this},d.removeAllBinaryOps=function(){return i={},a=0,this},d.removeLiteral=function(t){return delete c[t],this},d.removeAllLiterals=function(){return c={},this},t.exports?e=t.exports=d:e.parse=d}()},function(t,e){t.exports=new class{async map(t,e){for(let n=0;n<t.length;n++)t[n]=await e(t[n]);return t}}},function(t,e){t.exports=function(t,e,n=function(){}){if(!e.global)return function(t,e,n){const r=t.match(e);return r?n(...r,r.index,r.input).then(n=>t.replace(e,n)):Promise.resolve(t)}(t,e,n);const r=t.match(e);if(!r)return Promise.resolve(t);let s=0,i=0;const u=[],o=new RegExp(e.source,e.flags.replace("g","")),a=[];for(;r.length>0;){const e=r.shift(),c=t.indexOf(e,i);u[s]=t.slice(i,c),s++;let l=s;a.push(n(...e.match(o),c,t).then(t=>{u[l]=t})),i=c+e.length,s++}return u[s]=t.slice(i),Promise.all(a).then(()=>u.join(""))}},function(t,e,n){const r=n(207),s=n(40),i=n(7);t.exports=class{constructor(t){this.decorators={},this.interpreter=t,this.error=new s(this.interpreter.converse.script,this.interpreter.namespace);for(let t in r)this.decorators[t]=[]}add(t){if(!t.decorators)return;const{decorators:e,name:n}=t;let s=[];for(let i of e)this.decorators[i.name]||this.error.throw(t,"decorator.error",new Error(`Decorator "${i.name}" not exists`)),s.push(new r[i.name](i,n));for(let t of s){for(let e of s)t.name!=e.name&&(t.otherDecorators[e.name]||(t.otherDecorators[e.name]=[]),t.otherDecorators[e.name].push(e));this.decorators[t.name].push(t)}}get(t,e){let n=this.decorators[t],r=[];if(0===n.length)return[];i.isArray(e)||(e=[e]);for(let t of n)(i.isUndefined(e[0])||t.findParam(e))&&r.push(t);return r}async _exec(t,e,n,s){let i=!1;const u=async t=>{let n=!1;if(t.otherDecorators.Condition)for(let n of t.otherDecorators.Condition){if(!await n.run(e))return!1}const u=this.interpreter.fn[t.fnName],{_canActivated:o,_skills:a}=e.converse,c=t=>{const s=o[t],i=a.get(s),l=i._interpreter.execution.decorators,p=l.get("Event",r.Event.CAN_ACTIVATE);return 0!=p.length&&(l.exec(p,i._interpreter.execution,null,n=>{if(t++,!0!==n.value)return e.end();o[t]?c(t):e.execFn(u,0,()=>e.end())}),n=!0,!0)};return o.length>0&&(c(0)?(e.user.addAddress(u.id,e.namespace),e.user.lockAddressStack(e.namespace,u.name,{activated:!0})):e.debug("warning",{message:"You call skills in the canActivated property but are never triggered"})),i=!0,n||e.execFn(u,0,t=>{if(!s)return e.end();s(t)}),!0};for(let r of t){let t=null;if(n&&r[n]&&(t=r[n](e)),t instanceof Promise){if(await t&&!i){if(await u(r))break}}else{if(await u(r))break}}return i}async execMethod(t,e,n){const r=this.decorators[t];return await this._exec(r,n,e)}async exec(t,e,n,r){return i.isArray(t)||(t=this.get(t,n)),!!t&&await this._exec(t,e,null,r)}}},function(t,e,n){const r=n(78),s=n(208),i=n(209),u=n(210);t.exports={Event:r,Intent:s,Action:i,Condition:u}},function(t,e,n){const r=n(23),s=n(7);t.exports=class extends r{run(t){return new Promise((e,n)=>{const{intents:r}=t;if(this.instructions&&this.instructions.length>0)return void t.execBlock({instructions:this.instructions},0,"test",()=>{e(!0)});if(!r)return e(!1);const i=this.params[0];let u=r[i];if(i.regexp){if(new RegExp(i.regexp,i.flags.join("")).test(t.input))return e(!0)}if(s.isFunction(u)&&(u=u()),u)return t.setMagicVar("intent",u),e(!0);e(!1)})}}},function(t,e,n){const r=n(23);t.exports=class extends r{}},function(t,e,n){const r=n(23);t.exports=class extends r{run(t){return new Promise(async(e,n)=>{const{converse:r,user:s,options:i}=t;for(let t of this.params){let u=r._conditions[t];if(!u)return void n(new Error(`${t} condition function not exists`));let o=u(i.data,s);if(o instanceof Promise&&(o=await o),!o)return void e(!1)}e(!0)})}}},function(t,e,n){const r=n(212),s=n(213),i=n(214),u=n(215),o=n(216),a=n(217);t.exports={Users:r,Array:s,Lang:i,Utils:u,Eval:o,debugger:a}},function(t,e){const n={$params:["users"],nbUsers:t=>t.size,sum(t,e){let n=0;for(let[,r]of e)n+=+r.getVariable(this.namespace,t);return n},avg(t,e){return this.sum(t,e)/this.nbUsers(e)}};t.exports=n},function(t,e){const n={length:t=>t.length,push:(t,e)=>t.push(e),pushOnlyUniq(t,e){return-1===t.indexOf(e)?this.push(t,e):t},indexOf:(t,e)=>t.indexOf(e)};t.exports=n},function(t,e){const n={fr_FR:["Franais","French"],en_EN:["English","English"]},r={$params:["user"],set(t,e){t&&e.setLang(t)},name(t){const e=t.getLang();return n[e][0]}};t.exports=r},function(t,e){const n={uniqid:()=>(new Date).valueOf().toString(36)+Math.random().toString(36).substr(2)};t.exports=n},function(t,e,n){const r=n(75),s={$params:["users","execution"],json(t,e,n){try{const{converse:s,user:i,_input:u,options:o,propagate:a}=n,c=JSON.parse(t);return new r(c,e,n.converse).exec(i,u,o,a)}catch(t){console.log(t)}}};t.exports=s},function(t,e){const n={$params:["user","execution","level"],$call(t,e,n){const{namespace:r}=e,s=(t,e)=>{console.log(`--- ${e} ---`);for(let e in t)console.log(`\n * ${e} = `,JSON.stringify(t[e],null,2));console.log("\n")};console.log("* Skill : "+r),console.log("* User Id : "+t.id),console.log("* Current Lang : "+t.lang),s(t.variables[r],"global variables"),s(t.magicVar,"magic variables"),s(t.varFn[r][n],`${n}(...) function`)}};t.exports=n},function(t,e){t.exports=class{constructor(t,e){this.script=t,this.history=e}organize(){this.script.split("\n");console.log(this.history[0]._file)}display(){const t=this.organize();console.log("--- %s ---",DEBUG);for(let e of t)console.log(e);console.log("------")}}},function(t,e,n){const r=n(7);t.exports=class{constructor(t,e,n={}){this.name=t,this.converse=e,this.options=n,this.uuid=n.uuid,this.priority=this.options.priority?this.options.priority:void 0,this.intents={}}add(t){r.isFunction(t)?this.intents=t:this.intents=r.merge(this.intents,t)}exec(t,e,n=this.converse){return new Promise((s,i)=>{if(n._mockNlp&&n._mockNlp[this.name]){const n=this.converse._mockNlp[this.name](t,e);s({structured:n})}else r.isFunction(this.intents)?this.intents(t,e,n).then(t=>{s({intents:t})}):s()}).then(({structured:r,intents:s}={})=>{s=s||this.intents;let i={};for(let u in s){let o=s[u],a="string"==typeof e?n._users.get(e):e,c=o(t,r,a);c&&(i[u]=c)}return i})}}},function(t,e,n){const r=n(221),s=n(22);t.exports=new class{readFile(t,e){return s.is()?new Promise((e,n)=>{const r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(200==r.status?e(r.responseText):n(r))},r.open("GET",t,!0),r.send()}):new Promise((n,s)=>{r.readFile(t,e,(t,e)=>{if(t)return s(t);n(e)})})}}},function(t,e){},function(t){t.exports={version:"0.6.3"}},function(t,e,n){"use strict";var r=n(44),s=n(45),i={findRule:function(t,e){return r.find(t.rules,(function(t){return t.name===e}))},indexOfRule:function(t,e){return r.indexOf(t.rules,(function(t){return t.name===e}))},alwaysConsumesOnSuccess:function(t,e){function n(){return!0}function u(){return!1}function o(t){return a(t.expression)}var a=s.build({rule:o,named:o,choice:function(t){return r.every(t.alternatives,a)},action:o,sequence:function(t){return r.some(t.elements,a)},labeled:o,text:o,simple_and:u,simple_not:u,optional:u,zero_or_more:u,one_or_more:o,group:o,semantic_and:u,semantic_not:u,rule_ref:function(e){return a(i.findRule(t,e.name))},literal:function(t){return""!==t.value},class:n,any:n});return a(e)}};t.exports=i},function(t,e,n){"use strict";n.r(e);var r=n(41);n.d(e,"Converse",(function(){return r.Converse})),n.d(e,"NewBot",(function(){return r.NewBot}));var s=n(239);n.n(s)()()},function(t,e,n){const{defaultContainer:r}=n(6);class s{constructor(t=r){this.container=t.container||t,this.name="arrToObj"}static arrToObj(t){const e={};for(let n=0;n<t.length;n+=1)e[t[n]]=1;return e}run(t){return Array.isArray(t)?s.arrToObj(t):(t.tokens=s.arrToObj(t.tokens),t)}}t.exports=s},function(t,e,n){(function(e){const r=n(225),{Container:s}=n(6),i=n(82),u=n(227),{loadEnvFromJson:o}=n(79),a=n(228),c=n(229),l=n(81),p=n(230),h=n(80),f=n(231),g=n(243);t.exports=function(t={},n,d,A,m,v){const E=d||new s(A);E.parent=v,A||(E.register("fs",g),E.use(r),E.use(i),E.use(u),E.use(a),E.use(c),E.use(l),E.use(p),E.use(h),E.use(f));const y=t;let C;if(t.env&&o(A,t.env),C=y,C=function t(n,r){if("string"==typeof n)return n.startsWith("$")?e.env[`${r}${n.slice(1)}`]||e.env[n.slice(1)]:n;if(Array.isArray(n))return n.map(e=>t(e,r));if("object"==typeof n){const e=Object.keys(n),s={};for(let i=0;i<e.length;i+=1)s[e[i]]=t(n[e[i]],r);return s}return n}(C,A?`${A}_`:""),C.settings){const t=Object.keys(C.settings);for(let e=0;e<t.length;e+=1)E.registerConfiguration(t[e],C.settings[t[e]],!0)}if(C.terraform)for(let t=0;t<C.terraform.length;t+=1){const e=C.terraform[t],n=E.get(e.className);E.register(e.name,n,!0)}if(C.childs&&(E.childs=C.childs),m)for(let t=0;t<m.length;t+=1){const e=m[t];E.registerPipeline(e.tag,e.pipeline,e.overwrite)}return C.pipelines&&function(t,e){t.loadPipelinesFromString(e)}(E,C.pipelines),E}}).call(this,n(43))},function(t,e,n){const{defaultContainer:r}=n(6);class s{constructor(t=r){this.container=t.container||t,this.name="objToArr"}static objToArr(t){return Object.keys(t)}run(t){return t.tokens?(t.tokens=s.objToArr(t.tokens),t):s.objToArr(t)}}t.exports=s},function(t,e,n){const{defaultContainer:r}=n(6);t.exports=class{constructor(t=r){this.container=t.container||t,this.name="stem"}stem(t){return t}getStemmer(t){const e=t,n=(e.locale||e.settings)&&e.settings.locale||"en";return this.container.get(`stemmer-${n}`)||this}async addForTraining(t){const e=this.getStemmer(t);return e.addUtterance&&await e.addUtterance(t.utterance,t.intent),t}async train(t){const e=this.getStemmer(t);return e.innerTrain&&await e.innerTrain(),t}async run(t){const e=t,n=this.getStemmer(e);return e.tokens=await n.stem(e.tokens,e),e}}},function(t,e,n){const{defaultContainer:r}=n(6);t.exports=class{constructor(t=r){this.container=t.container||t,this.name="removeStopwords",this.dictionary={}}build(t){for(let e=0;e<t.length;e+=1)this.dictionary[t[e]]=!0}isNotStopword(t){return!this.dictionary[t]}isStopword(t){return!!this.dictionary[t]}removeStopwords(t){return t.filter(t=>this.isNotStopword(t))}run(t){if(t.settings&&!1===t.settings.keepStopwords){const e=t,n=e.locale||"en",r=this.container.get(`stopwords-${n}`)||this;return e.tokens=r.removeStopwords(e.tokens,e).filter(t=>t),e}return t}}},function(t,e,n){const{defaultContainer:r}=n(6);t.exports=class{constructor(t=r){this.container=t.container||t,this.name="timer"}start(t){return t&&(t.hrstart=new Date),t}stop(t){const e=t;if(e&&e.hrstart){const t=new Date;e.elapsed=t.getTime()-e.hrstart.getTime(),delete e.hrstart}return e}run(t){this.start(t)}}},function(t,e,n){const{defaultContainer:r}=n(6),s=n(83);t.exports=class extends s{constructor(t={},e){super({settings:{},container:t.container||e||r},e),this.applySettings(this.settings,t),this.applySettings(this.settings,{etag:1,memory:{}}),this.settings.tag||(this.settings.tag="storage"),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag))}read(t){return new Promise(e=>{const n={};Array.isArray(t)||(t=[t]),t.forEach(t=>{const e=this.settings.memory[t];e&&(n[t]=JSON.parse(e))}),e(n)})}saveItem(t,e){const n={...e};return n.eTag=this.settings.etag.toString(),this.settings.etag+=1,this.settings.memory[t]=JSON.stringify(n),n}write(t){return new Promise((e,n)=>{Object.keys(t).forEach(r=>{const s=t[r],i=this.settings.memory[r];if(!i||"*"===s.eTag)return e(this.saveItem(r,s));const u=JSON.parse(i);return s.eTag!==u.eTag?n(new Error(`Error writing "${r}" due to eTag conflict.`)):e(this.saveItem(r,s))})})}delete(t){return new Promise(e=>{t.forEach(t=>delete this.settings.memory[t]),e()})}}},function(t,e,n){const{Clonable:r}=n(5),{SpellCheck:s}=n(233),i=n(251);t.exports=class extends r{constructor(t={},e){super({settings:{},container:t.container||e},e),this.applySettings(this.settings,t),this.applySettings(this.settings,{locale:"en"}),this.settings.tag||(this.settings.tag=`nlu-${this.settings.locale}`),this.registerDefault(),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag)),this.applySettings(this,{pipelinePrepare:this.getPipeline(`${this.settings.tag}-prepare`),pipelineTrain:this.getPipeline(`${this.settings.tag}-train`),pipelineProcess:this.getPipeline(`${this.settings.tag}-process`)}),this.spellCheck=new s}registerDefault(){this.container.registerConfiguration("nlu-??",{keepStopwords:!0,nonefeatureValue:1,nonedeltaMultiplier:1.2,spellCheck:!1,spellCheckDistance:1,filterZeros:!0,log:!0},!1),this.container.registerPipeline("nlu-??-prepare",["normalize","tokenize","removeStopwords","stem","arrToObj","output.tokens"],!1),this.container.registerPipeline("nlu-??-train",[".prepareCorpus",".addNoneFeature",".innerTrain"],!1),this.container.registerPipeline("nlu-??-process",[".prepare",".doSpellCheck",".textToFeatures",".innerProcess",".convertToArray",".filterNonActivated",".normalizeClassifications","output.classifications"],!1)}async prepare(t,e){const n=e||this.settings;if("string"==typeof t){const e={locale:this.settings.locale,text:t,settings:n};return this.runPipeline(e,this.pipelinePrepare)}if("object"==typeof t){if(Array.isArray(t)){const e=[];for(let r=0;r<t.length;r+=1)e.push(await this.prepare(t[r],n));return e}const e=n.fieldNameSrc?t[n.fieldNameSrc]:t.text||t.utterance||t.texts||t.utterances;if(e){const r=await this.prepare(e,n);return{[n.fieldNameTgt||"tokens"]:r,...t}}}throw new Error(`Error at nlu.prepare: expected a text but received ${t}`)}async doSpellCheck(t,e){const n=this.applySettings(e||{},this.settings);let r=void 0===t.settings.spellCheck?void 0:t.settings.spellCheck,s=void 0===t.settings.spellCheckDistance?void 0:t.settings.spellCheckDistance;if(void 0===r&&(r=void 0===n.spellCheck?void 0:n.spellCheck),void 0===s&&(s=void 0===n.spellCheckDistance?1:n.spellCheckDistance),r){const e=this.spellCheck.check(t.tokens,s);t.tokens=e}return t}async prepareCorpus(t){this.features={},this.intents={},this.intentFeatures={};const e=t,{corpus:n}=e,r=[];for(let t=0;t<n.length;t+=1){const{intent:s}=n[t],i={input:await this.prepare(n[t].utterance,e.settings),output:{[s]:1}},u=Object.keys(i.input);this.intentFeatures[s]||(this.intentFeatures[s]={});for(let t=0;t<u.length;t+=1)this.features[u[t]]=1,this.intentFeatures[s][u[t]]=1;this.intents[s]=1,r.push(i)}const s=Object.keys(this.intentFeatures);for(let t=0;t<s.length;t+=1)this.intentFeatures[s[t]]=Object.keys(this.intentFeatures[s[t]]);return this.spellCheck.setFeatures(this.features),this.numFeatures=Object.keys(this.features).length,this.numIntents=Object.keys(this.intents).length,e.corpus=r,e}addNoneFeature(t){const{corpus:e}=t,n=t.locale||this.settings.locale;return(t.settings&&t.settings.useNoneFeature||(!t.settings||void 0===t.settings.useNoneFeature)&&i[n])&&e.push({input:{nonefeature:1},output:{None:1}}),t}convertToArray(t){const e=t,{classifications:n}=e;if(n){const t=Object.keys(n),r=[];for(let s=0;s<t.length;s+=1){const i=t[s],u=n[i];(u>0||!e.settings.filterZeros)&&r.push({intent:i,score:u})}e.classifications=r.sort((t,e)=>e.score-t.score)}return e}someSimilar(t,e){for(let n=0;n<e.length;n+=1)if(t[e[n]])return!0;return!1}getWhitelist(t){const e={},n=Object.keys(this.intentFeatures);for(let r=0;r<n.length;r+=1)this.someSimilar(t,this.intentFeatures[n[r]])&&(e[n[r]]=1);return e}filterNonActivated(t){if(!this.intentFeatures||!t.classifications)return t;const e=this.getWhitelist(t.tokens);e.None=1;const{classifications:n}=t;for(let t=0;t<n.length;t+=1){const r=n[t];e[r.intent]||(r.score=0)}return t}normalizeClassifications(t){const e=t,{classifications:n}=e;if(n){let t=0;for(let e=0;e<n.length;e+=1)n[e].score**=2,t+=n[e].score;if(t>0)for(let e=0;e<n.length;e+=1)n[e].score/=t}else e.classifications=e.nluAnswer;return e}textToFeatures(t){const e=t.locale||this.settings.locale,n=t,{tokens:r}=n,s=Object.keys(r);let u=0;const o={};for(let t=0;t<s.length;t+=1){const e=s[t];"nonefeature"===e?r[e]=this.nonefeatureValue:this.features&&this.features[e]?o[e]=r[e]:u+=1}let a=void 0===n.settings.nonedeltaValue?this.numIntents/this.numFeatures:this.settings.nonedeltaValue,c=0;for(let t=0;t<u;t+=1)c+=a,a*=this.settings.nonedeltaMultiplier;return(n.settings||n.settings.useNoneFeature||(n.settings||void 0===n.settings.useNoneFeature)&&i[e])&&c&&(o.nonefeature=c),n.tokens=o,n}async innerTrain(){throw new Error("This method should be implemented by child classes")}async train(t,e){const n={corpus:t,settings:this.applySettings(e,this.settings)};return this.runPipeline(n,this.pipelineTrain)}async process(t,e){const n={text:t,settings:this.applySettings(e||{},this.settings)},r=await this.runPipeline(n,this.pipelineProcess);return Array.isArray(r)?{classifications:r,entities:void 0}:(r.intents&&(r.classifications=r.intents,delete r.intents),r)}toJSON(){const t={settings:{...this.settings},features:this.features,intents:this.intents,intentFeatures:this.intentFeatures};return delete t.settings.container,t}fromJSON(t){this.applySettings(this.settings,t.settings),this.features=t.features||{},this.intents=t.intents||{},this.intentFeatures=t.intentFeatures||{},this.spellCheck.setFeatures(this.features),this.numFeatures=Object.keys(this.features).length,this.numIntents=Object.keys(this.intents).length}}},function(t,e,n){const r=n(234),s=n(235),i=n(250);t.exports={leven:r,similarity:s,SpellCheck:i}},function(t,e){const n=[],r=[];t.exports=function(t,e){t.length>e.length&&([t,e]=[e,t]);let s=t.length-1,i=e.length-1;for(;s>0&&t.charCodeAt(s)===e.charCodeAt(i);)s-=1,i-=1;s+=1,i+=1;let u,o,a,c,l=0;for(;l<s&&t.charCodeAt(l)===e.charCodeAt(l);)l+=1;if(s-=l,i-=l,0===s)return i;for(let e=0;e<s;e+=1)r[e]=t.charCodeAt(l+e),n[e]=e+1;let p=0;for(;p<i;){u=e.charCodeAt(l+p),a=p,p+=1,o=p;for(let t=0;t<s;t+=1)c=a+(u!==r[t])|0,a=n[t],n[t]=a>o?c>o?o+1:c:c>a?a+1:c,o=n[t]}return o}},function(t,e,n){const r=n(234);t.exports=function(t,e,n=!1){return n&&(t=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase(),e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()),t===e?0:r(t,e)}},function(t,e,n){const{Clonable:r}=n(5),s="master_domain";t.exports=class extends r{constructor(t={},e){super({settings:{},container:t.container||e},e),this.applySettings(this.settings,t),this.applySettings(this.settings,{locale:"en"}),this.settings.tag||(this.settings.tag=`domain-manager-${this.settings.locale}`),this.registerDefault(),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag)),this.domains={},this.addDomain(s),this.stemDict={},this.intentDict={},this.sentences=[],this.applySettings(this,{pipelineTrain:this.getPipeline(`${this.settings.tag}-train`),pipelineProcess:this.getPipeline(`${this.settings.tag}-process`)})}registerDefault(){this.container.registerConfiguration("domain-manager-??",{nluByDomain:{default:{className:"NeuralNlu",settings:{}}},trainByDomain:!1,useStemDict:!0},!1),this.container.registerPipeline("domain-manager-??-train",[".trainStemmer",".generateCorpus",".fillStemDict",".innerTrain","output.status"],!1),this.container.registerPipeline("domain-manager-??-process",[".innerClassify","output.classification"],!1)}getDomainInstance(t){this.settings.nluByDomain||(this.settings.nluByDomain={});const e=this.settings.nluByDomain[t]||this.settings.nluByDomain.default||{className:"NeuralNlu",settings:{}};return this.container.get(e.className||"NeuralNlu",this.applySettings({locale:this.settings.locale},e.settings||{}))}addDomain(t){return this.domains[t]||(this.domains[t]=this.getDomainInstance(t)),this.domains[t]}removeDomain(t){delete this.domains[t]}async generateStemKey(t){let e;if("string"!=typeof t)e=t;else{const n=await this.prepare({utterance:t});e=await n.stems}return Array.isArray(e)||(e=Object.keys(e)),e.slice().sort().join()}add(t,e,n){n?this.sentences.push({domain:t,utterance:e,intent:n}):this.sentences.push({domain:s,utterance:t,intent:e})}remove(t,e,n){const r=n?t:s,i=n?e:t,u=n||e;for(let t=0;t<this.sentences.length;t+=1){const e=this.sentences[t];if(e.domain===r&&e.utterance===i&&e.intent===u)return this.sentences.splice(t,1),!0}return!1}async trainStemmer(t){const e=t;for(let t=0;t<this.sentences.length;t+=1){const n={...this.sentences[t],...e};await this.runPipeline(n,["stem.addForTraining"])}return await this.runPipeline(e,["stem.train"]),e}innerGenerateCorpus(t){this.intentDict={};const e={};e[s]=[];for(let n=0;n<this.sentences.length;n+=1){const r=this.sentences[n];this.intentDict[r.intent]=r.domain;const i=t||r.domain;e[i]||(e[i]=[]),e[i].push({utterance:r.utterance,intent:r.intent}),t||e[s].push({utterance:r.utterance,intent:r.domain})}return e}async generateCorpus(t){const e=t;return e.corpus=this.innerGenerateCorpus(this.settings.trainByDomain?void 0:s),e}async prepare(t){const e=t,n="string"==typeof e,r=n?e:e.utterance,i=this.addDomain(s).prepare(r);return n?i:(e.stems=i,e)}async fillStemDict(t){this.stemDict={};for(let t=0;t<this.sentences.length;t+=1){const e=await this.generateStemKey(this.sentences[t].utterance);this.stemDict[e]={intent:this.sentences[t].intent,domain:this.sentences[t].domain}}return t}async innerTrain(t){const e=t,{corpus:n}=e,r=Object.keys(n),s={};for(let e=0;e<r.length;e+=1){const i=this.addDomain(r[e]),u={useNoneFeature:this.settings.useNoneFeature};t.settings&&void 0!==t.settings.log&&(u.log=t.settings.log);const o=await i.train(n[r[e]],u);s[r[e]]=o.status}return e.status=s,e}async train(t){const e={domainManager:this,settings:t||this.settings};return this.runPipeline(e,this.pipelineTrain)}async classifyByStemDict(t,e){const n=await this.generateStemKey(t),r=this.stemDict[n];if(r&&(!e||r.domain===e)){const t=[];t.push({intent:r.intent,score:1});const e=Object.keys(this.intentDict);for(let n=0;n<e.length;n+=1)t.push({intent:e[n],score:0});return{domain:r.domain,classifications:t}}}async innerClassify(t,e){const n=t;if(this.applySettings({...n.settings},this.settings).useStemDict){const t=await this.classifyByStemDict(n.utterance,e);if(t)return n.classification=t,n}if(e){const t=this.domains[e];if(!t)return n.classification={domain:"default",classifications:[{intent:"None",score:1}]},n;const r=await t.process(n.utterance,n.settings||this.settings);let i;Array.isArray(r)?i=r:(i=r.classifications,n.nluAnswer=r);const u=e===s?this.intentDict[i[0].intent]:e;return n.classification={domain:u,classifications:i},n}let r=s;if(void 0===n.settings.trainByDomain&&this.settings.trainByDomain||n.settings.trainByDomain){const t=this.domains[s];let e=await t.process(n.utterance);if(e.classifications&&(e=e.classifications),1===Object.keys(this.domains).length)return n.classification={domain:"default",classifications:e},n;if(r=e[0].intent,"None"===r)return n.classification={domain:"default",classifications:[{intent:"None",score:1}]},n}return this.innerClassify(n,r)}async process(t,e){const n="string"==typeof t?{utterance:t,settings:e||this.settings}:t;return this.runPipeline(n,this.pipelineProcess)}toJSON(){const t={settings:this.settings,stemDict:this.stemDict,intentDict:this.intentDict,sentences:this.sentences,domains:{}};delete t.settings.container;const e=Object.keys(this.domains);for(let n=0;n<e.length;n+=1)t.domains[e[n]]=this.domains[e[n]].toJSON();return t}fromJSON(t){this.applySettings(this.settings,t.settings),this.stemDict=t.stemDict,this.intentDict=t.intentDict,this.sentences=t.sentences;const e=Object.keys(t.domains);for(let n=0;n<e.length;n+=1){this.addDomain(e[n]).fromJSON(t.domains[e[n]])}}}},function(t,e,n){const r=n(258);t.exports={Language:r}},function(t,e){const n={Between:"between",After:"after",AfterLast:"afterLast",AfterFirst:"afterFirst",Before:"before",BeforeFirst:"beforeFirst",BeforeLast:"beforeLast"},r=Object.values(n);t.exports={TrimType:n,TrimTypesList:r}},function(t,e,n){const{containerBootstrap:r}=n(5),{Nlp:s}=n(247),i=n(274),u=n(11),o=n(22);t.exports=t=>(u.nlpManager=async function(e,n=[]){const u=await r();u.use(s);for(let t of n)u.use(t);const a=u.get("nlp");if("{"==e[0])a.import(e);else if(o.is()){const t=await fetch(e).then(t=>t.json());a.import(t)}else{const n=t.readFileSync(e,"utf-8");a.import(n)}return i(a)},u)},function(t,e){t.exports=class{constructor(t,e,n,r,s){this.s_size=t.length,this.s=t,this.substring_i=e,this.result=n,this.method=r,this.instance=s}}},function(t,e,n){const{defaultContainer:r}=n(6);t.exports=class{constructor(t=r){this.container=t.container||t,this.name="default"}getTokenFromWord(t){return t.startsWith("//")?{type:"comment",value:t}:["set","delete","get","inc","dec","eq","neq","gt","ge","lt","le","label","goto","jne","je"].includes(t)?{type:t,arguments:[]}:t.startsWith("$")?{type:"call",value:t.slice(1)}:{type:"reference",value:t}}compile(t){const e=[];for(let n=0;n<t.length;n+=1){const r=t[n].split(" "),s=[];let i,u="";for(let t=0;t<r.length;t+=1){const e=r[t];let n=!1;i?(u=`${u} ${e}`,n=!0,e.endsWith(i)&&(i=void 0,s.push(this.getTokenFromWord(u)))):e.startsWith('"')?(u=e,n=!0,i='"',e.endsWith('"')&&(i=void 0,s.push(this.getTokenFromWord(u)))):e.startsWith("'")&&(u=e,n=!0,i="'",e.endsWith("'")&&(i=void 0,s.push(this.getTokenFromWord(u)))),n||s.push(this.getTokenFromWord(e))}e.push(s)}return e}executeCall(t,e,n,r,s){const i=this.container.getPipeline(t.value);if(!i)throw new Error(`Pipeline $${t.value} not found.`);return this.container.runPipeline(i,n,r,s+1)}executeReference(t,e,n,r,s){const i=this.container.resolvePath(e.value,n,r,s),u=[];for(let e=1;e<t.length;e+=1)u.push(this.container.resolvePathWithType(t[e].value,n,r,s));if(!i)throw new Error(`Method not found for step ${JSON.stringify(t)}`);const o=i.run||i;return"function"==typeof o?"function"==typeof i?o(r,...u):o.bind(i)(r,...u):o}doGoto(t,e){const n=e,r=n.labels[t];n.cursor=r}async executeAction(t,e,n,r,s){let i=t[0];if(i&&i.value&&i.value.startsWith("->")){if(s>0)return n;i={...i},i.value=i.value.slice(2)}switch(i.type){case"set":this.container.setValue(t[1].value,t[2]?t[2].value:void 0,e,n,r);break;case"delete":this.container.deleteValue(t[1].value,e,n,r);break;case"get":return this.container.getValue(t[1]?t[1].value:void 0,e,n,r);case"inc":this.container.incValue(t[1]?t[1].value:void 0,t[2]?t[2].value:"1",e,n,r);break;case"dec":this.container.decValue(t[1]?t[1].value:void 0,t[2]?t[2].value:"1",e,n,r);break;case"eq":this.container.eqValue(t[1]?t[1].value:void 0,t[2]?t[2].value:void 0,e,n,r);break;case"neq":this.container.neqValue(t[1]?t[1].value:void 0,t[2]?t[2].value:void 0,e,n,r);break;case"gt":this.container.gtValue(t[1]?t[1].value:void 0,t[2]?t[2].value:void 0,e,n,r);break;case"ge":this.container.geValue(t[1]?t[1].value:void 0,t[2]?t[2].value:void 0,e,n,r);break;case"lt":this.container.ltValue(t[1]?t[1].value:void 0,t[2]?t[2].value:void 0,e,n,r);break;case"le":this.container.leValue(t[1]?t[1].value:void 0,t[2]?t[2].value:void 0,e,n,r);break;case"goto":this.doGoto(t[1].value,e);break;case"jne":e.floating||this.doGoto(t[1].value,e);break;case"je":e.floating&&this.doGoto(t[1].value,e);break;case"call":return this.executeCall(i,e,n,r,s);case"reference":return this.executeReference(t,i,e,n,r)}return n}findLabels(t,e){const n=e;for(let e=0;e<t.length;e+=1){const r=t[e];"label"===r[0].type&&(n[r[1].value]=e)}}async execute(t,e,n,r){let s=e;const i={cursor:0,labels:{}};for(this.findLabels(t,i.labels);i.cursor<t.length;)s=await this.executeAction(t[i.cursor],i,s,n,r),i.cursor+=1;return s}}},function(t,e,n){const{defaultContainer:r}=n(6),s=n(81);t.exports=class{constructor(t=r,e){this.container=t.container||t,this.cache={},this.setCurrent(""),this.dictionary=e||{before:{},after:{}}}setCurrent(t){this.current=t,this.cursor=0,this.limit=this.current.length,this.limit_backward=0,this.bra=this.cursor,this.ket=this.limit}getCurrent(){return this.current}bc(t,e){return 0==(t[e>>>3]&1<<(7&e))}in_grouping(t,e,n){if(this.cursor>=this.limit)return!1;let r=this.current.charCodeAt(this.cursor);return!(r>n||r<e)&&(r-=e,!this.bc(t,r)&&(this.cursor++,!0))}in_grouping_b(t,e,n){if(this.cursor<=this.limit_backward)return!1;let r=this.current.charCodeAt(this.cursor-1);return!(r>n||r<e)&&(r-=e,!this.bc(t,r)&&(this.cursor--,!0))}out_grouping(t,e,n){if(this.cursor>=this.limit)return!1;let r=this.current.charCodeAt(this.cursor);return r>n||r<e?(this.cursor++,!0):(r-=e,!!this.bc(t,r)&&(this.cursor++,!0))}out_grouping_b(t,e,n){if(this.cursor<=this.limit_backward)return!1;let r=this.current.charCodeAt(this.cursor-1);return r>n||r<e?(this.cursor--,!0):(r-=e,!!this.bc(t,r)&&(this.cursor--,!0))}eq_s(t,e){return"string"==typeof t&&(t=(e=t).length),!(this.limit-this.cursor<t||this.current.slice(this.cursor,this.cursor+t)!=e)&&(this.cursor+=t,!0)}eq_s_b(t,e){return"string"==typeof t&&(t=(e=t).length),!(this.cursor-this.limit_backward<t||this.current.slice(this.cursor-t,this.cursor)!=e)&&(this.cursor-=t,!0)}find_among(t,e){let n=0,r=e||t.length;const s=this.cursor,i=this.limit;let u=0,o=0,a=!1;for(;;){const e=n+(r-n>>>1);let p=0,h=u<o?u:o;var c,l=t[e];for(c=h;c<l.s_size;c++){if(s+h==i){p=-1;break}if(p=this.current.charCodeAt(s+h)-l.s.charCodeAt(c),0!=p)break;h++}if(p<0?(r=e,o=h):(n=e,u=h),r-n<=1){if(n>0)break;if(r==n)break;if(a)break;a=!0}}for(;;){if(u>=(l=t[n]).s_size){if(this.cursor=s+l.s_size,null==l.method)return l.result;const t=l.method(l.instance);if(this.cursor=s+l.s_size,t)return l.result}if(n=l.substring_i,n<0)return 0}return-1}find_among_b(t,e){let n=0,r=e||t.length;const s=this.cursor,i=this.limit_backward;let u=0,o=0,a=!1;for(;;){const e=n+(r-n>>1);let p=0,h=u<o?u:o;var c;for(c=(l=t[e]).s_size-1-h;c>=0;c--){if(s-h==i){p=-1;break}if(p=this.current.charCodeAt(s-1-h)-l.s.charCodeAt(c),0!=p)break;h++}if(p<0?(r=e,o=h):(n=e,u=h),r-n<=1){if(n>0)break;if(r==n)break;if(a)break;a=!0}}for(;;){var l;if(u>=(l=t[n]).s_size){if(this.cursor=s-l.s_size,null==l.method)return l.result;const t=l.method(this);if(this.cursor=s-l.s_size,t)return l.result}if(n=l.substring_i,n<0)return 0}return-1}replace_s(t,e,n){const r=n.length-(e-t);return this.current=this.current.slice(0,t)+n+this.current.slice(e),this.limit+=r,this.cursor>=e?this.cursor+=r:this.cursor>t&&(this.cursor=t),r}slice_check(){return!(this.bra<0||this.bra>this.ket||this.ket>this.limit||this.limit>this.current.length)}slice_from(t){return!!this.slice_check()&&(this.replace_s(this.bra,this.ket,t),!0)}slice_del(){return this.slice_from("")}insert(t,e,n){const r=this.replace_s(t,e,n);t<=this.bra&&(this.bra+=r),t<=this.ket&&(this.ket+=r)}slice_to(t){let e="";return this.slice_check()&&(e=this.current.slice(this.bra,this.ket)),e}stemWord(t){let e=this.cache[`.${t}`];return null==e&&(this.dictionary.before[t]?e=this.dictionary.before[t]:(this.setCurrent(t),this.innerStem(),e=this.getCurrent(),this.dictionary.after[e]&&(e=this.dictionary.after[e])),this.cache[`.${t}`]=e),e}stemWords(t){const e=[];for(let n=0;n<t.length;n++)e.push(this.stemWord(t[n]));return e}stem(t){return this.stemWords(t)}getTokenizer(){return this.tokenizer||(this.tokenizer=this.container.get(`tokenizer-${this.name.slice(-2)}`)||new s),this.tokenizer}tokenizeAndStem(t,e=!0){let n=this.getTokenizer().tokenize(t,!0);return!e&&this.stopwords&&(n=this.stopwords.removeStopwords(n)),this.stemWords(n)}}},function(t,e){t.exports={readFile:function(){return new Promise(t=>{t(void 0)})},writeFile:function(){return new Promise((t,e)=>{e(new Error("File cannot be written in web"))})},existsSync:function(){return!1},lstatSync:function(){},readFileSync:function(){}}},function(t,e){t.exports=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return`${t()+t()}-${t()}-${t()}-${t()}-${t()}${t()}${t()}`}},function(t,e,n){const r=n(226);const s=new class{constructor(){this.containers={}}getContainer(t){return this.containers[t||"default"]}async createContainer(t,e,n=!0,s,i,u){if("string"!=typeof t&&(e=t,t=""),e||"default"!==t&&""!==t||(e="conf.json"),!this.containers[t]){const o=r(e,n,void 0,s,u);o.name=t,this.containers[t]=o,o.dock=this,o.parent=i,await o.start(),o.childs&&await this.buildChilds(o)}return this.containers[t]}async buildChilds(t){if(t&&t.childs){const e=Object.keys(t.childs),n={};for(let r=0;r<e.length;r+=1){const s=t.childs[e[r]];s.isChild=!0,s.pathPipeline||(s.pathPipeline=`${e[r]}_pipeline.md`),n[e[r]]=await this.createContainer(e[r],s,!1,e[r],t,t.childPipelines?t.childPipelines[e[r]]:void 0)}t.childs=n}}async terraform(t,e=!0){return await this.createContainer("default",t,e,"")}start(t,e=!0){return this.terraform(t,e)}};t.exports=s},function(t,e,n){const{defaultContainer:r}=n(6),s=n(83);t.exports=class extends s{constructor(t={},e){super({settings:{},container:t.container||e||r},e),this.applySettings(this.settings,t),this.settings.tag||(this.settings.tag="context"),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag))}getStorage(){const t=this.container.get(this.settings.storageName||"storage");if(!t)throw new Error("Storage not found");return t}getContext(t){return this.getStorage().read(`${this.settings.tag}-${t}`)}setContext(t,e){const n={[t]:e};return this.getStorage().write(n)}async getContextValue(t,e){const n=await this.getContext(t);return n?n[e]:void 0}async setContextValue(t,e,n){let r=await this.getContext(t);return r||(r={}),r[e]=n,this.setContext(t,r)}}},function(t,e,n){const r=n(248);t.exports={Nlp:r}},function(t,e,n){const{Clonable:r,containerBootstrap:s}=n(5),{NluManager:i,NluNeural:u}=n(249),{Ner:o,ExtractorEnum:a,ExtractorRegex:c,ExtractorTrim:l,ExtractorBuiltin:p}=n(261),{ActionManager:h,NlgManager:f}=n(267),{SentimentAnalyzer:g}=n(270),{SlotManager:d}=n(272);t.exports=class extends r{constructor(t={},e){super({settings:{},container:t.container||e||s()},e),this.applySettings(this.settings,t),this.settings.tag||(this.settings.tag="nlp"),this.registerDefault(),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag)),this.nluManager=this.container.get("nlu-manager",this.settings.nlu),this.ner=this.container.get("ner",this.settings.ner),this.nlgManager=this.container.get("nlg-manager",this.settings.nlg),this.actionManager=this.container.get("action-manager",this.settings.action),this.sentiment=this.container.get("sentiment-analyzer",this.settings.sentiment),this.slotManager=this.container.get("SlotManager",this.settings.slot),this.initialize()}registerDefault(){this.container.registerConfiguration("nlp",{threshold:.5,autoLoad:!0,autoSave:!0,modelFileName:"model.nlp"},!1),this.use(i),this.use(o),this.use(a),this.use(c),this.use(l),this.use(p),this.use(f),this.use(h),this.use(u),this.use(g),this.container.register("SlotManager",d,!1)}initialize(){if(this.settings.nlu){const t=Object.keys(this.settings.nlu);for(let e=0;e<t.length;e+=1){const n=t[e],r=Object.keys(this.settings.nlu[n]);for(let t=0;t<r.length;t+=1){const e=r[t],s=this.settings.nlu[n][e],{className:i}=s;delete s.className,this.useNlu(i,n,e,s)}}}this.settings.languages&&this.addLanguage(this.settings.languages),this.settings.locales&&this.addLanguage(this.settings.locales)}async start(){this.settings.corpora&&await this.addCorpora(this.settings.corpora)}async loadOrTrain(){let t=!1;this.settings.autoLoad&&(t=await this.load(this.settings.modelFileName)),t||await this.train()}useNlu(t,e,n,r){if(e||(e="??"),Array.isArray(e))for(let s=0;s<e.length;s+=1)this.useNlu(t,e[s],n,r);else{const s="string"==typeof t?t:this.container.use(t);let i=this.container.getConfiguration(`domain-manager-${e}`);i||(i={},this.container.registerConfiguration(`domain-manager-${e}`,i)),i.nluByDomain||(i.nluByDomain={});const u=n&&"*"!==n?n:"default";i.nluByDomain[u]||(i.nluByDomain[u]={}),i.nluByDomain[u].className=s,i.nluByDomain[u].settings=r}}guessLanguage(t){return this.nluManager.guessLanguage(t)}addLanguage(t){return this.nluManager.addLanguage(t)}addDocument(t,e,n){const r=this.ner.getEntitiesFromUtterance(e);return this.slotManager.addBatch(n,r),this.nluManager.add(t,e,n)}removeDocument(t,e,n){return this.nluManager.remove(t,e,n)}getRulesByName(t,e){return this.ner.getRulesByName(t,e)}addNerRule(t,e,n,r){return this.ner.addRule(t,e,n,r)}removeNerRule(t,e,n){return this.ner.removeRule(t,e,n)}addNerRuleOptionTexts(t,e,n,r){return this.ner.addRuleOptionTexts(t,e,n,r)}removeNerRuleOptionTexts(t,e,n,r){return this.ner.removeRuleOptionTexts(t,e,n,r)}addNerRegexRule(t,e,n){return this.ner.addRegexRule(t,e,n)}addNerBetweenCondition(t,e,n,r,s){return this.ner.addBetweenCondition(t,e,n,r,s)}addNerPositionCondition(t,e,n,r,s){return this.ner.addPositionCondition(t,e,n,r,s)}addNerAfterCondition(t,e,n,r){return this.ner.addAfterCondition(t,e,n,r)}addNerAfterFirstCondition(t,e,n,r){return this.ner.addAfterFirstCondition(t,e,n,r)}addNerAfterLastCondition(t,e,n,r){return this.ner.addAfterLastCondition(t,e,n,r)}addNerBeforeCondition(t,e,n,r){return this.ner.addBeforeCondition(t,e,n,r)}addNerBeforeFirstCondition(t,e,n,r){return this.ner.addBeforeFirstCondition(t,e,n,r)}addNerBeforeLastCondition(t,e,n,r){return this.ner.addBeforeLastCondition(t,e,n,r)}assignDomain(t,e,n){return this.nluManager.assignDomain(t,e,n)}getIntentDomain(t,e){return this.nluManager.getIntentDomain(t,e)}getDomains(){return this.nluManager.getDomains()}addAction(t,e,n,r){return this.actionManager.addAction(t,e,n,r)}getActions(t){return this.actionManager.findActions(t)}removeAction(t,e,n){return this.actionManager.removeAction(t,e,n)}removeActions(t){return this.actionManager.removeActions(t)}addAnswer(t,e,n,r){return this.nlgManager.add(t,e,n,r)}removeAnswer(t,e,n,r){return this.nlgManager.remove(t,e,n,r)}findAllAnswers(t,e){return this.nlgManager.findAllAnswers({locale:t,intent:e}).answers}async addCorpora(t){for(let e=0;e<t.length;e+=1)await this.addCorpus(t[e])}async addCorpus(t){let e=t;if("string"==typeof t){const n=this.container.get("fs"),r=await n.readFile(t);if(!r)throw new Error(`Corpus not found "${t}"`);e="string"==typeof r?JSON.parse(r):r}const n=e.locale.slice(0,2);this.addLanguage(n);const{data:r,entities:s}=e;if(s){const t=Object.keys(s);for(let e=0;e<t.length;e+=1){const r=t[e],i=s[r];if(i.type||(i.type="text"),"text"===i.type){const t=i.options||{},e=Object.keys(t);for(let s=0;s<e.length;s+=1)this.addNerRuleOptionTexts(n,r,e[s],t[e[s]])}}}for(let t=0;t<r.length;t+=1){const e=r[t],{intent:s,utterances:i,answers:u}=e;for(let t=0;t<i.length;t+=1)this.addDocument(n,i[t],s);if(u)for(let t=0;t<u.length;t+=1){const e=u[t];"string"==typeof e?this.addAnswer(n,s,u[t]):this.addAnswer(n,s,e.answer,e.opts)}}}getSentiment(t,e){return"object"==typeof t?this.sentiment.process(t):(e||(e=t,t=this.guessLanguage(e)),this.sentiment.process({utterance:e,locale:t}))}describeLanguage(t,e){this.nluManager.describeLanguage(t,e)}async train(){this.nluManager.addLanguage(this.settings.languages);const t=await this.nluManager.train();return this.settings.autoSave&&await this.save(this.settings.modelFileName,!0),t}async classify(t,e,n){return this.nluManager.process(t,e,n||this.settings.nlu)}async extractEntities(t,e,n,r){if("object"==typeof t)return this.ner.process(t);return e||(e=t,t=void 0),t||(t=this.guessLanguage(e)),await this.ner.process({locale:t,utterance:e,context:n,settings:this.applySettings(r,this.settings.ner)})}async process(t,e,n={},r){let s;"object"==typeof t&&("object"==typeof e&&e.value?(t=void 0,e=e.value):s=t),s&&(t=s.locale,e=s.utterance||s.message,n.channel=s.channel,n.app=s.app),e||(e=t,t=void 0),t||(t=this.guessLanguage(e));const i={locale:t,utterance:e,context:n,settings:this.applySettings(r,this.settings.nlu)};let u=await this.nluManager.process(i);const o=await this.ner.generateEntityUtterance(t,e);if(o&&o!==e){const s={locale:t,utterance:o,context:n,settings:this.applySettings(r,this.settings.nlu)},i=await this.nluManager.process(s);i&&(i.score>u.score||"None"===u.intent)&&(u=i,u.utterance=e,u.optionalUtterance=o)}u.score<this.settings.threshold&&(u.score=1,u.intent="None"),u.context=n,u=await this.ner.process({...u});const a=await this.nlgManager.run({...u});u.answers=a.answers,u.answer=a.answer,u=await this.actionManager.run({...u});const c=await this.getSentiment(t,e);u.sentiment=c?c.sentiment:void 0,this.slotManager.process(u,n)&&u.entities.forEach(t=>{n[t.entity]=t.option||t.utteranceText}),n.slotFill=u.slotFill,delete u.context,delete u.settings;const l=s?this.applySettings(s,u):u;if(this.onIntent)await this.onIntent(this,l);else{const t=`onIntent(${l.intent})`,e=this.container.getPipeline(t);e&&await this.container.runPipeline(e,l,this)}return l}toJSON(){const t={settings:{...this.settings},nluManager:this.nluManager.toJSON(),ner:this.ner.toJSON(),nlgManager:this.nlgManager.toJSON(),actionManager:this.actionManager.toJSON(),slotManager:this.slotManager.save()};return delete t.settings.container,t}fromJSON(t){this.applySettings(this.settings,t.settings),this.nluManager.fromJSON(t.nluManager),this.ner.fromJSON(t.ner),this.nlgManager.fromJSON(t.nlgManager),this.actionManager.fromJSON(t.actionManager),this.slotManager.load(t.slotManager)}export(t=!1){const e=this.toJSON();return t?JSON.stringify(e):JSON.stringify(e,null,2)}import(t){const e="string"==typeof t?JSON.parse(t):t;this.fromJSON(e)}async save(t,e=!1){const n=this.container.get("fs"),r=t||"model.nlp";await n.writeFile(r,this.export(e))}async load(t){const e=this.container.get("fs"),n=t||"model.nlp",r=await e.readFile(n);return!!r&&(this.import(r),!0)}}},function(t,e,n){const r=n(232),s=n(252),i=n(236),u=n(257);t.exports={Nlu:r,NluNeural:s,DomainManager:i,NluManager:u}},function(t,e,n){const r=n(235);t.exports=class{constructor(t){this.settings=t||{},this.minLength=this.settings.minLength||4,this.settings.features?this.setFeatures(this.settings.features):(this.features={},this.featuresByLength={})}setFeatures(t){this.features=t,this.featuresByLength={},this.featuresList=Object.keys(this.features);for(let t=0;t<this.featuresList.length;t+=1){const e=this.featuresList[t],{length:n}=e;this.featuresByLength[n]||(this.featuresByLength[n]=[]),this.featuresByLength[n].push(e)}}checkToken(t,e){if(this.features[t])return t;if(t.length<this.minLength)return t;let n,s=1/0;for(let i=t.length-e-1;i<t.length+e;i+=1){const u=this.featuresByLength[i+1];if(u)for(let i=0;i<u.length;i+=1){const o=u[i],a=r(t,o);a<=e&&(a<s?(n=o,s=a):a===s&&Math.abs(n.length-t.length)>Math.abs(o.length-t.length)&&(n=o,s=a))}}return n||t}check(t,e){if(!Array.isArray(t)){const n=Object.keys(t),r=this.check(n,e),s={};for(let e=0;e<r.length;e+=1)s[r[e]]=t[n[e]];return s}const n=[];for(let r=0;r<t.length;r+=1)n.push(this.checkToken(t[r],e));return n}}},function(t,e){t.exports={bn:!1,el:!0,en:!0,hi:!1,fa:!1,fr:!0,ru:!0,es:!0,gl:!0,it:!0,nl:!0,no:!0,pt:!0,pl:!0,sv:!0,tl:!0,id:!0,ja:!1,ar:!1,hy:!1,eu:!0,ca:!0,cs:!0,da:!0,fi:!0,de:!0,hu:!0,ga:!0,ro:!0,sl:!0,ta:!1,th:!1,tr:!0,zh:!1}},function(t,e,n){const{NeuralNetwork:r}=n(253),s=n(232);class i extends s{innerTrain(t){const e=t;return this.neuralNetwork=new r(e.settings,this.container),e.status=this.neuralNetwork.train(e.corpus),e}innerProcess(t){const e=t;return this.neuralNetwork?e.classifications=this.neuralNetwork.run(e.tokens):e.classifications={None:1},e}registerDefault(){super.registerDefault(),this.container.register("NeuralNlu",i,!1)}toJSON(){const t=super.toJSON();return t.neuralNetwork=this.neuralNetwork.toJSON(),t}fromJSON(t){super.fromJSON(t),this.neuralNetwork=new r,this.neuralNetwork.fromJSON(t.neuralNetwork)}}t.exports=i},function(t,e,n){const r=n(254);t.exports={NeuralNetwork:r}},function(t,e,n){const{Clonable:r}=n(5),{LookupTable:s,lookupToArray:i,lookupToObject:u,toHash:o,getTypedArrayFn:a}=n(255),c=n(256);t.exports=class extends r{constructor(t={},e){super({},e),this.perceptronSettings={},this.applySettings(this.perceptronSettings,t),this.applySettings(this.perceptronSettings,c),!0===this.perceptronSettings.log?this.logFn=(t,e)=>this.logger.info(`Epoch ${t.iterations} loss ${t.error} time ${e}ms`):"function"==typeof this.perceptronSettings.log&&(this.logFn=this.perceptronSettings.log),this.jsonExport={perceptrons:this.exportPerceptrons},this.jsonImport={perceptrons:this.importPerceptrons}}initialize(){const t=this.sizes[1];this.inputs=[],this.outputs=[],this.perceptrons=[];for(let e=0;e<t;e+=1)this.perceptrons.push({weights:new Float32Array(this.sizes[0]),changes:new Float32Array(this.sizes[0]),bias:0})}get isRunnable(){return!!this.sizes}run(t){if(this.isRunnable){const e=i(this.inputLookup,t);return u(this.outputLookup,this.runInput(e).slice(0))}}runInput(t){this.inputs=t;const{alpha:e}=this.perceptronSettings,n=Object.keys(t);for(let r=0;r<this.sizes[1];r+=1){const s=this.perceptrons[r],{weights:i,bias:u}=s;let o=u;for(let e=0;e<n.length;e+=1){const r=n[e];i[r]&&(1===t[r]?o+=i[r]:o+=t[r]*i[r])}this.outputs[r]=o<0?0:e*o}return this.outputs}verifyIsInitialized(t){this.sizes||(this.sizes=[t[0].input.length,t[0].output.length],this.initialize())}train(t){if(!t||!t.length)return{};if(void 0!==t[t.length-1].input.nonefeature){const e={};for(let n=0;n<t.length-1;n+=1){const r=Object.keys(t[n].output);for(let t=0;t<r.length;t+=1)e[r[t]]||(e[r[t]]=1)}const n=t[t.length-1],r=Object.keys(e);for(let t=0;t<r.length;t+=1)n.output[r[t]]=1e-7}const e=this.formatData(t),n=[];for(let t=0;t<e.length;t+=1){const r=e[t].input,s={};for(let t=0;t<r.length;t+=1)r[t]&&(s[t]=r[t]);n.push(s)}let r,s;for(this.status||(this.status={error:1/0,deltaError:1/0,iterations:0}),this.verifyIsInitialized(e),this.perceptronSettings.fixedError?(r=this.perceptronSettings.errorThresh,s=this.perceptronSettings.deltaErrorThresh):(r=this.sizes[1]>50?50*this.perceptronSettings.errorThresh/this.sizes[1]:this.perceptronSettings.errorThresh,s=this.sizes[1]>50?50*this.perceptronSettings.deltaErrorThresh/this.sizes[1]:this.perceptronSettings.deltaErrorThresh);this.status.iterations<this.perceptronSettings.iterations&&this.status.error>r&&this.status.deltaError>s;){const t=new Date;this.status.iterations+=1;const r=this.status.error;this.status.error=0;for(let t=0;t<e.length;t+=1){const r=e[t];this.status.error+=this.calculateDeltas(r.input,r.output,this.runInput(n[t]))}this.status.error/=e.length,this.status.deltaError=Math.abs(this.status.error-r);const s=new Date;this.logFn&&this.logFn(this.status,s.getTime()-t.getTime())}return this.status}calculateDeltas(t,e,n,r){const{learningRate:s,alpha:i,momentum:u}=this.perceptronSettings,o=this.sizes[1];let a=0;const c=s/(1+.001*this.status.iterations),l=void 0===r?o:r+1;for(let s=void 0===r?0:r;s<l;s+=1){const r=this.perceptrons[s],{changes:o,weights:l}=r,p=n[s],h=e[s]-p;if(h){a+=h**2;const e=(p>0?1:i)*h*c;for(let n=0;n<t.length;n+=1){const r=e*t[n]+u*o[n];o[n]=r,l[n]+=r}r.bias+=e}else for(let e;e<t.length;e+=1){const t=u*o[e];o[e]=t,l[e]+=t}}return a/o}formatData(t){this.inputLookup||(this.inputLookup=new s(t,"input").table,this.outputLookup=new s(t,"output").table);const e=a(this.inputLookup),n=a(this.outputLookup),r=[];for(let s=0;s<t.length;s+=1)r.push({input:e(t[s].input),output:n(t[s].output)});return r}adjust(t){return this.perceptronSettings.maxDecimals&&this.perceptronSettings.maxDecimals<17?parseFloat(t.toFixed(this.perceptronSettings.maxDecimals)):t}toJSON(){const t={},e=Object.keys(this.perceptronSettings);for(let n=0;n<e.length;n+=1){const r=e[n];this.perceptronSettings[r]!==c[r]&&(t[r]=this.perceptronSettings[r])}if(!this.inputLookup)return{perceptronSettings:t};const n=Object.keys(this.inputLookup),r=Object.keys(this.outputLookup),s=[];for(let t=0;t<r.length;t+=1){const e=this.perceptrons[t],n=[...e.weights,e.bias];s.push(n)}return{features:n,intents:r,perceptrons:s,perceptronSettings:t}}fromJSON(t){if(this.perceptronSettings=this.applySettings({...c,...t.perceptronSettings}),t.features){this.sizes=[t.features.length,t.intents.length];const e={};for(let n=0;n<t.features.length;n+=1)e[t.features[n]]={};this.inputLookup=o(e);const n={};for(let e=0;e<t.intents.length;e+=1){n[t.intents[e]]={}}this.outputLookup=o(n),this.initialize();for(let e=0;e<t.intents.length;e+=1){const n=this.perceptrons[e],r=t.perceptrons[e];n.bias=r[r.length-1];for(let e=0;e<t.features.length;e+=1)n.weights[e]=r[e]}}}}},function(t,e){t.exports={LookupTable:class{constructor(t,e){this.length=0,this.prop=e,this.table={},this.build(t)}buildDatum(t){Object.keys(t[this.prop]).forEach(t=>{void 0===this.table[t]&&(this.table[t]=this.length,this.length+=1)})}build(t){t.forEach(t=>this.buildDatum(t))}},toArray:t=>Object.keys(t).map(e=>t[e]),toHash:function(t){const e={};let n=0;const r=Object.keys(t);for(let t=0;t<r.length;t+=1)e[r[t]]=n,n+=1;return e},lookupToArray:function(t,e){const n={},r=Object.keys(t);for(let s=0;s<r.length;s+=1){const i=r[s];e[i]&&(n[t[i]]=e[i])}return n},lookupToObject:function(t,e){const n={},r=Object.keys(t);for(let s=0;s<r.length;s+=1)n[r[s]]=e[t[r[s]]];return n},getTypedArrayFn:function(t){const{length:e}=Object.keys(t);return n=>{const r=new Float32Array(e);return Object.keys(n).forEach(e=>{const s=t[e];void 0!==s&&(r[s]=n[e]||0)}),r}}}},function(t){t.exports={iterations:2e4,errorThresh:5e-5,fixedError:!1,deltaErrorThresh:1e-6,learningRate:.7,momentum:.5,alpha:.08,log:!1}},function(t,e,n){const{Clonable:r}=n(5),{Language:s}=n(237),i=n(236);t.exports=class extends r{constructor(t={},e){super({settings:{},container:t.container||e},e),this.applySettings(this.settings,t),this.settings.tag||(this.settings.tag="nlu-manager"),this.registerDefault(),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag)),this.container.get("Language")||this.container.register("Language",s,!1),this.guesser=this.container.get("Language"),this.locales=[],this.languageNames={},this.domainManagers={},this.intentDomains={},this.settings.locales&&this.addLanguage(this.settings.locales),this.applySettings(this,{pipelineTrain:this.getPipeline(`${this.settings.tag}-train`),pipelineProcess:this.getPipeline(`${this.settings.tag}-process`)})}registerDefault(){this.container.registerConfiguration("nlu-manager",{},!1),this.container.registerPipeline("nlu-manager-train",[".innerTrain"],!1),this.container.registerPipeline("nlu-manager-process",[".fillLanguage",".innerClassify",".checkIfIsNone","delete output.settings","delete output.classification"],!1)}describeLanguage(t,e){this.languageNames[t]={locale:t,name:e}}addLanguage(t){if(t){const e=Array.isArray(t)?t:[t];for(let t=0;t<e.length;t+=1){const n=e[t].substr(0,2).toLowerCase();this.locales.includes(n)||this.locales.push(n),this.domainManagers[n]||(this.domainManagers[n]=new i({locale:n,...this.settings.domain,useNoneFeature:this.settings.useNoneFeature},this.container))}}}guessLanguage(t){const e=t,n="string"==typeof e;if(1===this.locales.length)return n?this.locales[0]:([e.locale]=this.locales,e);if(!e)return n?void 0:e;if(!n&&e.locale)return e;const r=n?e:e.utterance;if(1===this.locales.length){if(n)return this.locales[0];[e.locale]=this.locales}const s=this.guesser.guess(r,this.locales,1),i=s&&s.length>0?s[0].alpha2:void 0;return n?i:(e.locale=i,e)}assignDomain(t,e,n){const r=n?t.substr(0,2).toLowerCase():void 0,s=n?e:t,i=n||e;if(r)this.intentDomains[r]||(this.intentDomains[r]={}),this.intentDomains[r][s]=i;else for(let t=0;t<this.locales.length;t+=1)this.assignDomain(this.locales[t],s,i)}getIntentDomain(t,e){const n=t.substr(0,2).toLowerCase();return this.intentDomains[n]&&this.intentDomains[n][e]||"default"}getDomains(){const t={},e=Object.keys(this.intentDomains);for(let n=0;n<e.length;n+=1){const r=e[n];t[r]={};const s=Object.keys(this.intentDomains[r]);for(let e=0;e<s.length;e+=1){const n=s[e],i=this.intentDomains[r][n];t[r][i]||(t[r][i]=[]),t[r][i].push(n)}}return t}consolidateLocale(t,e){const n=t?t.substr(0,2).toLowerCase():this.guessLanguage(e);if(!n)throw new Error("Locale must be defined");return n}consolidateManager(t){const e=this.domainManagers[t];if(!e)throw new Error(`Domain Manager not found for locale ${t}`);return e}add(t,e,n){const r=this.consolidateLocale(t,e),s=this.consolidateManager(r),i=this.getIntentDomain(r,n);this.guesser.addExtraSentence(r,e),s.add(i,e,n)}remove(t,e,n){const r=this.consolidateLocale(t,e),s=this.consolidateManager(r),i=this.getIntentDomain(r,n);s.remove(i,e,n)}async innerTrain(t){let e=t.locales||this.locales;Array.isArray(e)||(e=[e]);const n=e.filter(t=>this.domainManagers[t]).map(e=>this.domainManagers[e].train(t.settings));return Promise.all(n)}async train(t){const e={nluManager:this,settings:this.applySettings(t,this.settings)};return delete e.settings.tag,this.runPipeline(e,this.pipelineTrain)}fillLanguage(t){const e=t;return e.languageGuessed=!1,e.locale||(e.locale=this.guessLanguage(e.utterance),e.languageGuessed=!0),e.locale&&(e.localeIso2=e.locale.substr(0,2).toLowerCase(),e.language=(this.languageNames[e.localeIso2]||this.guesser.languagesAlpha2[e.localeIso2]||{}).name),e}classificationsIsNone(t){return 1!==t.length&&(0===t.length||0===t[0].score||t[0].score===t[1].score)}checkIfIsNone(t){const e=t;return this.classificationsIsNone(e.classifications)&&(e.intent="None",e.score=1),e}async innerClassify(t){const e=t,n=this.domainManagers[e.localeIso2];if(!n)return e.classifications=[],e.domain=void 0,e.intent=void 0,e.score=void 0,e;const r=await n.process(t);return e.classifications=r.classifications.sort((t,e)=>e.score-t.score),0===e.classifications.length&&e.classifications.push({intent:"None",score:1}),e.intent=e.classifications[0].intent,e.score=e.classifications[0].score,"None"===e.intent?r.domain="default":"default"===r.domain?e.domain=this.getIntentDomain(e.locale,e.intent):e.domain=r.domain,e}process(t,e,n,r){const s="object"==typeof t?t:{locale:void 0===e?void 0:t,utterance:void 0===e?t:e,domain:n,settings:r||this.settings};return this.runPipeline(s,this.pipelineProcess)}toJSON(){const t={settings:this.settings,locales:this.locales,languageNames:this.languageNames,domainManagers:{},intentDomains:this.intentDomains,extraSentences:this.guesser.extraSentences.slice(0)};delete t.settings.container;const e=Object.keys(this.domainManagers);for(let n=0;n<e.length;n+=1){const r=e[n];t.domainManagers[r]=this.domainManagers[r].toJSON()}return t}fromJSON(t){this.applySettings(this.settings,t.settings);for(let e=0;e<t.locales.length;e+=1)this.addLanguage(t.locales[e]);this.languageNames=t.languageNames,this.intentDomains=t.intentDomains;const e=Object.keys(t.domainManagers);for(let n=0;n<e.length;n+=1){const r=e[n];this.domainManagers[r].fromJSON(t.domainManagers[r])}for(let e=0;e<t.extraSentences.length;e+=1){const n=t.extraSentences[e];this.guesser.addExtraSentence(n[0],n[1])}}}},function(t,e,n){const r=n(259),s=n(260),i={cmn:/[\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u3005\u3007\u3021-\u3029\u3038-\u303B\u3400-\u4DB5\u4E00-\u9FCC\uF900-\uFA6D\uFA70-\uFAD9]|[\uD840-\uD868\uD86A-\uD86C][\uDC00-\uDFFF]|\uD869[\uDC00-\uDED6\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D]|\uD87E[\uDC00-\uDE1D]/g,Latin:/[A-Za-z\xAA\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02B8\u02E0-\u02E4\u1D00-\u1D25\u1D2C-\u1D5C\u1D62-\u1D65\u1D6B-\u1D77\u1D79-\u1DBE\u1E00-\u1EFF\u2071\u207F\u2090-\u209C\u212A\u212B\u2132\u214E\u2160-\u2188\u2C60-\u2C7F\uA722-\uA787\uA78B-\uA78E\uA790-\uA7AD\uA7B0\uA7B1\uA7F7-\uA7FF\uAB30-\uAB5A\uAB5C-\uAB5F\uAB64\uFB00-\uFB06\uFF21-\uFF3A\uFF41-\uFF5A]/g,Cyrillic:/[\u0400-\u0484\u0487-\u052F\u1D2B\u1D78\u2DE0-\u2DFF\uA640-\uA69D\uA69F]/g,Arabic:/[\u0600-\u0604\u0606-\u060B\u060D-\u061A\u061E\u0620-\u063F\u0641-\u064A\u0656-\u065F\u066A-\u066F\u0671-\u06DC\u06DE-\u06FF\u0750-\u077F\u08A0-\u08B2\u08E4-\u08FF\uFB50-\uFBC1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFD\uFE70-\uFE74\uFE76-\uFEFC]|\uD803[\uDE60-\uDE7E]|\uD83B[\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB\uDEF0\uDEF1]/g,ben:/[\u0980-\u0983\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BC-\u09C4\u09C7\u09C8\u09CB-\u09CE\u09D7\u09DC\u09DD\u09DF-\u09E3\u09E6-\u09FB]/g,Devanagari:/[\u0900-\u0950\u0953-\u0963\u0966-\u097F\uA8E0-\uA8FB]/g,jpn:/[\u3041-\u3096\u309D-\u309F]|\uD82C\uDC01|\uD83C\uDE00|[\u30A1-\u30FA\u30FD-\u30FF\u31F0-\u31FF\u32D0-\u32FE\u3300-\u3357\uFF66-\uFF6F\uFF71-\uFF9D]|\uD82C\uDC00/g,kor:/[\u1100-\u11FF\u302E\u302F\u3131-\u318E\u3200-\u321E\u3260-\u327E\uA960-\uA97C\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/g,tel:/[\u0C00-\u0C03\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C58\u0C59\u0C60-\u0C63\u0C66-\u0C6F\u0C78-\u0C7F]/g,tam:/[\u0B82\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD0\u0BD7\u0BE6-\u0BFA]/g,guj:/[\u0A81-\u0A83\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABC-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AD0\u0AE0-\u0AE3\u0AE6-\u0AF1]/g,kan:/[\u0C81-\u0C83\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBC-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CDE\u0CE0-\u0CE3\u0CE6-\u0CEF\u0CF1\u0CF2]/g,mal:/[\u0D01-\u0D03\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D-\u0D44\u0D46-\u0D48\u0D4A-\u0D4E\u0D57\u0D60-\u0D63\u0D66-\u0D75\u0D79-\u0D7F]/g,Myanmar:/[\u1000-\u109F\uA9E0-\uA9FE\uAA60-\uAA7F]/g,ori:/[\u0B01-\u0B03\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3C-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B5C\u0B5D\u0B5F-\u0B63\u0B66-\u0B77]/g,pan:/[\u0A01-\u0A03\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A59-\u0A5C\u0A5E\u0A66-\u0A75]/g,Ethiopic:/[\u1200-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u135D-\u137C\u1380-\u1399\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E]/g,tha:/[\u0E01-\u0E3A\u0E40-\u0E5B]/g,sin:/[\u0D82\u0D83\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2-\u0DF4]|\uD804[\uDDE1-\uDDF4]/g,ell:/[\u0370-\u0373\u0375-\u0377\u037A-\u037D\u037F\u0384\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03E1\u03F0-\u03FF\u1D26-\u1D2A\u1D5D-\u1D61\u1D66-\u1D6A\u1DBF\u1F00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FC4\u1FC6-\u1FD3\u1FD6-\u1FDB\u1FDD-\u1FEF\u1FF2-\u1FF4\u1FF6-\u1FFE\u2126\uAB65]|\uD800[\uDD40-\uDD8C\uDDA0]|\uD834[\uDE00-\uDE45]/g,khm:/[\u1780-\u17DD\u17E0-\u17E9\u17F0-\u17F9\u19E0-\u19FF]/g,hye:/[\u0531-\u0556\u0559-\u055F\u0561-\u0587\u058A\u058D-\u058F\uFB13-\uFB17]/g,sat:/[\u1C50-\u1C7F]/g,bod:/[\u0F00-\u0F47\u0F49-\u0F6C\u0F71-\u0F97\u0F99-\u0FBC\u0FBE-\u0FCC\u0FCE-\u0FD4\u0FD9\u0FDA]/g,Hebrew:/[\u0591-\u05C7\u05D0-\u05EA\u05F0-\u05F4\uFB1D-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFB4F]/g,kat:/[\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u10FF\u2D00-\u2D25\u2D27\u2D2D]/g,lao:/[\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB9\u0EBB-\u0EBD\u0EC0-\u0EC4\u0EC6\u0EC8-\u0ECD\u0ED0-\u0ED9\u0EDC-\u0EDF]/g,zgh:/[\u2D30-\u2D67\u2D6F\u2D70\u2D7F]/g,iii:/[\uA000-\uA48C\uA490-\uA4C6]/g,aii:/[\u0700-\u070D\u070F-\u074A\u074D-\u074F]/g},u=()=>[["und",1]];class o{constructor(){this.languagesAlpha3={},this.languagesAlpha2={},this.extraSentences=[],this.buildData()}static getTrigrams(t){const e=[],n=t?` ${String(t).replace(/[\u0021-\u0040]+/g," ").replace(/\s+/g," ").trim().toLowerCase()} `:"";if(!n||n.length<3)return e;for(let t=0,r=n.length-2;t<r;t+=1)e[t]=n.substr(t,3);return e}static asTuples(t){const e=o.getTrigrams(t).reduce((t,e)=>{const n=t;return n[e]=(n[e]||0)+1,n},{}),n=[];return Object.keys(e).forEach(t=>{n.push([t,e[t]])}),n.sort((t,e)=>t[1]-e[1]),n}static getDistance(t,e){let n=0;return t.forEach(t=>{n+=t[0]in e?Math.abs(t[1]-e[t[0]]-1):300}),n}static getOccurrence(t,e){const n=t.match(e);return(n?n.length:0)/t.length||0}static getTopScript(t){let e,n=-1;return Object.keys(i).forEach(r=>{const s=o.getOccurrence(t,i[r]);s>n&&(n=s,e=r)}),[e,n]}static filterLanguages(t,e,n){if(0===e.length&&0===n.length)return t;const r={};return Object.keys(t).forEach(s=>{(0===e.length||e.indexOf(s)>-1)&&-1===n.indexOf(s)&&(r[s]=t[s])}),r}static getDistances(t,e,n){const r=[],s=n.whitelist||[],i=n.blacklist||[],a=o.filterLanguages(e,s,i);return a?(Object.keys(a).forEach(e=>{r.push([e,o.getDistance(t,a[e])])}),r.sort((t,e)=>t[1]-e[1])):u()}static detectAll(t,e={}){const n=e.minLength||10;if(!t||t.length<n)return u();const r=t.substr(0,2048),i=o.getTopScript(r);if(!(i[0]in s)&&i[1]>.5){if(!e.whitelist)return[[i[0],1]];if(e.whitelist.includes(i[0]))return[[i[0],1]];if("cmn"===i[0]&&e.whitelist.includes("jpn"))return[["jpn",1]]}if(s[i[0]]){const t=o.getDistances(o.asTuples(r),s[i[0]],e);if("und"===t[0][0])return[[i[0],1]];const n=t[0][1],u=300*r.length-n;return t.map(t=>[t[0],1-(t[1]-n)/u||0])}return[[i[0],1]]}buildData(){for(let t=0;t<r.length;t+=1){const e={alpha2:r[t][0],alpha3:r[t][1],name:r[t][2]};this.languagesAlpha3[e.alpha3]=e,this.languagesAlpha2[e.alpha2]=e}}transformWhitelist(t){const e=[];for(let n=0;n<t.length;n+=1)if(3===t[n].length)e.push(t[n]);else{const r=this.languagesAlpha2[t[n]];r&&e.push(r.alpha3)}return e}guess(t,e,n){const r={};t.length<10&&(r.minLength=t.length),e&&e.length&&e.length>0&&(r.whitelist=this.transformWhitelist(e));const s=o.detectAll(t,r),i=[];for(let t=0;t<s.length;t+=1){const e=this.languagesAlpha3[s[t][0]];if(e&&(i.push({alpha3:e.alpha3,alpha2:e.alpha2,language:e.name,score:s[t][1]}),n&&i.length>=n))break}return i}guessBest(t,e){return this.guess(t,e,1)[0]}addTrigrams(t,e){const n=this.languagesAlpha2[t],r=n?n.alpha3:t,i=o.getTopScript(e)[0],u=o.getTrigrams(e);s[i]&&(s[i][r]||(s[i][r]={}),u.forEach(t=>{s[i][r][t]=1}))}addExtraSentence(t,e){this.extraSentences.push([t,e]),this.addTrigrams(t,e)}processExtraSentences(){this.extraSentences.forEach(t=>{this.addTrigrams(t[0],t[1])})}static lansplit(t){if(t.includes("|"))return t.split("|");const e=[];for(let n=0;n<t.length;n+=3)e.push(t.substr(n,3));return e}static addModel(t,e,n){const r=s[t],i=o.lansplit(n);let u=i.length;const a={};for(;u>0;)u-=1,a[i[u]]=u;r[e]=a}addModel(t,e,n){o.addModel(t,e,n)}static buildModel(){Object.keys(s).forEach(t=>{const e=s[t];Object.keys(e).forEach(n=>{o.addModel(t,n,e[n])})})}}o.buildModel(),t.exports=o},function(t){t.exports=[["ar","arb","Arabic"],["bn","ben","Bengali"],["ca","cat","Catalan"],["cs","ces","Czech"],["da","dan","Danish"],["de","deu","German"],["el","ell","Greek"],["en","eng","English"],["eu","eus","Basque"],["fa","fas","Persian"],["fi","fin","Finnish"],["fr","fra","French"],["ga","gle","Irish"],["gl","glg","Galician"],["hi","hin","Hindi"],["hu","hun","Hungarian"],["hy","hye","Armenian"],["id","ind","Indonesian"],["it","ita","Italian"],["ja","jpn","Japanese"],["nl","nld","Dutch"],["no","nor","Norwegian"],["pt","por","Portuguese"],["ro","ron","Romanian"],["ru","rus","Russian"],["sl","slv","Slovenian"],["es","spa","Spanish"],["sv","swe","Swedish"],["ta","tam","Tamil"],["tl","tgl","Tagalog"],["th","tha","Thai"],["tr","tur","Turkish"],["uk","ukr","Ukrainian"],["zh","cmn","Chinese"]]},function(t){t.exports={Latin:{spa:"",eng:"",por:"",ind:"",fra:"",deu:"",ita:"",tur:"",nld:"",tgl:"",hun:"",ces:"",swe:"",fin:"",dan:"",cat:"",glg:"",slv:""},Cyrillic:{rus:"",ukr:""},Arabic:{arb:"",fas:""},Devanagari:{hin:""},Ethiopic:{},Hebrew:{}}},function(t,e,n){const r=n(262),s=n(263),i=n(264),u=n(265),o=n(266);t.exports={Ner:r,ExtractorEnum:s,ExtractorRegex:i,ExtractorTrim:u,ExtractorBuiltin:o}},function(t,e,n){const{Clonable:r}=n(5),{TrimType:s}=n(238);class i extends r{constructor(t={},e){super({settings:{},container:t.container||e},e),this.applySettings(this.settings,t),this.applySettings(this.settings),this.settings.tag||(this.settings.tag="ner"),this.registerDefault(),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag)),this.rules={},this.applySettings(this,{pipelineProcess:this.getPipeline(`${this.settings.tag}-process`)})}registerDefault(){this.container.registerPipeline("ner-process",[".decideRules","extract-enum","extract-regex","extract-trim","extract-builtin"],!1),this.container.registerPipeline("ner-??-process",[".decideRules","extract-enum","extract-regex","extract-trim","extract-builtin",".reduceEdges"],!1)}getRulesByName(t="*",e,n=!1){if(!this.rules[t]){if(!n)return;this.rules[t]={}}if(!this.rules[t][e]){if(!n)return;this.rules[t][e]={name:e,type:"enum",rules:[]}}return this.rules[t][e]}addRule(t="*",e,n,r){this.rules[t]||(this.rules[t]={}),this.rules[t][e]||(this.rules[t][e]={name:e,type:n,rules:[]}),this.rules[t][e].rules.push(r)}asString(t){return t&&t.toString?t.toString():JSON.stringify(t)}findRule(t,e){const n=this.asString(e);for(let e=0;e<t.length;e+=1)if(this.asString(t[e])===n)return e;return-1}removeRule(t="*",e,n){if(this.rules[t]&&this.rules[t][e])if(n){const r=this.findRule(this.rules[t][e].rules,n);r>-1&&this.rules[t][e].rules.splice(r,1)}else delete this.rules[t][e]}getRules(t="*"){const e=[];if(this.rules[t]){const n=Object.keys(this.rules[t]);for(let r=0;r<n.length;r+=1)e.push(this.rules[t][n[r]])}if("*"!==t&&this.rules["*"]){const t=Object.keys(this.rules["*"]);for(let n=0;n<t.length;n+=1)e.push(this.rules["*"][t[n]])}return e}decideRules(t){const e=t;return e.nerRules=this.getRules(e.locale||"en"),e}getRuleOption(t,e){for(let n=0;n<t.length;n+=1)if(t[n].option===e)return t[n]}addRuleOptionTexts(t,e,n,r){if(Array.isArray(t))for(let s=0;s<t.length;s+=1)this.addRuleOptionTexts(t[s],e,n,r);else{let s=r||n;Array.isArray(s)||(s=[s]);const i=this.getRulesByName(t,e,!0);let u=this.getRuleOption(i.rules,n);if(u){const t={};for(let e=0;e<u.texts.length;e+=1)t[u.texts[e]]=1;for(let e=0;e<s.length;e+=1)t[s[e]]=1;u.texts=Object.keys(t)}else u={option:n,texts:s},i.rules.push(u)}}removeRuleOptionTexts(t,e,n,r){if(Array.isArray(t))for(let s=0;s<t.length;s+=1)this.removeRuleOptionTexts(t[s],e,n,r);else{let s=r||n;Array.isArray(s)||(s=[s]);const i=this.getRulesByName(t,e,!1);if(i){const t=this.getRuleOption(i.rules,n);if(t){const e={};for(let n=0;n<t.texts.length;n+=1)e[t.texts[n]]=1;for(let t=0;t<s.length;t+=1)delete e[s[t]];t.texts=Object.keys(e)}}}}static str2regex(t){const e=t.lastIndexOf("/");return new RegExp(t.slice(1,e),t.slice(e+1))}static regex2str(t){return t.toString()}addRegexRule(t,e,n){const r="string"==typeof n?i.str2regex(n):n,s=r.flags.includes("g")?r:new RegExp(r.source,`${r.flags}g`);this.addRule(t,e,"regex",s)}addBetweenCondition(t,e,n,r,s){const u=s||{},o=Array.isArray(n)?n:[n],a=Array.isArray(r)?r:[r],c=[];for(let t=0;t<o.length;t+=1)for(let e=0;e<a.length;e+=1){const n=!0===u.noSpaces?o[t]:` ${o[t]} `,r=!0===u.noSpaces?a[e]:` ${a[e]} `;c.push(`(?<=${n})(.*)(?=${r})`)}let l=`/${c.join("|")}/g`;!0!==u.caseSensitive&&(l+="i");const p={type:"between",leftWords:o,rightWords:a,regex:i.str2regex(l),options:u};this.addRule(t,e,"trim",p)}addPositionCondition(t,e,n,r,s){const i=s||{},u={type:n,words:Array.isArray(r)?r:[r],options:i};this.addRule(t,e,"trim",u)}addAfterCondition(t,e,n,r){this.addPositionCondition(t,e,s.After,n,r)}addAfterFirstCondition(t,e,n,r){this.addPositionCondition(t,e,s.AfterFirst,n,r)}addAfterLastCondition(t,e,n,r){this.addPositionCondition(t,e,s.AfterLast,n,r)}addBeforeCondition(t,e,n,r){this.addPositionCondition(t,e,s.Before,n,r)}addBeforeFirstCondition(t,e,n,r){this.addPositionCondition(t,e,s.BeforeFirst,n,r)}addBeforeLastCondition(t,e,n,r){this.addPositionCondition(t,e,s.BeforeLast,n,r)}reduceEdges(t){return t.entities=t.edges,delete t.edges,delete t.nerRules,t}async process(t){const e={threshold:this.settings.threshold||.8,...t},n=await this.runPipeline(e,e.locale?`${this.settings.tag}-${e.locale}-process`:this.pipelineProcess);return delete n.threshold,n}nameToEntity(t){return`${void 0===this.settings.entityPreffix?"@":this.settings.entityPreffix}${t}${void 0===this.settings.entitySuffix?"":this.settings.entitySuffix}`}entityToName(t){if(!t)return t;let e=t;const n=void 0===this.settings.entityPreffix?"@":this.settings.entityPreffix,r=void 0===this.settings.entitySuffix?"":this.settings.entitySuffix;if(n){if(!e.startsWith(n))return t;e=e.slice(n.length)}if(r){if(!e.endsWith(r))return t;e=e.slice(0,-r.length)}return e}isEntity(t){return this.entityToName(t)!==t}getEntitiesFromUtterance(t,e){e||(e=t,t="es");const n=e.split(/[\s,.!?;:([\]'")/]+/).filter(t=>t),r=[];for(let t=0;t<n.length;t+=1){const e=n[t];this.isEntity(e)&&r.push(this.entityToName(e))}return r}async generateEntityUtterance(t,e){let n={locale:t,utterance:e};n=await this.process(n);const{entities:r}=n;if(!r||!r.length)return e;r.sort((t,e)=>t.start-e.start);let s=0,i="";for(let t=0;t<r.length;t+=1){const n=r[t],u=e.slice(s,n.start);s=n.end+1,i+=u,i+=this.nameToEntity(n.entity)}return i+=e.slice(r[r.length-1].end+1),i}toJSON(){const t={settings:{...this.settings},rules:this.rules};return delete t.settings.container,t}fromJSON(t){this.applySettings(this.settings,t.settings),this.rules=t.rules}}t.exports=i},function(t,e,n){const{defaultContainer:r}=n(5),{Language:s}=n(237),{similarity:i}=n(233),u=n(46);t.exports=class{constructor(t=r){this.container=t.container||t,this.name="extract-enum"}getScripts(t){const e=[],n=t.split("");for(let t=0;t<n.length;t+=1)e.push(s.getTopScript(n[t]));return e}isAlphanumeric(t){return/[\u00C0-\u1FFF\u2C00-\uD7FF\w]/.test(t)&&"_"!==t}getWordPositions(t){const e=this.getScripts(t);let n=!0,r=0,s=0;const i=t.length,u=[];for(;s<i;)this.isAlphanumeric(t.charAt(s))?n&&("cmn"===e[s][0]?(u.push({start:s,end:s,len:1}),r=s,n=!0):(r=s,n=!1)):n||(u.push({start:r,end:s-1,len:s-r}),n=!0),s+=1;return n||u.push({start:r,end:s-1,len:s-r}),u}getBestSubstring(t,e,n){const r=t.length,s=e.length;if(r<=s){const n={start:0,end:r-1,len:r,levenshtein:i(t,e,!0)};return n.accuracy=(s-n.levenshtein)/s,n}const u=n||this.getWordPositions(t),o=u.length,a={start:0,end:0,len:0,levenshtein:void 0,accuracy:0};for(let n=0;n<o;n+=1)for(let r=n;r<o;r+=1){const s=t.substring(u[n].start,u[r].end+1),o=i(s,e,!0);(void 0===a.levenshtein||o<a.levenshtein)&&(a.levenshtein=o,a.start=u[n].start,a.end=u[r].end,a.len=a.end-a.start+1)}return a.accuracy=(s-a.levenshtein)/s,a}getBestSubstringList(t,e,n,r=1){const s=t.length,u=e.length,o=[];if(s<=u){const n=i(t,e,!0),a=(u-n)/u;return a>=r&&o.push({start:0,end:s-1,len:s,levenshtein:n,accuracy:a}),o}const a=u*(1-r),c=n||this.getWordPositions(t),l=c.length;for(let n=0;n<l;n+=1)for(let s=n;s<l;s+=1){const l=t.substring(c[n].start,c[s].end+1),p=i(l,e,!0),h=(u-p)/u;if(h>=r&&o.push({start:c[n].start,end:c[s].end,len:c[s].end-c[n].start+1,levenshtein:p,accuracy:h}),l.length-c[0].len>=e.length+a)break}return o}getRules(t){const e=t.nerRules;return e?e.filter(t=>"enum"===t.type):[]}normalize(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}buildRuleDict(t){const e={};for(let n=0;n<t.rules.length;n+=1){const r=t.rules[n];for(let t=0;t<r.texts.length;t+=1){const n=this.normalize(r.texts[t]);e[n]||(e[n]=[]),e[n].push(r)}}t.dict=e}getBestExact(t,e,n){const r=this.normalize(t),s=e||this.getWordPositions(r),i=s.length,u=[];for(let e=0;e<i;e+=1)for(let o=e;o<i;o+=1){const i=r.substring(s[e].start,s[o].end+1);if(n.dict[i]){const r=n.dict[i];for(let a=0;a<r.length;a+=1)u.push({accuracy:1,start:s[e].start,end:s[o].end,len:s[o].end-s[e].start+1,levenshtein:0,entity:n.name,type:n.type,option:r[a].option,sourceText:i,utteranceText:t.substring(s[e].start,s[o].end+1)})}}return u}extractFromRule(t,e,n,r){const s=[];if(r>=1){e.dict||this.buildRuleDict(e);const r=this.getBestExact(t,n,e);for(let t=0;t<r.length;t+=1)s.push(r[t])}else for(let i=0;i<e.rules.length;i+=1){const u=e.rules[i];for(let o=0;o<u.texts.length;o+=1){const a=this.getBestSubstringList(t,u.texts[o],n,u.threshold||r);for(let n=0;n<a.length;n+=1)s.push({...a[n],entity:e.name,type:e.type,option:e.rules[i].option,sourceText:u.texts[o],utteranceText:t.substring(a[n].start,a[n].end+1)})}}return s}extract(t){const e=t,n=this.getWordPositions(e.text||e.utterance),r=this.getRules(e),s=e.edges||[];for(let t=0;t<r.length;t+=1){const i=this.extractFromRule(e.text||e.utterance,r[t],n,e.threshold||.8);for(let t=0;t<i.length;t+=1)s.push(i[t])}return s.sort((t,e)=>t.start-e.start),e.edges=u(s,!1),e}run(t){const e=t,n=e.locale||"en";return(this.container.get(`extract-enum-${n}`)||this).extract(e)}}},function(t,e,n){const{defaultContainer:r}=n(5),s=n(46);t.exports=class{constructor(t=r){this.container=t.container||t,this.name="extract-regex"}getRules(t){const e=t.nerRules;return e?e.filter(t=>"regex"===t.type):[]}getMatchs(t,e){const n=[];let r;do{const s=e.exec(t);s?(n.push({start:s.index,end:e.lastIndex-1,accuracy:1,sourceText:s[0]}),r=!0):r=!1}while(r);return n}extractFromRule(t,e){const n=[];for(let r=0;r<e.rules.length;r+=1){const s=this.getMatchs(t,e.rules[r]);for(let r=0;r<s.length;r+=1){const i=s[r];i.entity=e.name,i.type=e.type,i.utteranceText=t.substring(i.start,i.end+1),i.len=i.utteranceText.length,n.push(i)}}return n}extract(t){const e=t,n=this.getRules(e),r=e.edges||[];for(let t=0;t<n.length;t+=1){const s=this.extractFromRule(e.text||e.utterance,n[t]);for(let t=0;t<s.length;t+=1)r.push(s[t])}return r.sort((t,e)=>t.start-e.start),e.edges=s(r,!1),e}run(t){const e=t,n=e.locale||"en";return(this.container.get(`extract-regex-${n}`)||this).extract(e)}}},function(t,e,n){const{defaultContainer:r}=n(5),s=n(46),{TrimType:i}=n(238);t.exports=class{constructor(t=r){this.container=t.container||t,this.name="extract-trim"}mustSkip(t,e){if(e.options&&e.options.skip&&e.options.skip.length>0)for(let n=0;n<e.options.skip.length;n+=1){const r=e.options.skip[n];if(e.options.caseSensitive){if(r===t)return!0}else if(r.toLowerCase()===t.toLowerCase())return!0}return!1}matchBetween(t,e,n){const r=[];let s;do{const u=e.regex.exec(` ${t} `);u?(r.push({type:"trim",subtype:i.Between,start:u.index-1,end:e.regex.lastIndex-2,len:u[0].length,accuracy:1,sourceText:u[0],utteranceText:u[0],entity:n}),s=!0):s=!1}while(s);const u=[];for(let t=0;t<r.length;t+=1)this.mustSkip(r[t].utteranceText,e)||u.push(r[t]);return u}findWord(t,e,n=!1,r=!1){const s=[];let i;const u=new RegExp(r?e:` ${e} | ${e}|${e} `,n?"g":"ig");do{const e=u.exec(t);e?(s.push({start:e.index,end:u.lastIndex}),i=!0):i=!1}while(i);return s}getBeforeResults(t,e,n){const r=[];let s=0,u=0;for(let o=0;o<e.length;o+=1){u=e[o].start;const a=t.substring(s,u);r.push({type:"trim",subtype:i.Before,start:s,end:u-1,len:a.length,accuracy:.99,sourceText:a,utteranceText:a,entity:n}),s=e[o].end}return r}getBeforeFirstResults(t,e,n){const r=[],s=e[0].start,u=t.substring(0,s);return r.push({type:"trim",subtype:i.BeforeFirst,start:0,end:s-1,len:u.length,accuracy:.99,sourceText:u,utteranceText:u,entity:n}),r}getBeforeLastResults(t,e,n){const r=[],s=e[e.length-1].start,u=t.substring(0,s);return r.push({type:"trim",subtype:i.BeforeLast,start:0,end:s-1,len:u.length,accuracy:.99,sourceText:u,utteranceText:u,entity:n}),r}getAfterResults(t,e,n){const r=[];let s=0,u=t.length;for(let o=e.length-1;o>=0;o-=1){s=e[o].end;const a=t.substring(s,u);r.unshift({type:"trim",subtype:i.After,start:s,end:u-1,len:a.length,accuracy:.99,sourceText:a,utteranceText:a,entity:n}),u=e[o].start}return r}getAfterFirstResults(t,e,n){const r=[],s=e[0].end,u=t.length,o=t.substring(s,u);return r.push({type:"trim",subtype:i.AfterFirst,start:s,end:u-1,len:o.length,accuracy:.99,sourceText:o,utteranceText:o,entity:n}),r}getAfterLastResults(t,e,n){const r=[],s=e[e.length-1].end,u=t.length,o=t.substring(s,u);return r.push({type:"trim",subtype:i.AfterLast,start:s,end:u-1,len:o.length,accuracy:.99,sourceText:o,utteranceText:o,entity:n}),r}getResults(t,e,n,r){switch(n){case i.Before:return this.getBeforeResults(t,e,r);case i.BeforeFirst:return this.getBeforeFirstResults(t,e,r);case i.BeforeLast:return this.getBeforeLastResults(t,e,r);case i.After:return this.getAfterResults(t,e,r);case i.AfterFirst:return this.getAfterFirstResults(t,e,r);case i.AfterLast:return this.getAfterLastResults(t,e,r);default:return[]}}match(t,e,n,r){const s=[];for(let i=0;i<e.words.length;i+=1){const u=e.options.noSpaces?e.words[i]:` ${e.words[i]}`,o=this.findWord(t,u);o.length>0&&s.push(...this.getResults(t,o,n,r))}const i=[];for(let t=0;t<s.length;t+=1)this.mustSkip(s[t].utteranceText,e)||i.push(s[t]);return i}getRules(t){const e=t.nerRules;return e?e.filter(t=>"trim"===t.type):[]}extractFromRule(t,e){const n=[];for(let r=0;r<e.rules.length;r+=1){const s=e.rules[r];s.type===i.Between?n.push(...this.matchBetween(t,s,e.name)):n.push(...this.match(t,s,s.type,e.name))}return n}extract(t){const e=t,n=this.getRules(e),r=e.edges||[];for(let t=0;t<n.length;t+=1){const s=this.extractFromRule(e.text||e.utterance,n[t]);for(let t=0;t<s.length;t+=1)r.push(s[t])}return r.sort((t,e)=>t.start-e.start),e.edges=s(r,!1),e}run(t){const e=t,n=e.locale||"en";return(this.container.get(`extract-trim-${n}`)||this).extract(e)}}},function(t,e,n){const{defaultContainer:r}=n(5),s=n(46);t.exports=class{constructor(t=r){this.container=t.container||t,this.name="extract-builtin"}extract(t){return t}async run(t){const e=t,n=e.locale||"en",r=this.container.get(`extract-builtin-${n}`)||this,i=await r.extract({text:e.text||e.utterance,locale:e.locale});if(e.edges=e.edges||[],i.edges)for(let t=0;t<i.edges.length;t+=1)e.edges.push(i.edges[t]);if(e.edges=s(e.edges,!1),e.sourceEntities=e.sourceEntities||[],i.sourceEntities)for(let t=0;t<i.sourceEntities.length;t+=1)e.sourceEntities.push(i.sourceEntities[t]);return e}}},function(t,e,n){const r=n(268),s=n(269);t.exports={NlgManager:r,ActionManager:s}},function(t,e,n){const{Clonable:r}=n(5);t.exports=class extends r{constructor(t={},e){super({settings:{},container:t.container||e},e),this.applySettings(this.settings,t),this.settings.tag||(this.settings.tag="nlg-manager"),this.registerDefault(),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag)),this.responses={},this.applySettings(this,{pipelineFind:this.getPipeline(`${this.settings.tag}-find`)})}registerDefault(){this.container.registerConfiguration("nlg-manager",{},!1),this.container.registerPipeline("nlg-manager-find",[".findAllAnswers",".filterAnswers",".renderRandom",".chooseRandom"],!1)}findAllAnswers(t){const e=t;return this.responses[e.locale]?e.answers=this.responses[e.locale][e.intent]||[]:e.answers=[],e}filterAnswers(t){const e=t,{answers:n}=e;if(n&&n.length){const t=this.container.get("Evaluator");if(t){const r=e.context||{},s=[];for(let e=0;e<n.length;e+=1){const i=n[e];if(i.opts){const e="string"==typeof i.opts?i.opts:i.opts.condition;e?!0===t.evaluate(e,r)&&s.push(i):s.push(i)}else s.push(i)}e.answers=s}}return e}chooseRandom(t){const e=t,{answers:n}=e;return n&&n.length&&(e.answer=n[Math.floor(Math.random()*n.length)].answer),e}renderText(t,e){if(!t)return t;let n,r=t;do{const t=/\((?:[^()]+)\|(?:[^()]+)\)/g.exec(r);if(t){for(let e=0;e<t.length;e+=1){const n=t[e],s=n.substring(1,n.length-1).split("|");r=r.replace(n,s[Math.floor(Math.random()*s.length)])}n=!0}else n=!1}while(n);const s=this.container.get("Template");return s&&e?s.compile(t,e):r}renderRandom(t){const e=t,{answers:n,context:r}=e;for(let t=0;t<n.length;t+=1)n[t]=this.renderText(n[t],r);return e}indexOfAnswer(t,e,n,r){if(!this.responses[t])return-1;if(!this.responses[t][e])return-1;const s=this.responses[t][e];for(let t=0;t<s.length;t+=1){const e=s[t];if(e.answer===n&&JSON.stringify(e.opts)===JSON.stringify(r))return t}return-1}add(t,e,n,r){const s=this.indexOfAnswer(t,e,n,r);if(-1!==s)return this.responses[t][e][s];this.responses[t]||(this.responses[t]={}),this.responses[t][e]||(this.responses[t][e]=[]);const i={answer:n,opts:r};return this.responses[t][e].push(i),i}remove(t,e,n,r){const s=this.indexOfAnswer(t,e,n,r);-1!==s&&this.responses[t][e].splice(s,1)}find(t,e,n,r){const s={locale:t,intent:e,context:n,settings:r||this.settings};return this.runPipeline(s,this.pipelineFind)}run(t,e){return this.find(t.locale,t.intent,t.context,e)}toJSON(){const t={settings:{...this.settings},responses:this.responses};return delete t.settings.container,t}fromJSON(t){this.applySettings(this.settings,t.settings),this.responses=t.responses}}},function(t,e,n){const{Clonable:r}=n(5);t.exports=class extends r{constructor(t={},e){super({settings:{},container:t.container||e},e),this.applySettings(this.settings,t),this.settings.tag||(this.settings.tag="action-manager"),this.registerDefault(),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag)),this.actions={},this.actionsMap={},this.applySettings(this,{pipelineFind:this.getPipeline(`${this.settings.tag}-find`)})}registerDefault(){}posAction(t,e,n){if(!this.actions[t])return-1;const r=this.actions[t];for(let t=0;t<r.length;t+=1)if(r[t].action===e&&r[t].parameters.toString()===n.toString())return t;return-1}findActions(t){return(this.actions[t]||[]).map(t=>({...t,fn:this.actionsMap[t.action]}))}async processActions(t,e){const n=this.findActions(t);"object"==typeof e&&(e.actions=n.map(t=>({action:t.action,parameters:t.parameters})));let r=e;for(const{fn:t,parameters:e}of n)if(t){const n=await t(r,...e||[]);n&&("object"==typeof r?"object"==typeof n?r=n:r.answer=n:r=n)}return r}addAction(t,e,n,r){-1===this.posAction(t,e,n)&&(this.actions[t]||(this.actions[t]=[]),this.actions[t].push({action:e,parameters:n}),r&&(this.actionsMap[e]=r))}removeAction(t,e,n){const r=this.posAction(t,e,n);r>-1&&this.actions[t].splice(r,1)}removeActions(t){delete this.actions[t]}removeActionFromMap(t){delete this.actionsMap[t]}run(t,e){const n=t;return n.settings=n.settings||e||this.settings,this.processActions(t.intent,n)}toJSON(){const t={settings:{...this.settings},actions:this.actions};return delete t.settings.container,t}fromJSON(t){this.applySettings(this.settings,t.settings),this.actions=t.actions}}},function(t,e,n){const r=n(271);t.exports={SentimentAnalyzer:r}},function(t,e,n){const{Clonable:r}=n(5);t.exports=class extends r{constructor(t={},e){super({settings:{},container:t.container||e},e),this.applySettings(this.settings,t),this.settings.tag||(this.settings.tag="sentiment-analyzer"),this.registerDefault(),this.applySettings(this.settings,this.container.getConfiguration(this.settings.tag)),this.applySettings(this,{pipelinePrepare:this.getPipeline(`${this.settings.tag}-prepare`),pipelineProcess:this.getPipeline(`${this.settings.tag}-process`)})}registerDefault(){this.container.registerConfiguration("sentiment-analyzer",{},!1),this.container.registerPipeline("sentiment-analyzer-process",[".getDictionary",".getTokens",".calculate","delete output.sentimentDictionary"],!1)}prepare(t,e,n){const r=this.getPipeline(`${this.settings.tag}-prepare`)||this.getPipeline(`nlu-${t||"en"}-prepare`),s={text:e,locale:t,settings:n||this.settings};return this.runPipeline(s,r)}async getDictionary(t){const e=t,n=this.container.get(`sentiment-${e.locale}`);let r;return n&&(n.senticon&&Object.keys(n.senticon).length?r="senticon":n.pattern&&Object.keys(n.pattern).length?r="pattern":n.afinn&&Object.keys(n.afinn).length&&(r="afinn")),r?(e.sentimentDictionary={type:r,dictionary:n[r],negations:n.negations.words},e):(e.sentimentDictionary={type:r,dictionary:{},negations:[]},e)}async getTokens(t){const e=t;return!e.tokens&&e.sentimentDictionary.type&&(e.tokens=await this.prepare(e.locale,e.utterance||e.text,e.settings)),e}calculate(t){const e=t;if(e.sentimentDictionary.type){const t=Array.isArray(e.tokens)?e.tokens:Object.keys(e.tokens);if(0===Object.keys(e.sentimentDictionary.dictionary).length)e.sentiment={score:0,numWords:t.length,numHits:0,average:0,type:e.sentimentDictionary.type,locale:e.locale};else{const{dictionary:n}=e.sentimentDictionary,{negations:r}=e.sentimentDictionary;let s=0,i=1,u=0;for(let e=0;e<t.length;e+=1){const o=t[e].toLowerCase();-1!==r.indexOf(o)?(i=-1,u+=1):void 0!==n[o]&&(s+=i*n[o],u+=1)}e.sentiment={score:s,numWords:t.length,numHits:u,average:s/t.length,type:e.sentimentDictionary.type,locale:e.locale}}}else e.sentiment={score:0,numWords:0,numHits:0,average:0,type:e.sentimentDictionary.type,locale:e.locale};return e.sentiment.score>0?e.sentiment.vote="positive":e.sentiment.score<0?e.sentiment.vote="negative":e.sentiment.vote="neutral",e}process(t,e){const n=t;return n.settings=n.settings||e||this.settings,this.runPipeline(n,this.pipelineProcess)}}},function(t,e,n){const r=n(273);t.exports={SlotManager:r}},function(t,e){t.exports=class{constructor(){this.intents={}}getSlot(t,e){if(this.intents[t])return this.intents[t][e]}existsSlot(t,e){return void 0!==this.getSlot(t,e)}addSlot(t,e,n=!1,r){return this.intents[t]||(this.intents[t]={}),this.intents[t][e]={intent:t,entity:e,mandatory:n,locales:r||{}},this.intents[t][e]}removeSlot(t,e){this.intents[t]&&delete this.intents[t][e]}addBatch(t,e){const n=[];return e&&e.length>0&&e.forEach(e=>{let r=this.getSlot(t,e);r||(r=this.addSlot(t,e)),n.push(r)}),n}getIntentEntityNames(t){if(this.intents[t])return Object.keys(this.intents[t])}clear(){this.intents={}}load(t){this.intents=t||{}}save(){return this.intents}getMandatorySlots(t){const e={},n=this.intents[t];if(n){const t=Object.keys(n);for(let r=0,s=t.length;r<s;r+=1){const s=n[t[r]];s.mandatory&&(e[s.entity]=s)}}return e}cleanContextEntities(t,e){const n=e;if(n.slotFill)return;const r=this.getMandatorySlots(t),s=Object.keys(r);0!==s.length&&s.forEach(t=>{delete n[t]})}process(t,e){const n=t,r=e;if(this.cleanContextEntities(n.intent,r),r.slotFill&&(n.intent=r.slotFill.intent,n.answer=r.slotFill.answer,n.srcAnswer=r.slotFill.srcAnswer),!n.intent||"None"===n.intent)return!1;r.slotFill&&r.slotFill.intent===n.intent&&(n.entities=[...r.slotFill.entities,...n.entities]);const s=this.getMandatorySlots(n.intent);let i=Object.keys(s);if(0===i.length)return!1;r.slotFill&&n.entities.push({entity:r.slotFill.currentSlot,utteranceText:n.utterance,sourceText:n.utterance,accuracy:.95,start:0,end:n.utterance.length-1,len:n.utterance.length});for(let t=0,e=n.entities.length;t<e;t+=1)delete s[n.entities[t].entity];if(i=Object.keys(s),!i||0===i.length)return!0;r.slotFill&&r.slotFill.intent===n.intent&&(n.localeIso2=r.slotFill.localeIso2),n.slotFill={localeIso2:n.localeIso2,intent:n.intent,entities:n.entities,answer:n.answer,srcAnswer:n.srcAnswer};const u=s[i[0]];return n.slotFill.currentSlot=u.entity,n.srcAnswer=u.locales[n.localeIso2],r.slotFill=n.slotFill,!0}}},function(t,e){t.exports=function(t){return async(e,n,r)=>{const s=await t.process(e),i={};for(let t of s.entities){let e;t.resolution?e=t.resolution:t.utteranceText&&(e={value:t.utteranceText}),i[t.entity]=e}return i.date&&(i.date.value=i.date.date,delete i.date.date),i.dimension&&(i.distance=Object.assign({},i.dimension),delete i.dimension),i.sentiment=s.sentiment.vote,{[s.intent]:()=>i}}}},function(t,e,n){"use strict";t.exports={PUSH:0,PUSH_UNDEFINED:1,PUSH_NULL:2,PUSH_FAILED:3,PUSH_EMPTY_ARRAY:4,PUSH_CURR_POS:5,POP:6,POP_CURR_POS:7,POP_N:8,NIP:9,APPEND:10,WRAP:11,TEXT:12,IF:13,IF_ERROR:14,IF_NOT_ERROR:15,WHILE_NOT_ERROR:16,MATCH_ANY:17,MATCH_STRING:18,MATCH_STRING_IC:19,MATCH_REGEXP:20,ACCEPT_N:21,ACCEPT_STRING:22,FAIL:23,LOAD_SAVED_POS:24,UPDATE_SAVED_POS:25,CALL:26,RULE:27,SILENT_FAILS_ON:28,SILENT_FAILS_OFF:29}},function(t,e,n){"use strict";function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}var s={stringEscape:function(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\xFF]/g,(function(t){return"\\x"+r(t)})).replace(/[\u0100-\u0FFF]/g,(function(t){return"\\u0"+r(t)})).replace(/[\u1000-\uFFFF]/g,(function(t){return"\\u"+r(t)}))},regexpClassEscape:function(t){return t.replace(/\\/g,"\\\\").replace(/\//g,"\\/").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\v/g,"\\x0B").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\xFF]/g,(function(t){return"\\x"+r(t)})).replace(/[\u0100-\u0FFF]/g,(function(t){return"\\u0"+r(t)})).replace(/[\u1000-\uFFFF]/g,(function(t){return"\\u"+r(t)}))}};t.exports=s},function(t,e,n){"use strict";n.r(e);n(278);var r=n(224);n.d(e,"Converse",(function(){return r.Converse})),n.d(e,"NewBot",(function(){return r.NewBot}))},function(t,e,n){(function(t){const e=n(279),r=n(291),s=n(22),i=e.generate(r);s.is()?window.newbotParser=i:t.newbotParser=i}).call(this,n(42))},function(t,e,n){"use strict";var r=n(44),s=n(84),i={VERSION:"0.10.0",GrammarError:n(85),parser:n(281),compiler:n(282),generate:function(t,e){e=void 0!==e?e:{};var n="plugins"in(e=s.clone(e))?e.plugins:[],u={parser:i.parser,passes:function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=s.values(t[e]));return n}(i.compiler.passes)};return r.each(n,(function(t){t.use(u,e)})),i.compiler.compile(u.parser.parse(t),u.passes,e)}};t.exports=i},function(t,e,n){"use strict";t.exports={subclass:function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}}},function(t,e,n){"use strict";function r(t,e,n,s){this.message=t,this.expected=e,this.found=n,this.location=s,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,r)}!function(t,e){function n(){this.constructor=t}n.prototype=e.prototype,t.prototype=new n}(r,Error),r.buildMessage=function(t,e){var n={literal:function(t){return'"'+s(t.text)+'"'},class:function(t){var e,n="";for(e=0;e<t.parts.length;e++)n+=t.parts[e]instanceof Array?i(t.parts[e][0])+"-"+i(t.parts[e][1]):i(t.parts[e]);return"["+(t.inverted?"^":"")+n+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function s(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}return"Expected "+function(t){var e,r,s,i=new Array(t.length);for(e=0;e<t.length;e++)i[e]=(s=t[e],n[s.type](s));if(i.sort(),i.length>0){for(e=1,r=1;e<i.length;e++)i[e-1]!==i[e]&&(i[r]=i[e],r++);i.length=r}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+function(t){return t?'"'+s(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:r,parse:function(t,e){e=void 0!==e?e:{};var n,s={},i={Grammar:qr},u=qr,o=function(t,e){return{type:"grammar",initializer:(n=t,r=0,n?n[r]:null),rules:ks(e,0),location:Ir()};var n,r},a=function(t){return{type:"initializer",code:t,location:Ir()}},c="=",l=Mr("=",!1),p=function(t,e,n){return{type:"rule",name:t,expression:null!==e?{type:"named",name:e[0],expression:n,location:Ir()}:n,location:Ir()}},h="/",f=Mr("/",!1),g=function(t,e){return e.length>0?{type:"choice",alternatives:Ss(t,e,3),location:Ir()}:t},d=function(t,e){return null!==e?{type:"action",expression:t,code:e[1],location:Ir()}:t},A=function(t,e){return e.length>0?{type:"sequence",elements:Ss(t,e,1),location:Ir()}:t},m=":",v=Mr(":",!1),E=function(t,e){return{type:"labeled",label:t,expression:e,location:Ir()}},y=function(t,e){return{type:Ds[t],expression:e,location:Ir()}},C="$",b=Mr("$",!1),F="&",x=Mr("&",!1),D="!",_=Mr("!",!1),B=function(t,e){return{type:_s[e],expression:t,location:Ir()}},w="?",k=Mr("?",!1),S="*",P=Mr("*",!1),j="+",O=Mr("+",!1),N="(",$=Mr("(",!1),T=")",R=Mr(")",!1),L=function(t){return"labeled"===t.type||"sequence"===t.type?{type:"group",expression:t}:t},I=function(t){return{type:"rule_ref",name:t,location:Ir()}},M=function(t,e){return{type:Bs[t],code:e,location:Ir()}},V={type:"any"},z=zr("whitespace"),U="\t",H=Mr("\t",!1),J="\v",W=Mr("\v",!1),q="\f",G=Mr("\f",!1),Q=" ",Y=Mr(" ",!1),X="",Z=Mr("",!1),K="\ufeff",tt=Mr("\ufeff",!1),et=/^[\n\r\u2028\u2029]/,nt=Vr(["\n","\r","\u2028","\u2029"],!1,!1),rt=zr("end of line"),st="\n",it=Mr("\n",!1),ut="\r\n",ot=Mr("\r\n",!1),at="\r",ct=Mr("\r",!1),lt="\u2028",pt=Mr("\u2028",!1),ht="\u2029",ft=Mr("\u2029",!1),gt=zr("comment"),dt="/*",At=Mr("/*",!1),mt="*/",vt=Mr("*/",!1),Et="//",yt=Mr("//",!1),Ct=function(t){return t},bt=zr("identifier"),Ft=function(t,e){return t+e.join("")},xt="_",Dt=Mr("_",!1),_t="\\",Bt=Mr("\\",!1),wt=function(t){return t},kt="",St=Mr("",!1),Pt="",jt=Mr("",!1),Ot=zr("literal"),Nt="i",$t=Mr("i",!1),Tt=function(t,e){return{type:"literal",value:t,ignoreCase:null!==e,location:Ir()}},Rt=zr("string"),Lt='"',It=Mr('"',!1),Mt=function(t){return t.join("")},Vt="'",zt=Mr("'",!1),Ut=function(){return Lr()},Ht=zr("character class"),Jt="[",Wt=Mr("[",!1),qt="^",Gt=Mr("^",!1),Qt="]",Yt=Mr("]",!1),Xt=function(t,e,n){return{type:"class",parts:ws(e),inverted:null!==t,ignoreCase:null!==n,location:Ir()}},Zt="-",Kt=Mr("-",!1),te=function(t,e){return t.charCodeAt(0)>e.charCodeAt(0)&&function(t,e){throw e=void 0!==e?e:Hr(Or,jr),function(t,e){return new r(t,null,null,e)}(t,e)}("Invalid character range: "+Lr()+"."),[t,e]},ee=function(){return""},ne="0",re=Mr("0",!1),se=function(){return"\0"},ie="b",ue=Mr("b",!1),oe=function(){return"\b"},ae="f",ce=Mr("f",!1),le=function(){return"\f"},pe="n",he=Mr("n",!1),fe=function(){return"\n"},ge="r",de=Mr("r",!1),Ae=function(){return"\r"},me="t",ve=Mr("t",!1),Ee=function(){return"\t"},ye="v",Ce=Mr("v",!1),be=function(){return"\v"},Fe="x",xe=Mr("x",!1),De="u",_e=Mr("u",!1),Be=function(t){return String.fromCharCode(parseInt(t,16))},we=/^[0-9]/,ke=Vr([["0","9"]],!1,!1),Se=/^[0-9a-f]/i,Pe=Vr([["0","9"],["a","f"]],!1,!0),je=".",Oe=Mr(".",!1),Ne=function(){return{type:"any",location:Ir()}},$e=zr("code block"),Te="{",Re=Mr("{",!1),Le="}",Ie=Mr("}",!1),Me=function(t){return t},Ve=/^[{}]/,ze=Vr(["{","}"],!1,!1),Ue=/^[a-z\xB5\xDF-\xF6\xF8-\xFF\u0101\u0103\u0105\u0107\u0109\u010B\u010D\u010F\u0111\u0113\u0115\u0117\u0119\u011B\u011D\u011F\u0121\u0123\u0125\u0127\u0129\u012B\u012D\u012F\u0131\u0133\u0135\u0137-\u0138\u013A\u013C\u013E\u0140\u0142\u0144\u0146\u0148-\u0149\u014B\u014D\u014F\u0151\u0153\u0155\u0157\u0159\u015B\u015D\u015F\u0161\u0163\u0165\u0167\u0169\u016B\u016D\u016F\u0171\u0173\u0175\u0177\u017A\u017C\u017E-\u0180\u0183\u0185\u0188\u018C-\u018D\u0192\u0195\u0199-\u019B\u019E\u01A1\u01A3\u01A5\u01A8\u01AA-\u01AB\u01AD\u01B0\u01B4\u01B6\u01B9-\u01BA\u01BD-\u01BF\u01C6\u01C9\u01CC\u01CE\u01D0\u01D2\u01D4\u01D6\u01D8\u01DA\u01DC-\u01DD\u01DF\u01E1\u01E3\u01E5\u01E7\u01E9\u01EB\u01ED\u01EF-\u01F0\u01F3\u01F5\u01F9\u01FB\u01FD\u01FF\u0201\u0203\u0205\u0207\u0209\u020B\u020D\u020F\u0211\u0213\u0215\u0217\u0219\u021B\u021D\u021F\u0221\u0223\u0225\u0227\u0229\u022B\u022D\u022F\u0231\u0233-\u0239\u023C\u023F-\u0240\u0242\u0247\u0249\u024B\u024D\u024F-\u0293\u0295-\u02AF\u0371\u0373\u0377\u037B-\u037D\u0390\u03AC-\u03CE\u03D0-\u03D1\u03D5-\u03D7\u03D9\u03DB\u03DD\u03DF\u03E1\u03E3\u03E5\u03E7\u03E9\u03EB\u03ED\u03EF-\u03F3\u03F5\u03F8\u03FB-\u03FC\u0430-\u045F\u0461\u0463\u0465\u0467\u0469\u046B\u046D\u046F\u0471\u0473\u0475\u0477\u0479\u047B\u047D\u047F\u0481\u048B\u048D\u048F\u0491\u0493\u0495\u0497\u0499\u049B\u049D\u049F\u04A1\u04A3\u04A5\u04A7\u04A9\u04AB\u04AD\u04AF\u04B1\u04B3\u04B5\u04B7\u04B9\u04BB\u04BD\u04BF\u04C2\u04C4\u04C6\u04C8\u04CA\u04CC\u04CE-\u04CF\u04D1\u04D3\u04D5\u04D7\u04D9\u04DB\u04DD\u04DF\u04E1\u04E3\u04E5\u04E7\u04E9\u04EB\u04ED\u04EF\u04F1\u04F3\u04F5\u04F7\u04F9\u04FB\u04FD\u04FF\u0501\u0503\u0505\u0507\u0509\u050B\u050D\u050F\u0511\u0513\u0515\u0517\u0519\u051B\u051D\u051F\u0521\u0523\u0525\u0527\u0529\u052B\u052D\u052F\u0561-\u0587\u13F8-\u13FD\u1D00-\u1D2B\u1D6B-\u1D77\u1D79-\u1D9A\u1E01\u1E03\u1E05\u1E07\u1E09\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1E1F\u1E21\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E2D\u1E2F\u1E31\u1E33\u1E35\u1E37\u1E39\u1E3B\u1E3D\u1E3F\u1E41\u1E43\u1E45\u1E47\u1E49\u1E4B\u1E4D\u1E4F\u1E51\u1E53\u1E55\u1E57\u1E59\u1E5B\u1E5D\u1E5F\u1E61\u1E63\u1E65\u1E67\u1E69\u1E6B\u1E6D\u1E6F\u1E71\u1E73\u1E75\u1E77\u1E79\u1E7B\u1E7D\u1E7F\u1E81\u1E83\u1E85\u1E87\u1E89\u1E8B\u1E8D\u1E8F\u1E91\u1E93\u1E95-\u1E9D\u1E9F\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u1EC9\u1ECB\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u1EF3\u1EF5\u1EF7\u1EF9\u1EFB\u1EFD\u1EFF-\u1F07\u1F10-\u1F15\u1F20-\u1F27\u1F30-\u1F37\u1F40-\u1F45\u1F50-\u1F57\u1F60-\u1F67\u1F70-\u1F7D\u1F80-\u1F87\u1F90-\u1F97\u1FA0-\u1FA7\u1FB0-\u1FB4\u1FB6-\u1FB7\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FC7\u1FD0-\u1FD3\u1FD6-\u1FD7\u1FE0-\u1FE7\u1FF2-\u1FF4\u1FF6-\u1FF7\u210A\u210E-\u210F\u2113\u212F\u2134\u2139\u213C-\u213D\u2146-\u2149\u214E\u2184\u2C30-\u2C5E\u2C61\u2C65-\u2C66\u2C68\u2C6A\u2C6C\u2C71\u2C73-\u2C74\u2C76-\u2C7B\u2C81\u2C83\u2C85\u2C87\u2C89\u2C8B\u2C8D\u2C8F\u2C91\u2C93\u2C95\u2C97\u2C99\u2C9B\u2C9D\u2C9F\u2CA1\u2CA3\u2CA5\u2CA7\u2CA9\u2CAB\u2CAD\u2CAF\u2CB1\u2CB3\u2CB5\u2CB7\u2CB9\u2CBB\u2CBD\u2CBF\u2CC1\u2CC3\u2CC5\u2CC7\u2CC9\u2CCB\u2CCD\u2CCF\u2CD1\u2CD3\u2CD5\u2CD7\u2CD9\u2CDB\u2CDD\u2CDF\u2CE1\u2CE3-\u2CE4\u2CEC\u2CEE\u2CF3\u2D00-\u2D25\u2D27\u2D2D\uA641\uA643\uA645\uA647\uA649\uA64B\uA64D\uA64F\uA651\uA653\uA655\uA657\uA659\uA65B\uA65D\uA65F\uA661\uA663\uA665\uA667\uA669\uA66B\uA66D\uA681\uA683\uA685\uA687\uA689\uA68B\uA68D\uA68F\uA691\uA693\uA695\uA697\uA699\uA69B\uA723\uA725\uA727\uA729\uA72B\uA72D\uA72F-\uA731\uA733\uA735\uA737\uA739\uA73B\uA73D\uA73F\uA741\uA743\uA745\uA747\uA749\uA74B\uA74D\uA74F\uA751\uA753\uA755\uA757\uA759\uA75B\uA75D\uA75F\uA761\uA763\uA765\uA767\uA769\uA76B\uA76D\uA76F\uA771-\uA778\uA77A\uA77C\uA77F\uA781\uA783\uA785\uA787\uA78C\uA78E\uA791\uA793-\uA795\uA797\uA799\uA79B\uA79D\uA79F\uA7A1\uA7A3\uA7A5\uA7A7\uA7A9\uA7B5\uA7B7\uA7FA\uAB30-\uAB5A\uAB60-\uAB65\uAB70-\uABBF\uFB00-\uFB06\uFB13-\uFB17\uFF41-\uFF5A]/,He=Vr([["a","z"],"",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","",["",""],"","",["",""],"","","","","",["",""],"","","","",["",""],["",""],"","","","","","","","","","",["",""],"","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"",["",""],"","","","","",["",""],["",""],"","","",["",""],"",["",""],["",""],["",""],"","","","","","","","","","","",["",""],"","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],["",""],["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"","","","",["",""],["",""],"","",["",""],"",["",""],"","","","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","",["",""],"","","","","","","","","","","","","",["",""],["",""],["",""],["",""],["",""],["",""]],!1,!1),Je=/^[\u02B0-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0374\u037A\u0559\u0640\u06E5-\u06E6\u07F4-\u07F5\u07FA\u081A\u0824\u0828\u0971\u0E46\u0EC6\u10FC\u17D7\u1843\u1AA7\u1C78-\u1C7D\u1D2C-\u1D6A\u1D78\u1D9B-\u1DBF\u2071\u207F\u2090-\u209C\u2C7C-\u2C7D\u2D6F\u2E2F\u3005\u3031-\u3035\u303B\u309D-\u309E\u30FC-\u30FE\uA015\uA4F8-\uA4FD\uA60C\uA67F\uA69C-\uA69D\uA717-\uA71F\uA770\uA788\uA7F8-\uA7F9\uA9CF\uA9E6\uAA70\uAADD\uAAF3-\uAAF4\uAB5C-\uAB5F\uFF70\uFF9E-\uFF9F]/,We=Vr([["",""],["",""],["",""],"","","","","","",["",""],["",""],"","","","","","","","","","","",["",""],["",""],"",["",""],"","",["",""],["",""],"","","",["",""],"",["",""],["",""],"",["",""],"","",["",""],["",""],"","",["",""],"","","","",["",""],["",""],"",["",""]],!1,!1),qe=/^[\xAA\xBA\u01BB\u01C0-\u01C3\u0294\u05D0-\u05EA\u05F0-\u05F2\u0620-\u063F\u0641-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u0800-\u0815\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0972-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E45\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10D0-\u10FA\u10FD-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17DC\u1820-\u1842\u1844-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C77\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u2135-\u2138\u2D30-\u2D67\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3006\u303C\u3041-\u3096\u309F\u30A1-\u30FA\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA014\uA016-\uA48C\uA4D0-\uA4F7\uA500-\uA60B\uA610-\uA61F\uA62A-\uA62B\uA66E\uA6A0-\uA6E5\uA78F\uA7F7\uA7FB-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9E0-\uA9E4\uA9E7-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA6F\uAA71-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADC\uAAE0-\uAAEA\uAAF2\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF66-\uFF6F\uFF71-\uFF9D\uFFA0-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,Ge=Vr(["","","",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],"","",["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],"","",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],"","",["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"",["",""],["",""],"","",["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],!1,!1),Qe=/^[\u01C5\u01C8\u01CB\u01F2\u1F88-\u1F8F\u1F98-\u1F9F\u1FA8-\u1FAF\u1FBC\u1FCC\u1FFC]/,Ye=Vr(["","","","",["",""],["",""],["",""],"","",""],!1,!1),Xe=/^[A-Z\xC0-\xD6\xD8-\xDE\u0100\u0102\u0104\u0106\u0108\u010A\u010C\u010E\u0110\u0112\u0114\u0116\u0118\u011A\u011C\u011E\u0120\u0122\u0124\u0126\u0128\u012A\u012C\u012E\u0130\u0132\u0134\u0136\u0139\u013B\u013D\u013F\u0141\u0143\u0145\u0147\u014A\u014C\u014E\u0150\u0152\u0154\u0156\u0158\u015A\u015C\u015E\u0160\u0162\u0164\u0166\u0168\u016A\u016C\u016E\u0170\u0172\u0174\u0176\u0178-\u0179\u017B\u017D\u0181-\u0182\u0184\u0186-\u0187\u0189-\u018B\u018E-\u0191\u0193-\u0194\u0196-\u0198\u019C-\u019D\u019F-\u01A0\u01A2\u01A4\u01A6-\u01A7\u01A9\u01AC\u01AE-\u01AF\u01B1-\u01B3\u01B5\u01B7-\u01B8\u01BC\u01C4\u01C7\u01CA\u01CD\u01CF\u01D1\u01D3\u01D5\u01D7\u01D9\u01DB\u01DE\u01E0\u01E2\u01E4\u01E6\u01E8\u01EA\u01EC\u01EE\u01F1\u01F4\u01F6-\u01F8\u01FA\u01FC\u01FE\u0200\u0202\u0204\u0206\u0208\u020A\u020C\u020E\u0210\u0212\u0214\u0216\u0218\u021A\u021C\u021E\u0220\u0222\u0224\u0226\u0228\u022A\u022C\u022E\u0230\u0232\u023A-\u023B\u023D-\u023E\u0241\u0243-\u0246\u0248\u024A\u024C\u024E\u0370\u0372\u0376\u037F\u0386\u0388-\u038A\u038C\u038E-\u038F\u0391-\u03A1\u03A3-\u03AB\u03CF\u03D2-\u03D4\u03D8\u03DA\u03DC\u03DE\u03E0\u03E2\u03E4\u03E6\u03E8\u03EA\u03EC\u03EE\u03F4\u03F7\u03F9-\u03FA\u03FD-\u042F\u0460\u0462\u0464\u0466\u0468\u046A\u046C\u046E\u0470\u0472\u0474\u0476\u0478\u047A\u047C\u047E\u0480\u048A\u048C\u048E\u0490\u0492\u0494\u0496\u0498\u049A\u049C\u049E\u04A0\u04A2\u04A4\u04A6\u04A8\u04AA\u04AC\u04AE\u04B0\u04B2\u04B4\u04B6\u04B8\u04BA\u04BC\u04BE\u04C0-\u04C1\u04C3\u04C5\u04C7\u04C9\u04CB\u04CD\u04D0\u04D2\u04D4\u04D6\u04D8\u04DA\u04DC\u04DE\u04E0\u04E2\u04E4\u04E6\u04E8\u04EA\u04EC\u04EE\u04F0\u04F2\u04F4\u04F6\u04F8\u04FA\u04FC\u04FE\u0500\u0502\u0504\u0506\u0508\u050A\u050C\u050E\u0510\u0512\u0514\u0516\u0518\u051A\u051C\u051E\u0520\u0522\u0524\u0526\u0528\u052A\u052C\u052E\u0531-\u0556\u10A0-\u10C5\u10C7\u10CD\u13A0-\u13F5\u1E00\u1E02\u1E04\u1E06\u1E08\u1E0A\u1E0C\u1E0E\u1E10\u1E12\u1E14\u1E16\u1E18\u1E1A\u1E1C\u1E1E\u1E20\u1E22\u1E24\u1E26\u1E28\u1E2A\u1E2C\u1E2E\u1E30\u1E32\u1E34\u1E36\u1E38\u1E3A\u1E3C\u1E3E\u1E40\u1E42\u1E44\u1E46\u1E48\u1E4A\u1E4C\u1E4E\u1E50\u1E52\u1E54\u1E56\u1E58\u1E5A\u1E5C\u1E5E\u1E60\u1E62\u1E64\u1E66\u1E68\u1E6A\u1E6C\u1E6E\u1E70\u1E72\u1E74\u1E76\u1E78\u1E7A\u1E7C\u1E7E\u1E80\u1E82\u1E84\u1E86\u1E88\u1E8A\u1E8C\u1E8E\u1E90\u1E92\u1E94\u1E9E\u1EA0\u1EA2\u1EA4\u1EA6\u1EA8\u1EAA\u1EAC\u1EAE\u1EB0\u1EB2\u1EB4\u1EB6\u1EB8\u1EBA\u1EBC\u1EBE\u1EC0\u1EC2\u1EC4\u1EC6\u1EC8\u1ECA\u1ECC\u1ECE\u1ED0\u1ED2\u1ED4\u1ED6\u1ED8\u1EDA\u1EDC\u1EDE\u1EE0\u1EE2\u1EE4\u1EE6\u1EE8\u1EEA\u1EEC\u1EEE\u1EF0\u1EF2\u1EF4\u1EF6\u1EF8\u1EFA\u1EFC\u1EFE\u1F08-\u1F0F\u1F18-\u1F1D\u1F28-\u1F2F\u1F38-\u1F3F\u1F48-\u1F4D\u1F59\u1F5B\u1F5D\u1F5F\u1F68-\u1F6F\u1FB8-\u1FBB\u1FC8-\u1FCB\u1FD8-\u1FDB\u1FE8-\u1FEC\u1FF8-\u1FFB\u2102\u2107\u210B-\u210D\u2110-\u2112\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u2130-\u2133\u213E-\u213F\u2145\u2183\u2C00-\u2C2E\u2C60\u2C62-\u2C64\u2C67\u2C69\u2C6B\u2C6D-\u2C70\u2C72\u2C75\u2C7E-\u2C80\u2C82\u2C84\u2C86\u2C88\u2C8A\u2C8C\u2C8E\u2C90\u2C92\u2C94\u2C96\u2C98\u2C9A\u2C9C\u2C9E\u2CA0\u2CA2\u2CA4\u2CA6\u2CA8\u2CAA\u2CAC\u2CAE\u2CB0\u2CB2\u2CB4\u2CB6\u2CB8\u2CBA\u2CBC\u2CBE\u2CC0\u2CC2\u2CC4\u2CC6\u2CC8\u2CCA\u2CCC\u2CCE\u2CD0\u2CD2\u2CD4\u2CD6\u2CD8\u2CDA\u2CDC\u2CDE\u2CE0\u2CE2\u2CEB\u2CED\u2CF2\uA640\uA642\uA644\uA646\uA648\uA64A\uA64C\uA64E\uA650\uA652\uA654\uA656\uA658\uA65A\uA65C\uA65E\uA660\uA662\uA664\uA666\uA668\uA66A\uA66C\uA680\uA682\uA684\uA686\uA688\uA68A\uA68C\uA68E\uA690\uA692\uA694\uA696\uA698\uA69A\uA722\uA724\uA726\uA728\uA72A\uA72C\uA72E\uA732\uA734\uA736\uA738\uA73A\uA73C\uA73E\uA740\uA742\uA744\uA746\uA748\uA74A\uA74C\uA74E\uA750\uA752\uA754\uA756\uA758\uA75A\uA75C\uA75E\uA760\uA762\uA764\uA766\uA768\uA76A\uA76C\uA76E\uA779\uA77B\uA77D-\uA77E\uA780\uA782\uA784\uA786\uA78B\uA78D\uA790\uA792\uA796\uA798\uA79A\uA79C\uA79E\uA7A0\uA7A2\uA7A4\uA7A6\uA7A8\uA7AA-\uA7AD\uA7B0-\uA7B4\uA7B6\uFF21-\uFF3A]/,Ze=Vr([["A","Z"],["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"","",["",""],["",""],"",["",""],"","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],"",["",""],"","","","","","","","","",["",""],"",["",""],["",""],["",""],"",["",""],"","","","","","","","","","","","","","",["",""],["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],"","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],["",""],["",""],["",""],["",""],"","","","",["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],"",["",""],"","","",["",""],["",""],["",""],"","",["",""],"",["",""],"","","",["",""],"","",["",""],"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",["",""],"","","","","","","","","","","","","","","","","","",["",""],["",""],"",["",""]],!1,!1),Ke=/^[\u0903\u093B\u093E-\u0940\u0949-\u094C\u094E-\u094F\u0982-\u0983\u09BE-\u09C0\u09C7-\u09C8\u09CB-\u09CC\u09D7\u0A03\u0A3E-\u0A40\u0A83\u0ABE-\u0AC0\u0AC9\u0ACB-\u0ACC\u0B02-\u0B03\u0B3E\u0B40\u0B47-\u0B48\u0B4B-\u0B4C\u0B57\u0BBE-\u0BBF\u0BC1-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCC\u0BD7\u0C01-\u0C03\u0C41-\u0C44\u0C82-\u0C83\u0CBE\u0CC0-\u0CC4\u0CC7-\u0CC8\u0CCA-\u0CCB\u0CD5-\u0CD6\u0D02-\u0D03\u0D3E-\u0D40\u0D46-\u0D48\u0D4A-\u0D4C\u0D57\u0D82-\u0D83\u0DCF-\u0DD1\u0DD8-\u0DDF\u0DF2-\u0DF3\u0F3E-\u0F3F\u0F7F\u102B-\u102C\u1031\u1038\u103B-\u103C\u1056-\u1057\u1062-\u1064\u1067-\u106D\u1083-\u1084\u1087-\u108C\u108F\u109A-\u109C\u17B6\u17BE-\u17C5\u17C7-\u17C8\u1923-\u1926\u1929-\u192B\u1930-\u1931\u1933-\u1938\u1A19-\u1A1A\u1A55\u1A57\u1A61\u1A63-\u1A64\u1A6D-\u1A72\u1B04\u1B35\u1B3B\u1B3D-\u1B41\u1B43-\u1B44\u1B82\u1BA1\u1BA6-\u1BA7\u1BAA\u1BE7\u1BEA-\u1BEC\u1BEE\u1BF2-\u1BF3\u1C24-\u1C2B\u1C34-\u1C35\u1CE1\u1CF2-\u1CF3\u302E-\u302F\uA823-\uA824\uA827\uA880-\uA881\uA8B4-\uA8C3\uA952-\uA953\uA983\uA9B4-\uA9B5\uA9BA-\uA9BB\uA9BD-\uA9C0\uAA2F-\uAA30\uAA33-\uAA34\uAA4D\uAA7B\uAA7D\uAAEB\uAAEE-\uAAEF\uAAF5\uABE3-\uABE4\uABE6-\uABE7\uABE9-\uABEA\uABEC]/,tn=Vr(["","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"",["",""],"",["",""],["",""],"","",["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","","",["",""],["",""],"","","",["",""],["",""],"","",["",""],"","",["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"","","","",["",""],"",["",""],["",""],["",""],""],!1,!1),en=/^[\u0300-\u036F\u0483-\u0487\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E3-\u0902\u093A\u093C\u0941-\u0948\u094D\u0951-\u0957\u0962-\u0963\u0981\u09BC\u09C1-\u09C4\u09CD\u09E2-\u09E3\u0A01-\u0A02\u0A3C\u0A41-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A51\u0A70-\u0A71\u0A75\u0A81-\u0A82\u0ABC\u0AC1-\u0AC5\u0AC7-\u0AC8\u0ACD\u0AE2-\u0AE3\u0B01\u0B3C\u0B3F\u0B41-\u0B44\u0B4D\u0B56\u0B62-\u0B63\u0B82\u0BC0\u0BCD\u0C00\u0C3E-\u0C40\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C62-\u0C63\u0C81\u0CBC\u0CBF\u0CC6\u0CCC-\u0CCD\u0CE2-\u0CE3\u0D01\u0D41-\u0D44\u0D4D\u0D62-\u0D63\u0DCA\u0DD2-\u0DD4\u0DD6\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0F18-\u0F19\u0F35\u0F37\u0F39\u0F71-\u0F7E\u0F80-\u0F84\u0F86-\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102D-\u1030\u1032-\u1037\u1039-\u103A\u103D-\u103E\u1058-\u1059\u105E-\u1060\u1071-\u1074\u1082\u1085-\u1086\u108D\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B4-\u17B5\u17B7-\u17BD\u17C6\u17C9-\u17D3\u17DD\u180B-\u180D\u18A9\u1920-\u1922\u1927-\u1928\u1932\u1939-\u193B\u1A17-\u1A18\u1A1B\u1A56\u1A58-\u1A5E\u1A60\u1A62\u1A65-\u1A6C\u1A73-\u1A7C\u1A7F\u1AB0-\u1ABD\u1B00-\u1B03\u1B34\u1B36-\u1B3A\u1B3C\u1B42\u1B6B-\u1B73\u1B80-\u1B81\u1BA2-\u1BA5\u1BA8-\u1BA9\u1BAB-\u1BAD\u1BE6\u1BE8-\u1BE9\u1BED\u1BEF-\u1BF1\u1C2C-\u1C33\u1C36-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE0\u1CE2-\u1CE8\u1CED\u1CF4\u1CF8-\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302D\u3099-\u309A\uA66F\uA674-\uA67D\uA69E-\uA69F\uA6F0-\uA6F1\uA802\uA806\uA80B\uA825-\uA826\uA8C4\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA951\uA980-\uA982\uA9B3\uA9B6-\uA9B9\uA9BC\uA9E5\uAA29-\uAA2E\uAA31-\uAA32\uAA35-\uAA36\uAA43\uAA4C\uAA7C\uAAB0\uAAB2-\uAAB4\uAAB7-\uAAB8\uAABE-\uAABF\uAAC1\uAAEC-\uAAED\uAAF6\uABE5\uABE8\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/,nn=Vr([["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"",["",""],["",""],"","",["",""],"",["",""],["",""],"",["",""],["",""],["",""],"",["",""],"",["",""],"",["",""],["",""],"",["",""],"","","",["",""],"","",["",""],"","","","",["",""],["",""],["",""],["",""],["",""],"","","","",["",""],["",""],"",["",""],"",["",""],"",["",""],"","",["",""],["",""],"",["",""],["",""],["",""],["",""],"","","",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"",["",""],"",["",""],["",""],"",["",""],["",""],"","",["",""],"","",["",""],["",""],"",["",""],["",""],"",["",""],"","",["",""],["",""],["",""],["",""],["",""],"",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],"","","",["",""],"",["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],"","","","",["",""],["",""],["",""],"",["",""],"","","","","",["",""],["",""]],!1,!1),rn=/^[0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19]/,sn=Vr([["0","9"],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],!1,!1),un=/^[\u16EE-\u16F0\u2160-\u2182\u2185-\u2188\u3007\u3021-\u3029\u3038-\u303A\uA6E6-\uA6EF]/,on=Vr([["",""],["",""],["",""],"",["",""],["",""],["",""]],!1,!1),an=/^[_\u203F-\u2040\u2054\uFE33-\uFE34\uFE4D-\uFE4F\uFF3F]/,cn=Vr(["_",["",""],"",["",""],["",""],""],!1,!1),ln=/^[ \xA0\u1680\u2000-\u200A\u202F\u205F\u3000]/,pn=Vr([" ","","",["",""],"","",""],!1,!1),hn="break",fn=Mr("break",!1),gn="case",dn=Mr("case",!1),An="catch",mn=Mr("catch",!1),vn="class",En=Mr("class",!1),yn="const",Cn=Mr("const",!1),bn="continue",Fn=Mr("continue",!1),xn="debugger",Dn=Mr("debugger",!1),_n="default",Bn=Mr("default",!1),wn="delete",kn=Mr("delete",!1),Sn="do",Pn=Mr("do",!1),jn="else",On=Mr("else",!1),Nn="enum",$n=Mr("enum",!1),Tn="export",Rn=Mr("export",!1),Ln="extends",In=Mr("extends",!1),Mn="false",Vn=Mr("false",!1),zn="finally",Un=Mr("finally",!1),Hn="for",Jn=Mr("for",!1),Wn="function",qn=Mr("function",!1),Gn="if",Qn=Mr("if",!1),Yn="import",Xn=Mr("import",!1),Zn="instanceof",Kn=Mr("instanceof",!1),tr="in",er=Mr("in",!1),nr="new",rr=Mr("new",!1),sr="null",ir=Mr("null",!1),ur="return",or=Mr("return",!1),ar="super",cr=Mr("super",!1),lr="switch",pr=Mr("switch",!1),hr="this",fr=Mr("this",!1),gr="throw",dr=Mr("throw",!1),Ar="true",mr=Mr("true",!1),vr="try",Er=Mr("try",!1),yr="typeof",Cr=Mr("typeof",!1),br="var",Fr=Mr("var",!1),xr="void",Dr=Mr("void",!1),_r="while",Br=Mr("while",!1),wr="with",kr=Mr("with",!1),Sr=";",Pr=Mr(";",!1),jr=0,Or=0,Nr=[{line:1,column:1}],$r=0,Tr=[],Rr=0;if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');u=i[e.startRule]}function Lr(){return t.substring(Or,jr)}function Ir(){return Hr(Or,jr)}function Mr(t,e){return{type:"literal",text:t,ignoreCase:e}}function Vr(t,e,n){return{type:"class",parts:t,inverted:e,ignoreCase:n}}function zr(t){return{type:"other",description:t}}function Ur(e){var n,r=Nr[e];if(r)return r;for(n=e-1;!Nr[n];)n--;for(r={line:(r=Nr[n]).line,column:r.column};n<e;)10===t.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return Nr[e]=r,r}function Hr(t,e){var n=Ur(t),r=Ur(e);return{start:{offset:t,line:n.line,column:n.column},end:{offset:e,line:r.line,column:r.column}}}function Jr(t){jr<$r||(jr>$r&&($r=jr,Tr=[]),Tr.push(t))}function Wr(t,e,n){return new r(r.buildMessage(t,e),t,e,n)}function qr(){var t,e,n,r,i,u;if(t=jr,Fs()!==s)if(e=jr,(n=function(){var t,e;t=jr,(e=bs())!==s&&xs()!==s?(Or=t,e=a(e),t=e):(jr=t,t=s);return t}())!==s&&(r=Fs())!==s?e=n=[n,r]:(jr=e,e=s),e===s&&(e=null),e!==s){if(n=[],r=jr,(i=Gr())!==s&&(u=Fs())!==s?r=i=[i,u]:(jr=r,r=s),r!==s)for(;r!==s;)n.push(r),r=jr,(i=Gr())!==s&&(u=Fs())!==s?r=i=[i,u]:(jr=r,r=s);else n=s;n!==s?(Or=t,t=o(e,n)):(jr=t,t=s)}else jr=t,t=s;else jr=t,t=s;return t}function Gr(){var e,n,r,i,u,o;return e=jr,(n=as())!==s&&Fs()!==s?(r=jr,(i=ps())!==s&&(u=Fs())!==s?r=i=[i,u]:(jr=r,r=s),r===s&&(r=null),r!==s?(61===t.charCodeAt(jr)?(i=c,jr++):(i=s,0===Rr&&Jr(l)),i!==s&&(u=Fs())!==s&&(o=Qr())!==s&&xs()!==s?(Or=e,e=n=p(n,r,o)):(jr=e,e=s)):(jr=e,e=s)):(jr=e,e=s),e}function Qr(){var e,n,r,i,u,o,a,c;if(e=jr,(n=Yr())!==s){for(r=[],i=jr,(u=Fs())!==s?(47===t.charCodeAt(jr)?(o=h,jr++):(o=s,0===Rr&&Jr(f)),o!==s&&(a=Fs())!==s&&(c=Yr())!==s?i=u=[u,o,a,c]:(jr=i,i=s)):(jr=i,i=s);i!==s;)r.push(i),i=jr,(u=Fs())!==s?(47===t.charCodeAt(jr)?(o=h,jr++):(o=s,0===Rr&&Jr(f)),o!==s&&(a=Fs())!==s&&(c=Yr())!==s?i=u=[u,o,a,c]:(jr=i,i=s)):(jr=i,i=s);r!==s?(Or=e,e=n=g(n,r)):(jr=e,e=s)}else jr=e,e=s;return e}function Yr(){var t,e,n,r,i;return t=jr,(e=function(){var t,e,n,r,i,u;if(t=jr,(e=Xr())!==s){for(n=[],r=jr,(i=Fs())!==s&&(u=Xr())!==s?r=i=[i,u]:(jr=r,r=s);r!==s;)n.push(r),r=jr,(i=Fs())!==s&&(u=Xr())!==s?r=i=[i,u]:(jr=r,r=s);n!==s?(Or=t,e=A(e,n),t=e):(jr=t,t=s)}else jr=t,t=s;return t}())!==s?(n=jr,(r=Fs())!==s&&(i=bs())!==s?n=r=[r,i]:(jr=n,n=s),n===s&&(n=null),n!==s?(Or=t,t=e=d(e,n)):(jr=t,t=s)):(jr=t,t=s),t}function Xr(){var e,n,r,i;return e=jr,(n=function(){var e,n,r;e=jr,n=jr,Rr++,r=function(){var e;(e=function(){var e;(e=function(){var e,n,r,i;e=jr,t.substr(jr,5)===hn?(n=hn,jr+=5):(n=s,0===Rr&&Jr(fn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,4)===gn?(n=gn,jr+=4):(n=s,0===Rr&&Jr(dn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,5)===An?(n=An,jr+=5):(n=s,0===Rr&&Jr(mn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,8)===bn?(n=bn,jr+=8):(n=s,0===Rr&&Jr(Fn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,8)===xn?(n=xn,jr+=8):(n=s,0===Rr&&Jr(Dn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,7)===_n?(n=_n,jr+=7):(n=s,0===Rr&&Jr(Bn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,6)===wn?(n=wn,jr+=6):(n=s,0===Rr&&Jr(kn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,2)===Sn?(n=Sn,jr+=2):(n=s,0===Rr&&Jr(Pn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,4)===jn?(n=jn,jr+=4):(n=s,0===Rr&&Jr(On));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,7)===zn?(n=zn,jr+=7):(n=s,0===Rr&&Jr(Un));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,3)===Hn?(n=Hn,jr+=3):(n=s,0===Rr&&Jr(Jn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,8)===Wn?(n=Wn,jr+=8):(n=s,0===Rr&&Jr(qn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,2)===Gn?(n=Gn,jr+=2):(n=s,0===Rr&&Jr(Qn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,10)===Zn?(n=Zn,jr+=10):(n=s,0===Rr&&Jr(Kn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,2)===tr?(n=tr,jr+=2):(n=s,0===Rr&&Jr(er));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,3)===nr?(n=nr,jr+=3):(n=s,0===Rr&&Jr(rr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,6)===ur?(n=ur,jr+=6):(n=s,0===Rr&&Jr(or));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,6)===lr?(n=lr,jr+=6):(n=s,0===Rr&&Jr(pr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,4)===hr?(n=hr,jr+=4):(n=s,0===Rr&&Jr(fr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,5)===gr?(n=gr,jr+=5):(n=s,0===Rr&&Jr(dr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,3)===vr?(n=vr,jr+=3):(n=s,0===Rr&&Jr(Er));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,6)===yr?(n=yr,jr+=6):(n=s,0===Rr&&Jr(Cr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,3)===br?(n=br,jr+=3):(n=s,0===Rr&&Jr(Fr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,4)===xr?(n=xr,jr+=4):(n=s,0===Rr&&Jr(Dr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,5)===_r?(n=_r,jr+=5):(n=s,0===Rr&&Jr(Br));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,4)===wr?(n=wr,jr+=4):(n=s,0===Rr&&Jr(kr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}());return e}())===s&&(e=function(){var e;(e=function(){var e,n,r,i;e=jr,t.substr(jr,5)===vn?(n=vn,jr+=5):(n=s,0===Rr&&Jr(En));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,5)===yn?(n=yn,jr+=5):(n=s,0===Rr&&Jr(Cn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,4)===Nn?(n=Nn,jr+=4):(n=s,0===Rr&&Jr($n));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,6)===Tn?(n=Tn,jr+=6):(n=s,0===Rr&&Jr(Rn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,7)===Ln?(n=Ln,jr+=7):(n=s,0===Rr&&Jr(In));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,6)===Yn?(n=Yn,jr+=6):(n=s,0===Rr&&Jr(Xn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,5)===ar?(n=ar,jr+=5):(n=s,0===Rr&&Jr(cr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}());return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,4)===sr?(n=sr,jr+=4):(n=s,0===Rr&&Jr(ir));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e;(e=function(){var e,n,r,i;e=jr,t.substr(jr,4)===Ar?(n=Ar,jr+=4):(n=s,0===Rr&&Jr(mr));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r,i;e=jr,t.substr(jr,5)===Mn?(n=Mn,jr+=5):(n=s,0===Rr&&Jr(Vn));n!==s?(r=jr,Rr++,i=ls(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s);return e}());return e}());return e}(),Rr--,r===s?n=void 0:(jr=n,n=s);n!==s&&(r=as())!==s?(Or=e,n=Ct(r),e=n):(jr=e,e=s);return e}())!==s&&Fs()!==s?(58===t.charCodeAt(jr)?(r=m,jr++):(r=s,0===Rr&&Jr(v)),r!==s&&Fs()!==s&&(i=Zr())!==s?(Or=e,e=n=E(n,i)):(jr=e,e=s)):(jr=e,e=s),e===s&&(e=Zr()),e}function Zr(){var e,n,r;return e=jr,(n=function(){var e;36===t.charCodeAt(jr)?(e=C,jr++):(e=s,0===Rr&&Jr(b));e===s&&(38===t.charCodeAt(jr)?(e=F,jr++):(e=s,0===Rr&&Jr(x)),e===s&&(33===t.charCodeAt(jr)?(e=D,jr++):(e=s,0===Rr&&Jr(_))));return e}())!==s&&Fs()!==s&&(r=Kr())!==s?(Or=e,e=n=y(n,r)):(jr=e,e=s),e===s&&(e=Kr()),e}function Kr(){var e,n,r;return e=jr,(n=ts())!==s&&Fs()!==s&&(r=function(){var e;63===t.charCodeAt(jr)?(e=w,jr++):(e=s,0===Rr&&Jr(k));e===s&&(42===t.charCodeAt(jr)?(e=S,jr++):(e=s,0===Rr&&Jr(P)),e===s&&(43===t.charCodeAt(jr)?(e=j,jr++):(e=s,0===Rr&&Jr(O))));return e}())!==s?(Or=e,e=n=B(n,r)):(jr=e,e=s),e===s&&(e=ts()),e}function ts(){var e,n,r,i;return(e=function(){var e,n,r;Rr++,e=jr,(n=ps())!==s?(105===t.charCodeAt(jr)?(r=Nt,jr++):(r=s,0===Rr&&Jr($t)),r===s&&(r=null),r!==s?(Or=e,n=Tt(n,r),e=n):(jr=e,e=s)):(jr=e,e=s);Rr--,e===s&&(n=s,0===Rr&&Jr(Ot));return e}())===s&&(e=function(){var e,n,r,i,u,o;Rr++,e=jr,91===t.charCodeAt(jr)?(n=Jt,jr++):(n=s,0===Rr&&Jr(Wt));if(n!==s)if(94===t.charCodeAt(jr)?(r=qt,jr++):(r=s,0===Rr&&Jr(Gt)),r===s&&(r=null),r!==s){for(i=[],(u=gs())===s&&(u=ds());u!==s;)i.push(u),(u=gs())===s&&(u=ds());i!==s?(93===t.charCodeAt(jr)?(u=Qt,jr++):(u=s,0===Rr&&Jr(Yt)),u!==s?(105===t.charCodeAt(jr)?(o=Nt,jr++):(o=s,0===Rr&&Jr($t)),o===s&&(o=null),o!==s?(Or=e,n=Xt(r,i,o),e=n):(jr=e,e=s)):(jr=e,e=s)):(jr=e,e=s)}else jr=e,e=s;else jr=e,e=s;Rr--,e===s&&(n=s,0===Rr&&Jr(Ht));return e}())===s&&(e=function(){var e,n;e=jr,46===t.charCodeAt(jr)?(n=je,jr++):(n=s,0===Rr&&Jr(Oe));n!==s&&(Or=e,n=Ne());return e=n}())===s&&(e=function(){var e,n,r,i,u,o,a,p;e=jr,(n=as())!==s?(r=jr,Rr++,i=jr,(u=Fs())!==s?(o=jr,(a=ps())!==s&&(p=Fs())!==s?o=a=[a,p]:(jr=o,o=s),o===s&&(o=null),o!==s?(61===t.charCodeAt(jr)?(a=c,jr++):(a=s,0===Rr&&Jr(l)),a!==s?i=u=[u,o,a]:(jr=i,i=s)):(jr=i,i=s)):(jr=i,i=s),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?(Or=e,n=I(n),e=n):(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=function(){var e,n,r;e=jr,(n=function(){var e;38===t.charCodeAt(jr)?(e=F,jr++):(e=s,0===Rr&&Jr(x));e===s&&(33===t.charCodeAt(jr)?(e=D,jr++):(e=s,0===Rr&&Jr(_)));return e}())!==s&&Fs()!==s&&(r=bs())!==s?(Or=e,n=M(n,r),e=n):(jr=e,e=s);return e}())===s&&(e=jr,40===t.charCodeAt(jr)?(n=N,jr++):(n=s,0===Rr&&Jr($)),n!==s&&Fs()!==s&&(r=Qr())!==s&&Fs()!==s?(41===t.charCodeAt(jr)?(i=T,jr++):(i=s,0===Rr&&Jr(R)),i!==s?(Or=e,e=n=L(r)):(jr=e,e=s)):(jr=e,e=s)),e}function es(){var e;return t.length>jr?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(V)),e}function ns(){var e;return Rr++,9===t.charCodeAt(jr)?(e=U,jr++):(e=s,0===Rr&&Jr(H)),e===s&&(11===t.charCodeAt(jr)?(e=J,jr++):(e=s,0===Rr&&Jr(W)),e===s&&(12===t.charCodeAt(jr)?(e=q,jr++):(e=s,0===Rr&&Jr(G)),e===s&&(32===t.charCodeAt(jr)?(e=Q,jr++):(e=s,0===Rr&&Jr(Y)),e===s&&(160===t.charCodeAt(jr)?(e=X,jr++):(e=s,0===Rr&&Jr(Z)),e===s&&(65279===t.charCodeAt(jr)?(e=K,jr++):(e=s,0===Rr&&Jr(tt)),e===s&&(e=function(){var e;ln.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(pn));return e}())))))),Rr--,e===s&&(s,0===Rr&&Jr(z)),e}function rs(){var e;return et.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(nt)),e}function ss(){var e;return Rr++,10===t.charCodeAt(jr)?(e=st,jr++):(e=s,0===Rr&&Jr(it)),e===s&&(t.substr(jr,2)===ut?(e=ut,jr+=2):(e=s,0===Rr&&Jr(ot)),e===s&&(13===t.charCodeAt(jr)?(e=at,jr++):(e=s,0===Rr&&Jr(ct)),e===s&&(8232===t.charCodeAt(jr)?(e=lt,jr++):(e=s,0===Rr&&Jr(pt)),e===s&&(8233===t.charCodeAt(jr)?(e=ht,jr++):(e=s,0===Rr&&Jr(ft)))))),Rr--,e===s&&(s,0===Rr&&Jr(rt)),e}function is(){var e;return Rr++,(e=function(){var e,n,r,i,u,o;e=jr,t.substr(jr,2)===dt?(n=dt,jr+=2):(n=s,0===Rr&&Jr(At));if(n!==s){for(r=[],i=jr,u=jr,Rr++,t.substr(jr,2)===mt?(o=mt,jr+=2):(o=s,0===Rr&&Jr(vt)),Rr--,o===s?u=void 0:(jr=u,u=s),u!==s&&(o=es())!==s?i=u=[u,o]:(jr=i,i=s);i!==s;)r.push(i),i=jr,u=jr,Rr++,t.substr(jr,2)===mt?(o=mt,jr+=2):(o=s,0===Rr&&Jr(vt)),Rr--,o===s?u=void 0:(jr=u,u=s),u!==s&&(o=es())!==s?i=u=[u,o]:(jr=i,i=s);r!==s?(t.substr(jr,2)===mt?(i=mt,jr+=2):(i=s,0===Rr&&Jr(vt)),i!==s?e=n=[n,r,i]:(jr=e,e=s)):(jr=e,e=s)}else jr=e,e=s;return e}())===s&&(e=os()),Rr--,e===s&&(s,0===Rr&&Jr(gt)),e}function us(){var e,n,r,i,u,o;if(e=jr,t.substr(jr,2)===dt?(n=dt,jr+=2):(n=s,0===Rr&&Jr(At)),n!==s){for(r=[],i=jr,u=jr,Rr++,t.substr(jr,2)===mt?(o=mt,jr+=2):(o=s,0===Rr&&Jr(vt)),o===s&&(o=rs()),Rr--,o===s?u=void 0:(jr=u,u=s),u!==s&&(o=es())!==s?i=u=[u,o]:(jr=i,i=s);i!==s;)r.push(i),i=jr,u=jr,Rr++,t.substr(jr,2)===mt?(o=mt,jr+=2):(o=s,0===Rr&&Jr(vt)),o===s&&(o=rs()),Rr--,o===s?u=void 0:(jr=u,u=s),u!==s&&(o=es())!==s?i=u=[u,o]:(jr=i,i=s);r!==s?(t.substr(jr,2)===mt?(i=mt,jr+=2):(i=s,0===Rr&&Jr(vt)),i!==s?e=n=[n,r,i]:(jr=e,e=s)):(jr=e,e=s)}else jr=e,e=s;return e}function os(){var e,n,r,i,u,o;if(e=jr,t.substr(jr,2)===Et?(n=Et,jr+=2):(n=s,0===Rr&&Jr(yt)),n!==s){for(r=[],i=jr,u=jr,Rr++,o=rs(),Rr--,o===s?u=void 0:(jr=u,u=s),u!==s&&(o=es())!==s?i=u=[u,o]:(jr=i,i=s);i!==s;)r.push(i),i=jr,u=jr,Rr++,o=rs(),Rr--,o===s?u=void 0:(jr=u,u=s),u!==s&&(o=es())!==s?i=u=[u,o]:(jr=i,i=s);r!==s?e=n=[n,r]:(jr=e,e=s)}else jr=e,e=s;return e}function as(){var t,e,n,r;if(Rr++,t=jr,(e=cs())!==s){for(n=[],r=ls();r!==s;)n.push(r),r=ls();n!==s?(Or=t,t=e=Ft(e,n)):(jr=t,t=s)}else jr=t,t=s;return Rr--,t===s&&(e=s,0===Rr&&Jr(bt)),t}function cs(){var e,n,r;return(e=function(){var e;(e=function(){var e;Xe.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(Ze));return e}())===s&&(e=function(){var e;Ue.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(He));return e}())===s&&(e=function(){var e;Qe.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(Ye));return e}())===s&&(e=function(){var e;Je.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(We));return e}())===s&&(e=function(){var e;qe.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(Ge));return e}())===s&&(e=function(){var e;un.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(on));return e}());return e}())===s&&(36===t.charCodeAt(jr)?(e=C,jr++):(e=s,0===Rr&&Jr(b)),e===s&&(95===t.charCodeAt(jr)?(e=xt,jr++):(e=s,0===Rr&&Jr(Dt)),e===s&&(e=jr,92===t.charCodeAt(jr)?(n=_t,jr++):(n=s,0===Rr&&Jr(Bt)),n!==s&&(r=Es())!==s?(Or=e,e=n=wt(r)):(jr=e,e=s)))),e}function ls(){var e;return(e=cs())===s&&(e=function(){var e;(e=function(){var e;en.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(nn));return e}())===s&&(e=function(){var e;Ke.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(tn));return e}());return e}())===s&&(e=function(){var e;rn.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(sn));return e}())===s&&(e=function(){var e;an.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(cn));return e}())===s&&(8204===t.charCodeAt(jr)?(e=kt,jr++):(e=s,0===Rr&&Jr(St)),e===s&&(8205===t.charCodeAt(jr)?(e=Pt,jr++):(e=s,0===Rr&&Jr(jt)))),e}function ps(){var e,n,r,i;if(Rr++,e=jr,34===t.charCodeAt(jr)?(n=Lt,jr++):(n=s,0===Rr&&Jr(It)),n!==s){for(r=[],i=hs();i!==s;)r.push(i),i=hs();r!==s?(34===t.charCodeAt(jr)?(i=Lt,jr++):(i=s,0===Rr&&Jr(It)),i!==s?(Or=e,e=n=Mt(r)):(jr=e,e=s)):(jr=e,e=s)}else jr=e,e=s;if(e===s)if(e=jr,39===t.charCodeAt(jr)?(n=Vt,jr++):(n=s,0===Rr&&Jr(zt)),n!==s){for(r=[],i=fs();i!==s;)r.push(i),i=fs();r!==s?(39===t.charCodeAt(jr)?(i=Vt,jr++):(i=s,0===Rr&&Jr(zt)),i!==s?(Or=e,e=n=Mt(r)):(jr=e,e=s)):(jr=e,e=s)}else jr=e,e=s;return Rr--,e===s&&(n=s,0===Rr&&Jr(Rt)),e}function hs(){var e,n,r;return e=jr,n=jr,Rr++,34===t.charCodeAt(jr)?(r=Lt,jr++):(r=s,0===Rr&&Jr(It)),r===s&&(92===t.charCodeAt(jr)?(r=_t,jr++):(r=s,0===Rr&&Jr(Bt)),r===s&&(r=rs())),Rr--,r===s?n=void 0:(jr=n,n=s),n!==s&&(r=es())!==s?(Or=e,e=n=Ut()):(jr=e,e=s),e===s&&(e=jr,92===t.charCodeAt(jr)?(n=_t,jr++):(n=s,0===Rr&&Jr(Bt)),n!==s&&(r=ms())!==s?(Or=e,e=n=wt(r)):(jr=e,e=s),e===s&&(e=As())),e}function fs(){var e,n,r;return e=jr,n=jr,Rr++,39===t.charCodeAt(jr)?(r=Vt,jr++):(r=s,0===Rr&&Jr(zt)),r===s&&(92===t.charCodeAt(jr)?(r=_t,jr++):(r=s,0===Rr&&Jr(Bt)),r===s&&(r=rs())),Rr--,r===s?n=void 0:(jr=n,n=s),n!==s&&(r=es())!==s?(Or=e,e=n=Ut()):(jr=e,e=s),e===s&&(e=jr,92===t.charCodeAt(jr)?(n=_t,jr++):(n=s,0===Rr&&Jr(Bt)),n!==s&&(r=ms())!==s?(Or=e,e=n=wt(r)):(jr=e,e=s),e===s&&(e=As())),e}function gs(){var e,n,r,i;return e=jr,(n=ds())!==s?(45===t.charCodeAt(jr)?(r=Zt,jr++):(r=s,0===Rr&&Jr(Kt)),r!==s&&(i=ds())!==s?(Or=e,e=n=te(n,i)):(jr=e,e=s)):(jr=e,e=s),e}function ds(){var e,n,r;return e=jr,n=jr,Rr++,93===t.charCodeAt(jr)?(r=Qt,jr++):(r=s,0===Rr&&Jr(Yt)),r===s&&(92===t.charCodeAt(jr)?(r=_t,jr++):(r=s,0===Rr&&Jr(Bt)),r===s&&(r=rs())),Rr--,r===s?n=void 0:(jr=n,n=s),n!==s&&(r=es())!==s?(Or=e,e=n=Ut()):(jr=e,e=s),e===s&&(e=jr,92===t.charCodeAt(jr)?(n=_t,jr++):(n=s,0===Rr&&Jr(Bt)),n!==s&&(r=ms())!==s?(Or=e,e=n=wt(r)):(jr=e,e=s),e===s&&(e=As())),e}function As(){var e,n;return e=jr,92===t.charCodeAt(jr)?(n=_t,jr++):(n=s,0===Rr&&Jr(Bt)),n!==s&&ss()!==s?(Or=e,e=n=ee()):(jr=e,e=s),e}function ms(){var e,n,r,i;return(e=function(){var e;(e=vs())===s&&(e=function(){var e,n,r;e=jr,n=jr,Rr++,(r=function(){var e;(e=vs())===s&&(e=ys())===s&&(120===t.charCodeAt(jr)?(e=Fe,jr++):(e=s,0===Rr&&Jr(xe)),e===s&&(117===t.charCodeAt(jr)?(e=De,jr++):(e=s,0===Rr&&Jr(_e))));return e}())===s&&(r=rs());Rr--,r===s?n=void 0:(jr=n,n=s);n!==s&&(r=es())!==s?(Or=e,n=Ut(),e=n):(jr=e,e=s);return e}());return e}())===s&&(e=jr,48===t.charCodeAt(jr)?(n=ne,jr++):(n=s,0===Rr&&Jr(re)),n!==s?(r=jr,Rr++,i=ys(),Rr--,i===s?r=void 0:(jr=r,r=s),r!==s?(Or=e,e=n=se()):(jr=e,e=s)):(jr=e,e=s),e===s&&(e=function(){var e,n,r,i,u,o;e=jr,120===t.charCodeAt(jr)?(n=Fe,jr++):(n=s,0===Rr&&Jr(xe));n!==s?(r=jr,i=jr,(u=Cs())!==s&&(o=Cs())!==s?i=u=[u,o]:(jr=i,i=s),(r=i!==s?t.substring(r,jr):i)!==s?(Or=e,n=Be(r),e=n):(jr=e,e=s)):(jr=e,e=s);return e}())===s&&(e=Es())),e}function vs(){var e,n;return 39===t.charCodeAt(jr)?(e=Vt,jr++):(e=s,0===Rr&&Jr(zt)),e===s&&(34===t.charCodeAt(jr)?(e=Lt,jr++):(e=s,0===Rr&&Jr(It)),e===s&&(92===t.charCodeAt(jr)?(e=_t,jr++):(e=s,0===Rr&&Jr(Bt)),e===s&&(e=jr,98===t.charCodeAt(jr)?(n=ie,jr++):(n=s,0===Rr&&Jr(ue)),n!==s&&(Or=e,n=oe()),(e=n)===s&&(e=jr,102===t.charCodeAt(jr)?(n=ae,jr++):(n=s,0===Rr&&Jr(ce)),n!==s&&(Or=e,n=le()),(e=n)===s&&(e=jr,110===t.charCodeAt(jr)?(n=pe,jr++):(n=s,0===Rr&&Jr(he)),n!==s&&(Or=e,n=fe()),(e=n)===s&&(e=jr,114===t.charCodeAt(jr)?(n=ge,jr++):(n=s,0===Rr&&Jr(de)),n!==s&&(Or=e,n=Ae()),(e=n)===s&&(e=jr,116===t.charCodeAt(jr)?(n=me,jr++):(n=s,0===Rr&&Jr(ve)),n!==s&&(Or=e,n=Ee()),(e=n)===s&&(e=jr,118===t.charCodeAt(jr)?(n=ye,jr++):(n=s,0===Rr&&Jr(Ce)),n!==s&&(Or=e,n=be()),e=n)))))))),e}function Es(){var e,n,r,i,u,o,a,c;return e=jr,117===t.charCodeAt(jr)?(n=De,jr++):(n=s,0===Rr&&Jr(_e)),n!==s?(r=jr,i=jr,(u=Cs())!==s&&(o=Cs())!==s&&(a=Cs())!==s&&(c=Cs())!==s?i=u=[u,o,a,c]:(jr=i,i=s),(r=i!==s?t.substring(r,jr):i)!==s?(Or=e,e=n=Be(r)):(jr=e,e=s)):(jr=e,e=s),e}function ys(){var e;return we.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(ke)),e}function Cs(){var e;return Se.test(t.charAt(jr))?(e=t.charAt(jr),jr++):(e=s,0===Rr&&Jr(Pe)),e}function bs(){var e,n,r,i;return Rr++,e=jr,123===t.charCodeAt(jr)?(n=Te,jr++):(n=s,0===Rr&&Jr(Re)),n!==s&&(r=function e(){var n,r,i,u,o,a;n=jr,r=[],i=[],u=jr,o=jr,Rr++,Ve.test(t.charAt(jr))?(a=t.charAt(jr),jr++):(a=s,0===Rr&&Jr(ze));Rr--,a===s?o=void 0:(jr=o,o=s);o!==s&&(a=es())!==s?u=o=[o,a]:(jr=u,u=s);if(u!==s)for(;u!==s;)i.push(u),u=jr,o=jr,Rr++,Ve.test(t.charAt(jr))?(a=t.charAt(jr),jr++):(a=s,0===Rr&&Jr(ze)),Rr--,a===s?o=void 0:(jr=o,o=s),o!==s&&(a=es())!==s?u=o=[o,a]:(jr=u,u=s);else i=s;i===s&&(i=jr,123===t.charCodeAt(jr)?(u=Te,jr++):(u=s,0===Rr&&Jr(Re)),u!==s&&(o=e())!==s?(125===t.charCodeAt(jr)?(a=Le,jr++):(a=s,0===Rr&&Jr(Ie)),a!==s?i=u=[u,o,a]:(jr=i,i=s)):(jr=i,i=s));for(;i!==s;){if(r.push(i),i=[],u=jr,o=jr,Rr++,Ve.test(t.charAt(jr))?(a=t.charAt(jr),jr++):(a=s,0===Rr&&Jr(ze)),Rr--,a===s?o=void 0:(jr=o,o=s),o!==s&&(a=es())!==s?u=o=[o,a]:(jr=u,u=s),u!==s)for(;u!==s;)i.push(u),u=jr,o=jr,Rr++,Ve.test(t.charAt(jr))?(a=t.charAt(jr),jr++):(a=s,0===Rr&&Jr(ze)),Rr--,a===s?o=void 0:(jr=o,o=s),o!==s&&(a=es())!==s?u=o=[o,a]:(jr=u,u=s);else i=s;i===s&&(i=jr,123===t.charCodeAt(jr)?(u=Te,jr++):(u=s,0===Rr&&Jr(Re)),u!==s&&(o=e())!==s?(125===t.charCodeAt(jr)?(a=Le,jr++):(a=s,0===Rr&&Jr(Ie)),a!==s?i=u=[u,o,a]:(jr=i,i=s)):(jr=i,i=s))}n=r!==s?t.substring(n,jr):r;return n}())!==s?(125===t.charCodeAt(jr)?(i=Le,jr++):(i=s,0===Rr&&Jr(Ie)),i!==s?(Or=e,e=n=Me(r)):(jr=e,e=s)):(jr=e,e=s),Rr--,e===s&&(n=s,0===Rr&&Jr($e)),e}function Fs(){var t,e;for(t=[],(e=ns())===s&&(e=ss())===s&&(e=is());e!==s;)t.push(e),(e=ns())===s&&(e=ss())===s&&(e=is());return t}function xs(){var e,n,r,i;return e=jr,(n=Fs())!==s?(59===t.charCodeAt(jr)?(r=Sr,jr++):(r=s,0===Rr&&Jr(Pr)),r!==s?e=n=[n,r]:(jr=e,e=s)):(jr=e,e=s),e===s&&(e=jr,(n=function(){var t,e;for(t=[],(e=ns())===s&&(e=us());e!==s;)t.push(e),(e=ns())===s&&(e=us());return t}())!==s?((r=os())===s&&(r=null),r!==s&&(i=ss())!==s?e=n=[n,r,i]:(jr=e,e=s)):(jr=e,e=s),e===s&&(e=jr,(n=Fs())!==s&&(r=function(){var e,n;e=jr,Rr++,t.length>jr?(n=t.charAt(jr),jr++):(n=s,0===Rr&&Jr(V));Rr--,n===s?e=void 0:(jr=e,e=s);return e}())!==s?e=n=[n,r]:(jr=e,e=s))),e}var Ds={$:"text","&":"simple_and","!":"simple_not"},_s={"?":"optional","*":"zero_or_more","+":"one_or_more"},Bs={"&":"semantic_and","!":"semantic_not"};function ws(t){var e,n=[];for(e=0;e<t.length;e++)""!==t[e]&&n.push(t[e]);return n}function ks(t,e){var n,r=new Array(t.length);for(n=0;n<t.length;n++)r[n]=t[n][e];return r}function Ss(t,e,n){return[t].concat(ks(e,n))}if((n=u())!==s&&jr===t.length)return n;throw n!==s&&jr<t.length&&Jr({type:"end"}),Wr(Tr,$r<t.length?t.charAt($r):null,$r<t.length?Hr($r,$r+1):Hr($r,$r))}}},function(module,exports,__webpack_require__){"use strict";var arrays=__webpack_require__(44),objects=__webpack_require__(84),compiler={visitor:__webpack_require__(45),passes:{check:{reportUndefinedRules:__webpack_require__(283),reportDuplicateRules:__webpack_require__(284),reportDuplicateLabels:__webpack_require__(285),reportInfiniteRecursion:__webpack_require__(286),reportInfiniteRepetition:__webpack_require__(287)},transform:{removeProxyRules:__webpack_require__(288)},generate:{generateBytecode:__webpack_require__(289),generateJS:__webpack_require__(290)}},compile:function(ast,passes,options){var stage;for(stage in options=void 0!==options?options:{},options=objects.clone(options),objects.defaults(options,{allowedStartRules:[ast.rules[0].name],cache:!1,dependencies:{},exportVar:null,format:"bare",optimize:"speed",output:"parser",trace:!1}),passes)passes.hasOwnProperty(stage)&&arrays.each(passes[stage],(function(t){t(ast,options)}));switch(options.output){case"parser":return eval(ast.code);case"source":return ast.code}}};module.exports=compiler},function(t,e,n){"use strict";var r=n(85),s=n(223),i=n(45);t.exports=function(t){i.build({rule_ref:function(e){if(!s.findRule(t,e.name))throw new r('Rule "'+e.name+'" is not defined.',e.location)}})(t)}},function(t,e,n){"use strict";var r=n(85),s=n(45);t.exports=function(t){var e={};s.build({rule:function(t){if(e.hasOwnProperty(t.name))throw new r('Rule "'+t.name+'" is already defined at line '+e[t.name].start.line+", column "+e[t.name].start.column+".",t.location);e[t.name]=t.location}})(t)}},function(t,e,n){"use strict";var r=n(85),s=n(44),i=n(84),u=n(45);t.exports=function(t){function e(t,e){n(t.expression,i.clone(e))}var n=u.build({rule:function(t){n(t.expression,{})},choice:function(t,e){s.each(t.alternatives,(function(t){n(t,i.clone(e))}))},action:e,labeled:function(t,e){if(e.hasOwnProperty(t.label))throw new r('Label "'+t.label+'" is already defined at line '+e[t.label].start.line+", column "+e[t.label].start.column+".",t.location);n(t.expression,e),e[t.label]=t.location},text:e,simple_and:e,simple_not:e,optional:e,zero_or_more:e,one_or_more:e,group:e});n(t)}},function(t,e,n){"use strict";var r=n(44),s=n(85),i=n(223),u=n(45);t.exports=function(t){var e=[],n=u.build({rule:function(t){e.push(t.name),n(t.expression),e.pop(t.name)},sequence:function(e){r.every(e.elements,(function(e){return n(e),!i.alwaysConsumesOnSuccess(t,e)}))},rule_ref:function(u){if(r.contains(e,u.name))throw e.push(u.name),new s("Possible infinite loop when parsing (left recursion: "+e.join(" -> ")+").",u.location);n(i.findRule(t,u.name))}});n(t)}},function(t,e,n){"use strict";var r=n(85),s=n(223),i=n(45);t.exports=function(t){i.build({zero_or_more:function(e){if(!s.alwaysConsumesOnSuccess(t,e.expression))throw new r("Possible infinite loop when parsing (repetition used with an expression that may not consume any input).",e.location)},one_or_more:function(e){if(!s.alwaysConsumesOnSuccess(t,e.expression))throw new r("Possible infinite loop when parsing (repetition used with an expression that may not consume any input).",e.location)}})(t)}},function(t,e,n){"use strict";var r=n(44),s=n(45);t.exports=function(t,e){var n=[];r.each(t.rules,(function(i,u){var o;"rule"===(o=i).type&&"rule_ref"===o.expression.type&&(!function(t,e,n){s.build({rule_ref:function(t){t.name===e&&(t.name=n)}})(t)}(t,i.name,i.expression.name),r.contains(e.allowedStartRules,i.name)||n.push(u))})),n.reverse(),r.each(n,(function(e){t.rules.splice(e,1)}))}},function(t,e,n){"use strict";var r=n(44),s=n(84),i=n(223),u=n(45),o=n(275),a=n(276);t.exports=function(t){var e=[];function n(t){var n=r.indexOf(e,t);return-1===n?e.push(t)-1:n}function c(t,e){return n("function("+t.join(", ")+") {"+e+"}")}function l(){return Array.prototype.concat.apply([],arguments)}function p(t,e,n){return t.concat([e.length,n.length],e,n)}function h(t,e,n,i){var u=r.map(s.values(n),(function(t){return i-t}));return[o.CALL,t,e,u.length].concat(u)}function f(t,e,n){return l([o.PUSH_CURR_POS],[o.SILENT_FAILS_ON],A(t,{sp:n.sp+1,env:s.clone(n.env),action:null}),[o.SILENT_FAILS_OFF],p([e?o.IF_ERROR:o.IF_NOT_ERROR],l([o.POP],[e?o.POP:o.POP_CURR_POS],[o.PUSH_UNDEFINED]),l([o.POP],[e?o.POP_CURR_POS:o.POP],[o.PUSH_FAILED])))}function g(t,e,n){var r=c(s.keys(n.env),t);return l([o.UPDATE_SAVED_POS],h(r,0,n.env,n.sp),p([o.IF],l([o.POP],e?[o.PUSH_FAILED]:[o.PUSH_UNDEFINED]),l([o.POP],e?[o.PUSH_UNDEFINED]:[o.PUSH_FAILED])))}function d(t){return e=[o.WHILE_NOT_ERROR],n=l([o.APPEND],t),e.concat([n.length],n);var e,n}var A=u.build({grammar:function(t){r.each(t.rules,A),t.consts=e},rule:function(t){t.bytecode=A(t.expression,{sp:-1,env:{},action:null})},named:function(t,e){var r=n('peg$otherExpectation("'+a.stringEscape(t.name)+'")');return l([o.SILENT_FAILS_ON],A(t.expression,e),[o.SILENT_FAILS_OFF],p([o.IF_ERROR],[o.FAIL,r],[]))},choice:function(t,e){return function t(e,n){return l(A(e[0],{sp:n.sp,env:s.clone(n.env),action:null}),e.length>1?p([o.IF_ERROR],l([o.POP],t(e.slice(1),n)),[]):[])}(t.alternatives,e)},action:function(t,e){var n=s.clone(e.env),r="sequence"!==t.expression.type||0===t.expression.elements.length,i=A(t.expression,{sp:e.sp+(r?1:0),env:n,action:t}),u=c(s.keys(n),t.code);return r?l([o.PUSH_CURR_POS],i,p([o.IF_NOT_ERROR],l([o.LOAD_SAVED_POS,1],h(u,1,n,e.sp+2)),[]),[o.NIP]):i},sequence:function(t,e){return l([o.PUSH_CURR_POS],function e(n,r){var i,u;return n.length>0?(i=t.elements.length-n.slice(1).length,l(A(n[0],{sp:r.sp,env:r.env,action:null}),p([o.IF_NOT_ERROR],e(n.slice(1),{sp:r.sp+1,env:r.env,action:r.action}),l(i>1?[o.POP_N,i]:[o.POP],[o.POP_CURR_POS],[o.PUSH_FAILED])))):r.action?(u=c(s.keys(r.env),r.action.code),l([o.LOAD_SAVED_POS,t.elements.length],h(u,t.elements.length,r.env,r.sp),[o.NIP])):l([o.WRAP,t.elements.length],[o.NIP])}(t.elements,{sp:e.sp+1,env:e.env,action:e.action}))},labeled:function(t,e){var n=s.clone(e.env);return e.env[t.label]=e.sp+1,A(t.expression,{sp:e.sp,env:n,action:null})},text:function(t,e){return l([o.PUSH_CURR_POS],A(t.expression,{sp:e.sp+1,env:s.clone(e.env),action:null}),p([o.IF_NOT_ERROR],l([o.POP],[o.TEXT]),[o.NIP]))},simple_and:function(t,e){return f(t.expression,!1,e)},simple_not:function(t,e){return f(t.expression,!0,e)},optional:function(t,e){return l(A(t.expression,{sp:e.sp,env:s.clone(e.env),action:null}),p([o.IF_ERROR],l([o.POP],[o.PUSH_NULL]),[]))},zero_or_more:function(t,e){var n=A(t.expression,{sp:e.sp+1,env:s.clone(e.env),action:null});return l([o.PUSH_EMPTY_ARRAY],n,d(n),[o.POP])},one_or_more:function(t,e){var n=A(t.expression,{sp:e.sp+1,env:s.clone(e.env),action:null});return l([o.PUSH_EMPTY_ARRAY],n,p([o.IF_NOT_ERROR],l(d(n),[o.POP]),l([o.POP],[o.POP],[o.PUSH_FAILED])))},group:function(t,e){return A(t.expression,{sp:e.sp,env:s.clone(e.env),action:null})},semantic_and:function(t,e){return g(t.code,!1,e)},semantic_not:function(t,e){return g(t.code,!0,e)},rule_ref:function(e){return[o.RULE,i.indexOfRule(t,e.name)]},literal:function(t){var e,r;return t.value.length>0?(e=n('"'+a.stringEscape(t.ignoreCase?t.value.toLowerCase():t.value)+'"'),r=n('peg$literalExpectation("'+a.stringEscape(t.value)+'", '+t.ignoreCase+")"),p(t.ignoreCase?[o.MATCH_STRING_IC,e]:[o.MATCH_STRING,e],t.ignoreCase?[o.ACCEPT_N,t.value.length]:[o.ACCEPT_STRING,e],[o.FAIL,r])):(e=n('""'),[o.PUSH,e])},class:function(t){var e,s,i,u;return e=t.parts.length>0?"/^["+(t.inverted?"^":"")+r.map(t.parts,(function(t){return t instanceof Array?a.regexpClassEscape(t[0])+"-"+a.regexpClassEscape(t[1]):a.regexpClassEscape(t)})).join("")+"]/"+(t.ignoreCase?"i":""):t.inverted?"/^[\\S\\s]/":"/^(?!)/",s="["+r.map(t.parts,(function(t){return t instanceof Array?'["'+a.stringEscape(t[0])+'", "'+a.stringEscape(t[1])+'"]':'"'+a.stringEscape(t)+'"'})).join(", ")+"]",i=n(e),u=n("peg$classExpectation("+s+", "+t.inverted+", "+t.ignoreCase+")"),p([o.MATCH_REGEXP,i],[o.ACCEPT_N,1],[o.FAIL,u])},any:function(){var t=n("peg$anyExpectation()");return p([o.MATCH_ANY],[o.ACCEPT_N,1],[o.FAIL,t])}});A(t)}},function(module,exports,__webpack_require__){"use strict";var arrays=__webpack_require__(44),objects=__webpack_require__(84),asts=__webpack_require__(223),op=__webpack_require__(275),js=__webpack_require__(276);function generateJS(ast,options){function indent2(t){return t.replace(/^(.+)$/gm,"  $1")}function indent6(t){return t.replace(/^(.+)$/gm,"      $1")}function indent10(t){return t.replace(/^(.+)$/gm,"          $1")}function generateTables(){return"size"===options.optimize?["peg$consts = [",indent2(ast.consts.join(",\n")),"],","","peg$bytecode = [",indent2(arrays.map(ast.rules,(function(t){return'peg$decode("'+js.stringEscape(arrays.map(t.bytecode,(function(t){return String.fromCharCode(t+32)})).join(""))+'")'})).join(",\n")),"],"].join("\n"):arrays.map(ast.consts,(function(t,e){return"peg$c"+e+" = "+t+","})).join("\n")}function generateRuleHeader(t,e){var n=[];return n.push(""),options.trace&&n.push(["peg$tracer.trace({",'  type:     "rule.enter",',"  rule:     "+t+",","  location: peg$computeLocation(startPos, startPos)","});",""].join("\n")),options.cache&&(n.push(["var key    = peg$currPos * "+ast.rules.length+" + "+e+",","    cached = peg$resultsCache[key];","","if (cached) {","  peg$currPos = cached.nextPos;",""].join("\n")),options.trace&&n.push(["if (cached.result !== peg$FAILED) {","  peg$tracer.trace({",'    type:   "rule.match",',"    rule:   "+t+",","    result: cached.result,","    location: peg$computeLocation(startPos, peg$currPos)","  });","} else {","  peg$tracer.trace({",'    type: "rule.fail",',"    rule: "+t+",","    location: peg$computeLocation(startPos, startPos)","  });","}",""].join("\n")),n.push(["  return cached.result;","}",""].join("\n"))),n.join("\n")}function generateRuleFooter(t,e){var n=[];return options.cache&&n.push(["","peg$resultsCache[key] = { nextPos: peg$currPos, result: "+e+" };"].join("\n")),options.trace&&n.push(["","if ("+e+" !== peg$FAILED) {","  peg$tracer.trace({",'    type:   "rule.match",',"    rule:   "+t+",","    result: "+e+",","    location: peg$computeLocation(startPos, peg$currPos)","  });","} else {","  peg$tracer.trace({",'    type: "rule.fail",',"    rule: "+t+",","    location: peg$computeLocation(startPos, startPos)","  });","}"].join("\n")),n.push(["","return "+e+";"].join("\n")),n.join("\n")}function generateInterpreter(){var t,e=[];function n(t,e){var n=e+3,r="bc[ip + "+(n-2)+"]",s="bc[ip + "+(n-1)+"]";return["ends.push(end);","ips.push(ip + "+n+" + "+r+" + "+s+");","","if ("+t+") {","  end = ip + "+n+" + "+r+";","  ip += "+n+";","} else {","  end = ip + "+n+" + "+r+" + "+s+";","  ip += "+n+" + "+r+";","}","","break;"].join("\n")}return e.push(["function peg$decode(s) {","  var bc = new Array(s.length), i;","","  for (i = 0; i < s.length; i++) {","    bc[i] = s.charCodeAt(i) - 32;","  }","","  return bc;","}","","function peg$parseRule(index) {"].join("\n")),options.trace?e.push(["  var bc       = peg$bytecode[index],","      ip       = 0,","      ips      = [],","      end      = bc.length,","      ends     = [],","      stack    = [],","      startPos = peg$currPos,","      params, i;"].join("\n")):e.push(["  var bc    = peg$bytecode[index],","      ip    = 0,","      ips   = [],","      end   = bc.length,","      ends  = [],","      stack = [],","      params, i;"].join("\n")),e.push(indent2(generateRuleHeader("peg$ruleNames[index]","index"))),e.push(["  while (true) {","    while (ip < end) {","      switch (bc[ip]) {","        case "+op.PUSH+":","          stack.push(peg$consts[bc[ip + 1]]);","          ip += 2;","          break;","","        case "+op.PUSH_UNDEFINED+":","          stack.push(void 0);","          ip++;","          break;","","        case "+op.PUSH_NULL+":","          stack.push(null);","          ip++;","          break;","","        case "+op.PUSH_FAILED+":","          stack.push(peg$FAILED);","          ip++;","          break;","","        case "+op.PUSH_EMPTY_ARRAY+":","          stack.push([]);","          ip++;","          break;","","        case "+op.PUSH_CURR_POS+":","          stack.push(peg$currPos);","          ip++;","          break;","","        case "+op.POP+":","          stack.pop();","          ip++;","          break;","","        case "+op.POP_CURR_POS+":","          peg$currPos = stack.pop();","          ip++;","          break;","","        case "+op.POP_N+":","          stack.length -= bc[ip + 1];","          ip += 2;","          break;","","        case "+op.NIP+":","          stack.splice(-2, 1);","          ip++;","          break;","","        case "+op.APPEND+":","          stack[stack.length - 2].push(stack.pop());","          ip++;","          break;","","        case "+op.WRAP+":","          stack.push(stack.splice(stack.length - bc[ip + 1], bc[ip + 1]));","          ip += 2;","          break;","","        case "+op.TEXT+":","          stack.push(input.substring(stack.pop(), peg$currPos));","          ip++;","          break;","","        case "+op.IF+":",indent10(n("stack[stack.length - 1]",0)),"","        case "+op.IF_ERROR+":",indent10(n("stack[stack.length - 1] === peg$FAILED",0)),"","        case "+op.IF_NOT_ERROR+":",indent10(n("stack[stack.length - 1] !== peg$FAILED",0)),"","        case "+op.WHILE_NOT_ERROR+":",indent10((t="stack[stack.length - 1] !== peg$FAILED",["if ("+t+") {","  ends.push(end);","  ips.push(ip);","","  end = ip + 2 + bc[ip + 1];","  ip += 2;","} else {","  ip += 2 + bc[ip + 1];","}","","break;"].join("\n"))),"","        case "+op.MATCH_ANY+":",indent10(n("input.length > peg$currPos",0)),"","        case "+op.MATCH_STRING+":",indent10(n("input.substr(peg$currPos, peg$consts[bc[ip + 1]].length) === peg$consts[bc[ip + 1]]",1)),"","        case "+op.MATCH_STRING_IC+":",indent10(n("input.substr(peg$currPos, peg$consts[bc[ip + 1]].length).toLowerCase() === peg$consts[bc[ip + 1]]",1)),"","        case "+op.MATCH_REGEXP+":",indent10(n("peg$consts[bc[ip + 1]].test(input.charAt(peg$currPos))",1)),"","        case "+op.ACCEPT_N+":","          stack.push(input.substr(peg$currPos, bc[ip + 1]));","          peg$currPos += bc[ip + 1];","          ip += 2;","          break;","","        case "+op.ACCEPT_STRING+":","          stack.push(peg$consts[bc[ip + 1]]);","          peg$currPos += peg$consts[bc[ip + 1]].length;","          ip += 2;","          break;","","        case "+op.FAIL+":","          stack.push(peg$FAILED);","          if (peg$silentFails === 0) {","            peg$fail(peg$consts[bc[ip + 1]]);","          }","          ip += 2;","          break;","","        case "+op.LOAD_SAVED_POS+":","          peg$savedPos = stack[stack.length - 1 - bc[ip + 1]];","          ip += 2;","          break;","","        case "+op.UPDATE_SAVED_POS+":","          peg$savedPos = peg$currPos;","          ip++;","          break;","","        case "+op.CALL+":",indent10(["params = bc.slice(ip + 4, ip + 4 + bc[ip + 3]);","for (i = 0; i < bc[ip + 3]; i++) {","  params[i] = stack[stack.length - 1 - params[i]];","}","","stack.splice(","  stack.length - bc[ip + 2],","  bc[ip + 2],","  peg$consts[bc[ip + 1]].apply(null, params)",");","","ip += 4 + bc[ip + 3];","break;"].join("\n")),"","        case "+op.RULE+":","          stack.push(peg$parseRule(bc[ip + 1]));","          ip += 2;","          break;","","        case "+op.SILENT_FAILS_ON+":","          peg$silentFails++;","          ip++;","          break;","","        case "+op.SILENT_FAILS_OFF+":","          peg$silentFails--;","          ip++;","          break;","","        default:",'          throw new Error("Invalid opcode: " + bc[ip] + ".");',"      }","    }","","    if (ends.length > 0) {","      end = ends.pop();","      ip = ips.pop();","    } else {","      break;","    }","  }"].join("\n")),e.push(indent2(generateRuleFooter("peg$ruleNames[index]","stack[0]"))),e.push("}"),e.join("\n")}function generateRuleFunction(rule){var parts=[],code;function c(t){return"peg$c"+t}function s(t){return"s"+t}var stack={sp:-1,maxSp:-1,push:function(t){var e=s(++this.sp)+" = "+t+";";return this.sp>this.maxSp&&(this.maxSp=this.sp),e},pop:function(t){var e;return void 0===t?s(this.sp--):(e=arrays.map(arrays.range(this.sp-t+1,this.sp+1),s),this.sp-=t,e)},top:function(){return s(this.sp)},index:function(t){return s(this.sp-t)}};function compile(bc){var ip=0,end=bc.length,parts=[],value;function compileCondition(t,e){var n,r,s,i,u=e+3,o=bc[ip+u-2],a=bc[ip+u-1],c=stack.sp;if(ip+=u,n=compile(bc.slice(ip,ip+o)),s=stack.sp,ip+=o,a>0&&(stack.sp=c,r=compile(bc.slice(ip,ip+a)),i=stack.sp,ip+=a,s!==i))throw new Error("Branches of a condition must move the stack pointer in the same way.");parts.push("if ("+t+") {"),parts.push(indent2(n)),a>0&&(parts.push("} else {"),parts.push(indent2(r))),parts.push("}")}function compileLoop(t){var e,n,r=bc[ip+2-1],s=stack.sp;if(ip+=2,e=compile(bc.slice(ip,ip+r)),n=stack.sp,ip+=r,n!==s)throw new Error("Body of a loop can't move the stack pointer.");parts.push("while ("+t+") {"),parts.push(indent2(e)),parts.push("}")}function compileCall(){var t=bc[ip+4-1],e=c(bc[ip+1])+"("+arrays.map(bc.slice(ip+4,ip+4+t),(function(t){return stack.index(t)})).join(", ")+")";stack.pop(bc[ip+2]),parts.push(stack.push(e)),ip+=4+t}for(;ip<end;)switch(bc[ip]){case op.PUSH:parts.push(stack.push(c(bc[ip+1]))),ip+=2;break;case op.PUSH_CURR_POS:parts.push(stack.push("peg$currPos")),ip++;break;case op.PUSH_UNDEFINED:parts.push(stack.push("void 0")),ip++;break;case op.PUSH_NULL:parts.push(stack.push("null")),ip++;break;case op.PUSH_FAILED:parts.push(stack.push("peg$FAILED")),ip++;break;case op.PUSH_EMPTY_ARRAY:parts.push(stack.push("[]")),ip++;break;case op.POP:stack.pop(),ip++;break;case op.POP_CURR_POS:parts.push("peg$currPos = "+stack.pop()+";"),ip++;break;case op.POP_N:stack.pop(bc[ip+1]),ip+=2;break;case op.NIP:value=stack.pop(),stack.pop(),parts.push(stack.push(value)),ip++;break;case op.APPEND:value=stack.pop(),parts.push(stack.top()+".push("+value+");"),ip++;break;case op.WRAP:parts.push(stack.push("["+stack.pop(bc[ip+1]).join(", ")+"]")),ip+=2;break;case op.TEXT:parts.push(stack.push("input.substring("+stack.pop()+", peg$currPos)")),ip++;break;case op.IF:compileCondition(stack.top(),0);break;case op.IF_ERROR:compileCondition(stack.top()+" === peg$FAILED",0);break;case op.IF_NOT_ERROR:compileCondition(stack.top()+" !== peg$FAILED",0);break;case op.WHILE_NOT_ERROR:compileLoop(stack.top()+" !== peg$FAILED",0);break;case op.MATCH_ANY:compileCondition("input.length > peg$currPos",0);break;case op.MATCH_STRING:compileCondition(eval(ast.consts[bc[ip+1]]).length>1?"input.substr(peg$currPos, "+eval(ast.consts[bc[ip+1]]).length+") === "+c(bc[ip+1]):"input.charCodeAt(peg$currPos) === "+eval(ast.consts[bc[ip+1]]).charCodeAt(0),1);break;case op.MATCH_STRING_IC:compileCondition("input.substr(peg$currPos, "+eval(ast.consts[bc[ip+1]]).length+").toLowerCase() === "+c(bc[ip+1]),1);break;case op.MATCH_REGEXP:compileCondition(c(bc[ip+1])+".test(input.charAt(peg$currPos))",1);break;case op.ACCEPT_N:parts.push(stack.push(bc[ip+1]>1?"input.substr(peg$currPos, "+bc[ip+1]+")":"input.charAt(peg$currPos)")),parts.push(bc[ip+1]>1?"peg$currPos += "+bc[ip+1]+";":"peg$currPos++;"),ip+=2;break;case op.ACCEPT_STRING:parts.push(stack.push(c(bc[ip+1]))),parts.push(eval(ast.consts[bc[ip+1]]).length>1?"peg$currPos += "+eval(ast.consts[bc[ip+1]]).length+";":"peg$currPos++;"),ip+=2;break;case op.FAIL:parts.push(stack.push("peg$FAILED")),parts.push("if (peg$silentFails === 0) { peg$fail("+c(bc[ip+1])+"); }"),ip+=2;break;case op.LOAD_SAVED_POS:parts.push("peg$savedPos = "+stack.index(bc[ip+1])+";"),ip+=2;break;case op.UPDATE_SAVED_POS:parts.push("peg$savedPos = peg$currPos;"),ip++;break;case op.CALL:compileCall();break;case op.RULE:parts.push(stack.push("peg$parse"+ast.rules[bc[ip+1]].name+"()")),ip+=2;break;case op.SILENT_FAILS_ON:parts.push("peg$silentFails++;"),ip++;break;case op.SILENT_FAILS_OFF:parts.push("peg$silentFails--;"),ip++;break;default:throw new Error("Invalid opcode: "+bc[ip]+".")}return parts.join("\n")}return code=compile(rule.bytecode),parts.push("function peg$parse"+rule.name+"() {"),options.trace?parts.push(["  var "+arrays.map(arrays.range(0,stack.maxSp+1),s).join(", ")+",","      startPos = peg$currPos;"].join("\n")):parts.push("  var "+arrays.map(arrays.range(0,stack.maxSp+1),s).join(", ")+";"),parts.push(indent2(generateRuleHeader('"'+js.stringEscape(rule.name)+'"',asts.indexOfRule(ast,rule.name)))),parts.push(indent2(code)),parts.push(indent2(generateRuleFooter('"'+js.stringEscape(rule.name)+'"',s(0)))),parts.push("}"),parts.join("\n")}function generateToplevel(){var t,e,n,r,s,i=[];return i.push(["function peg$subclass(child, parent) {","  function ctor() { this.constructor = child; }","  ctor.prototype = parent.prototype;","  child.prototype = new ctor();","}","","function peg$SyntaxError(message, expected, found, location) {","  this.message  = message;","  this.expected = expected;","  this.found    = found;","  this.location = location;",'  this.name     = "SyntaxError";',"",'  if (typeof Error.captureStackTrace === "function") {',"    Error.captureStackTrace(this, peg$SyntaxError);","  }","}","","peg$subclass(peg$SyntaxError, Error);","","peg$SyntaxError.buildMessage = function(expected, found) {","  var DESCRIBE_EXPECTATION_FNS = {","        literal: function(expectation) {",'          return "\\"" + literalEscape(expectation.text) + "\\"";',"        },","",'        "class": function(expectation) {','          var escapedParts = "",',"              i;","","          for (i = 0; i < expectation.parts.length; i++) {","            escapedParts += expectation.parts[i] instanceof Array",'              ? classEscape(expectation.parts[i][0]) + "-" + classEscape(expectation.parts[i][1])',"              : classEscape(expectation.parts[i]);","          }","",'          return "[" + (expectation.inverted ? "^" : "") + escapedParts + "]";',"        },","","        any: function(expectation) {",'          return "any character";',"        },","","        end: function(expectation) {",'          return "end of input";',"        },","","        other: function(expectation) {","          return expectation.description;","        }","      };","","  function hex(ch) {","    return ch.charCodeAt(0).toString(16).toUpperCase();","  }","","  function literalEscape(s) {","    return s","      .replace(/\\\\/g, '\\\\\\\\')","      .replace(/\"/g,  '\\\\\"')","      .replace(/\\0/g, '\\\\0')","      .replace(/\\t/g, '\\\\t')","      .replace(/\\n/g, '\\\\n')","      .replace(/\\r/g, '\\\\r')","      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })","      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });","  }","","  function classEscape(s) {","    return s","      .replace(/\\\\/g, '\\\\\\\\')","      .replace(/\\]/g, '\\\\]')","      .replace(/\\^/g, '\\\\^')","      .replace(/-/g,  '\\\\-')","      .replace(/\\0/g, '\\\\0')","      .replace(/\\t/g, '\\\\t')","      .replace(/\\n/g, '\\\\n')","      .replace(/\\r/g, '\\\\r')","      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })","      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });","  }","","  function describeExpectation(expectation) {","    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);","  }","","  function describeExpected(expected) {","    var descriptions = new Array(expected.length),","        i, j;","","    for (i = 0; i < expected.length; i++) {","      descriptions[i] = describeExpectation(expected[i]);","    }","","    descriptions.sort();","","    if (descriptions.length > 0) {","      for (i = 1, j = 1; i < descriptions.length; i++) {","        if (descriptions[i - 1] !== descriptions[i]) {","          descriptions[j] = descriptions[i];","          j++;","        }","      }","      descriptions.length = j;","    }","","    switch (descriptions.length) {","      case 1:","        return descriptions[0];","","      case 2:",'        return descriptions[0] + " or " + descriptions[1];',"","      default:",'        return descriptions.slice(0, -1).join(", ")','          + ", or "',"          + descriptions[descriptions.length - 1];","    }","  }","","  function describeFound(found) {",'    return found ? "\\"" + literalEscape(found) + "\\"" : "end of input";',"  }","",'  return "Expected " + describeExpected(expected) + " but " + describeFound(found) + " found.";',"};",""].join("\n")),options.trace&&i.push(["function peg$DefaultTracer() {","  this.indentLevel = 0;","}","","peg$DefaultTracer.prototype.trace = function(event) {","  var that = this;","","  function log(event) {","    function repeat(string, n) {",'       var result = "", i;',"","       for (i = 0; i < n; i++) {","         result += string;","       }","","       return result;","    }","","    function pad(string, length) {",'      return string + repeat(" ", length - string.length);',"    }","",'    if (typeof console === "object") {',"      console.log(",'        event.location.start.line + ":" + event.location.start.column + "-"','          + event.location.end.line + ":" + event.location.end.column + " "','          + pad(event.type, 10) + " "','          + repeat("  ", that.indentLevel) + event.rule',"      );","    }","  }","","  switch (event.type) {",'    case "rule.enter":',"      log(event);","      this.indentLevel++;","      break;","",'    case "rule.match":',"      this.indentLevel--;","      log(event);","      break;","",'    case "rule.fail":',"      this.indentLevel--;","      log(event);","      break;","","    default:",'      throw new Error("Invalid event type: " + event.type + ".");',"  }","};",""].join("\n")),i.push(["function peg$parse(input, options) {","  options = options !== void 0 ? options : {};","","  var peg$FAILED = {},",""].join("\n")),"size"===options.optimize?(t="{ "+arrays.map(options.allowedStartRules,(function(t){return t+": "+asts.indexOfRule(ast,t)})).join(", ")+" }",e=asts.indexOfRule(ast,options.allowedStartRules[0]),i.push(["      peg$startRuleIndices = "+t+",","      peg$startRuleIndex   = "+e+","].join("\n"))):(n="{ "+arrays.map(options.allowedStartRules,(function(t){return t+": peg$parse"+t})).join(", ")+" }",r="peg$parse"+options.allowedStartRules[0],i.push(["      peg$startRuleFunctions = "+n+",","      peg$startRuleFunction  = "+r+","].join("\n"))),i.push(""),i.push(indent6(generateTables())),i.push(["","      peg$currPos          = 0,","      peg$savedPos         = 0,","      peg$posDetailsCache  = [{ line: 1, column: 1 }],","      peg$maxFailPos       = 0,","      peg$maxFailExpected  = [],","      peg$silentFails      = 0,",""].join("\n")),options.cache&&i.push(["      peg$resultsCache = {},",""].join("\n")),options.trace&&("size"===options.optimize&&(s="["+arrays.map(ast.rules,(function(t){return'"'+js.stringEscape(t.name)+'"'})).join(", ")+"]",i.push(["      peg$ruleNames = "+s+",",""].join("\n"))),i.push(['      peg$tracer = "tracer" in options ? options.tracer : new peg$DefaultTracer(),',""].join("\n"))),i.push(["      peg$result;",""].join("\n")),"size"===options.optimize?i.push(['  if ("startRule" in options) {',"    if (!(options.startRule in peg$startRuleIndices)) {",'      throw new Error("Can\'t start parsing from rule \\"" + options.startRule + "\\".");',"    }","","    peg$startRuleIndex = peg$startRuleIndices[options.startRule];","  }"].join("\n")):i.push(['  if ("startRule" in options) {',"    if (!(options.startRule in peg$startRuleFunctions)) {",'      throw new Error("Can\'t start parsing from rule \\"" + options.startRule + "\\".");',"    }","","    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];","  }"].join("\n")),i.push(["","  function text() {","    return input.substring(peg$savedPos, peg$currPos);","  }","","  function location() {","    return peg$computeLocation(peg$savedPos, peg$currPos);","  }","","  function expected(description, location) {","    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)","","    throw peg$buildStructuredError(","      [peg$otherExpectation(description)],","      input.substring(peg$savedPos, peg$currPos),","      location","    );","  }","","  function error(message, location) {","    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)","","    throw peg$buildSimpleError(message, location);","  }","","  function peg$literalExpectation(text, ignoreCase) {",'    return { type: "literal", text: text, ignoreCase: ignoreCase };',"  }","","  function peg$classExpectation(parts, inverted, ignoreCase) {",'    return { type: "class", parts: parts, inverted: inverted, ignoreCase: ignoreCase };',"  }","","  function peg$anyExpectation() {",'    return { type: "any" };',"  }","","  function peg$endExpectation() {",'    return { type: "end" };',"  }","","  function peg$otherExpectation(description) {",'    return { type: "other", description: description };',"  }","","  function peg$computePosDetails(pos) {","    var details = peg$posDetailsCache[pos], p;","","    if (details) {","      return details;","    } else {","      p = pos - 1;","      while (!peg$posDetailsCache[p]) {","        p--;","      }","","      details = peg$posDetailsCache[p];","      details = {","        line:   details.line,","        column: details.column","      };","","      while (p < pos) {","        if (input.charCodeAt(p) === 10) {","          details.line++;","          details.column = 1;","        } else {","          details.column++;","        }","","        p++;","      }","","      peg$posDetailsCache[pos] = details;","      return details;","    }","  }","","  function peg$computeLocation(startPos, endPos) {","    var startPosDetails = peg$computePosDetails(startPos),","        endPosDetails   = peg$computePosDetails(endPos);","","    return {","      start: {","        offset: startPos,","        line:   startPosDetails.line,","        column: startPosDetails.column","      },","      end: {","        offset: endPos,","        line:   endPosDetails.line,","        column: endPosDetails.column","      }","    };","  }","","  function peg$fail(expected) {","    if (peg$currPos < peg$maxFailPos) { return; }","","    if (peg$currPos > peg$maxFailPos) {","      peg$maxFailPos = peg$currPos;","      peg$maxFailExpected = [];","    }","","    peg$maxFailExpected.push(expected);","  }","","  function peg$buildSimpleError(message, location) {","    return new peg$SyntaxError(message, null, null, location);","  }","","  function peg$buildStructuredError(expected, found, location) {","    return new peg$SyntaxError(","      peg$SyntaxError.buildMessage(expected, found),","      expected,","      found,","      location","    );","  }",""].join("\n")),"size"===options.optimize?(i.push(indent2(generateInterpreter())),i.push("")):arrays.each(ast.rules,(function(t){i.push(indent2(generateRuleFunction(t))),i.push("")})),ast.initializer&&(i.push(indent2(ast.initializer.code)),i.push("")),"size"===options.optimize?i.push("  peg$result = peg$parseRule(peg$startRuleIndex);"):i.push("  peg$result = peg$startRuleFunction();"),i.push(["","  if (peg$result !== peg$FAILED && peg$currPos === input.length) {","    return peg$result;","  } else {","    if (peg$result !== peg$FAILED && peg$currPos < input.length) {","      peg$fail(peg$endExpectation());","    }","","    throw peg$buildStructuredError(","      peg$maxFailExpected,","      peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,","      peg$maxFailPos < input.length","        ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)","        : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)","    );","  }","}"].join("\n")),i.join("\n")}function generateWrapper(t){function e(){return["/*"," * Generated by PEG.js 0.10.0."," *"," * http://pegjs.org/"," */"].join("\n")}function n(){return options.trace?["{","  SyntaxError:   peg$SyntaxError,","  DefaultTracer: peg$DefaultTracer,","  parse:         peg$parse","}"].join("\n"):["{","  SyntaxError: peg$SyntaxError,","  parse:       peg$parse","}"].join("\n")}return{bare:function(){return[e(),"(function() {",'  "use strict";',"",indent2(t),"",indent2("return "+n()+";"),"})()"].join("\n")},commonjs:function(){var r=[],s=objects.keys(options.dependencies),i=arrays.map(s,(function(t){return t+' = require("'+js.stringEscape(options.dependencies[t])+'")'}));return r.push([e(),"",'"use strict";',""].join("\n")),i.length>0&&(r.push("var "+i.join(", ")+";"),r.push("")),r.push([t,"","module.exports = "+n()+";",""].join("\n")),r.join("\n")},amd:function(){var r=objects.values(options.dependencies),s=objects.keys(options.dependencies),i="["+arrays.map(r,(function(t){return'"'+js.stringEscape(t)+'"'})).join(", ")+"]",u=s.join(", ");return[e(),"define("+i+", function("+u+") {",'  "use strict";',"",indent2(t),"",indent2("return "+n()+";"),"});",""].join("\n")},globals:function(){return[e(),"(function(root) {",'  "use strict";',"",indent2(t),"",indent2("root."+options.exportVar+" = "+n()+";"),"})(this);",""].join("\n")},umd:function(){var r=[],s=objects.values(options.dependencies),i=objects.keys(options.dependencies),u="["+arrays.map(s,(function(t){return'"'+js.stringEscape(t)+'"'})).join(", ")+"]",o=arrays.map(s,(function(t){return'require("'+js.stringEscape(t)+'")'})).join(", "),a=i.join(", ");return r.push([e(),"(function(root, factory) {",'  if (typeof define === "function" && define.amd) {',"    define("+u+", factory);",'  } else if (typeof module === "object" && module.exports) {',"    module.exports = factory("+o+");"].join("\n")),null!==options.exportVar&&r.push(["  } else {","    root."+options.exportVar+" = factory();"].join("\n")),r.push(["  }","})(this, function("+a+") {",'  "use strict";',"",indent2(t),"",indent2("return "+n()+";"),"});",""].join("\n")),r.join("\n")}}[options.format]()}ast.code=generateWrapper(generateToplevel())}module.exports=generateJS},function(t,e){t.exports="\n{\n    var _\n\n    if (typeof window == 'undefined') {\n        _ = require('lodash')\n    }\n    else {\n        _ = window._\n    }\n    \n    const DEEP_NAME = '__deepIndex'\n\n    var pushIns = []\n\n    function increment(variable, sign, expression, variables=[]) {\n        let _var\n       \n        if (variable.variable){\n            _var = variable\n        }\n        else {\n            _var = { variable }\n        }\n\n        const value = {\n            variables: [_var, ...variables],\n            expression: `{0}${sign.charAt(0)}${expression}`\n        }\n\n        if (variable.variable) {\n            _var = {}\n            for (let key in variable) {\n                if (key == 'type') {\n                    _var[key] = 'assignObject'\n                    continue\n                }\n                _var[key] = variable[key]\n            }\n        }\n\n        return _.merge(_var, { value })\n    }\n\n    function stringParser(text) {\n        let variables = []\n        let index = -1\n        text = text\n            .map(letter => {\n                if (_.isString(letter)) return letter\n                variables.push(letter)\n                index++\n                return '{' + index + '}'\n            })\n            .join('')\n        if (variables.length == 0) {\n            return text\n        }\n        return {\n            text,\n            variables\n        }\n    }\n\n    function normalizeIns(instructions) {\n        return instructions\n            .reduce((acc, val) => acc.concat(val), [])\n            .filter(it => it)\n    }\n\n}\n\n    \nStart\n    = InstructionList\n\nInstructionList\n    = _ list:Instruction* _ {\n        return list.filter(it => it)\n    }\n\nInstruction\n    = _ decorators:DecoratorList? _ ins:(Comment / Condition / ForOfLoop / Increment / Assign / AssignObject / Function / ExecuteFunction) Nl* _ {\n        const _location = location()\n        if (ins) {\n            ins._file = _location\n            if (decorators) {\n                ins.decorators = decorators\n            }\n        }\n        return ins\n    }\n\n// Assign Variable\n\nDeepArray\n    = index:(_ '[' _ Value _ ']')+ {\n        let deep = []\n        for (let val of index) {\n            deep.push(val[3])\n        }\n        return deep\n    }\n\nGetObject\n    = variable:Variable _ deep:(DeepObject / DeepArray)+ {\n         deep = _.flatten(deep)\n         return { variable, deep, type: 'object' }\n    }\n\nDeepObject\n    = deep:('.' _ Variable S DeepArray?)+ {\n        let array = []\n        for (let d of deep) {\n            array.push(d[2])\n            if (d[4]) {\n                array = array.concat(d[4])\n            }\n        }\n        return array\n    }\n\nIncrementVariable\n    = variable:(GetObject / Variable) {\n        return variable\n    }\n\nIncrement\n    = variable:IncrementVariable _ sign:('++' / '--') {\n         return increment(variable, sign, 1)\n    }\n    / IncrementExpression\n\nIncrementExpression\n    = variable:IncrementVariable _ sign:('+=' / '-=') _ expr:Expression {\n        let { variables, expression } = expr\n        if (!variables) variables = []\n        if (expression) {\n            expression = expression.replace(/\\{([0-9]+)\\}/g, (match, index) => {\n                return `{${+index+1}}`\n            })\n        }\n        else if (expr.variable) {\n            expression = '{1}'\n            variables.push(expr)\n        }\n        else {\n            expression = expr\n        }\n        return increment(variable, sign, expression, variables)\n    }\n\nAssign\n    = variable:Variable _ value:RightAssign {\n        return { variable, value }\n    }\n\nAssignObject\n    = object:GetObject _ value:RightAssign {\n        object.type = 'assignObject'\n        object.value = value\n        return object\n    }\n\n\nRightAssign \n    = '=' _ value:(Value) {\n        return value\n    }\n\nValue =  \n    RegExp / StringBackQuote / String / Null / Array / obj:Object { \n        // Clean __deepIndex\n        const index = obj[DEEP_NAME]\n        if (!index) return obj\n        for (let address of index) {\n            let subobj = _.get(obj, address.replace(/\\.[^.]+$/, ''))\n            delete subobj[DEEP_NAME]\n        }\n        return obj\n    } / Expression\n\n// For Loop\n\nForLoop\n    = 'for' _ '(' _ assign:Assign _ ';' _ condition:Expression _ ';' _ increment:Increment _ ')' _ instructions:ConditionInstruction {\n   \n    } \n\nForOfLoop\n    = 'for' _ '(' _  varLocal:VariableName _ 'of' _ array:Value _ ')' _ instructions:ConditionInstruction {\n        let obj = { varLocal, array, instructions }\n        obj.loop = true\n        return obj\n    }\n\n// Condition\n\nCondition \n    = keyword:('while' / 'if'?) _ '(' _ special:SpecialKeyword? _ condition:Expression _ ')' _ instructions:ConditionInstruction  _ conditionsElse:ConditionElse? {\n        let obj = { condition, instructions, conditionsElse }\n        if (keyword == 'while') {\n            obj.loop = true\n        }\n        if (special) {\n            obj.keyword = special\n        }\n        return obj\n    }\n\nConditionInstruction\n    = '{' _  instructions:InstructionFunction* _ '}' {\n        return normalizeIns(instructions)\n    }\n     / instruction:InstructionFunction {\n        return [instruction]\n    }\n\nConditionSign \n    = keyword:('and' / '&&' / 'or' / '||' / 'xor' / ([><=!] '=') / '<' / '>') {\n        if (keyword == '&&') keyword = 'and'\n        if (keyword == '||') keyword = 'or'\n        if (_.isArray(keyword)) keyword = keyword.join('')\n        return ' ' + keyword + ' '\n    }\n\nConditionElse =\n    'else' _ ins:(instructions:ConditionInstruction / instructions:Condition*)  {\n        return {\n            instructions: ins\n        }\n    }\n\nSpecialKeyword\n    = 'unknown' / 'defined'\n\nNot\n    = keyword:('!' / 'not') {\n        if (keyword == '!') keyword = 'not'\n        return keyword + ' '\n    }\n\n// Expression\n\nExpression \"expression\"\n  =  head:(Not? _ Factor) tail:( [ ]* (ConditionSign / '+' / '-' / '**' / '*' / '/' / '%' ) _ Factor)* {\n\n        const not = head[0]\n        const isExpr = tail.length > 0 || not\n\n        head = head[2]\n\n        let result = head\n        let variables = []\n        let ret = {}\n        let j=0\n\n        const isVariable = obj => obj.variable || obj.type === 'executeFn'\n\n        if (isExpr && isVariable(head)) {\n            variables.push(head)\n            result = '{' + j + '}'\n            j++\n        }\n\n        for (let i = 0; i < tail.length; i++) {\n            let val = tail[i][3]\n            if (isVariable(val)) {\n                variables.push(val)\n                result += tail[i][1] +  '{' + j + '}'\n                j++\n                continue\n            }\n            result += tail[i][1] + val\n        }\n\n        if (not) {\n            result = not + result\n        }\n\n        if (!isExpr) {\n            if (!_.isNaN(+head) && !_.isBoolean(head)) {\n                head = +head\n            }\n            return head\n        }\n\n        if (variables.length > 0) {\n            ret.variables = variables\n        }\n        ret.expression = result\n\n        return ret\n    }\n\nFactor\n  = \"(\" _ expr:Expression _ \")\" { \n       if (expr.expression) {\n           expr = expr.expression\n       }\n       return '(' + expr + ')'\n    }\n  / Integer / fn:ExecuteFunction {\n      let name = fn.name\n      pushIns.push(fn)\n      if (name.type == 'object') {\n        name = name.variable + '-' + name.deep.join('-')\n      }\n      return {\n          variable: '__return_' + name\n      }\n  } / StringInExpression / Boolean\n  / GetObject / VariableName\n\n// Group\n\nGroup\n    = '---' _ group:Text+ _ '---' {\n        return { group }\n    }\n\n// Text\n\nText \n    = '>' _ text:(CharText)* _ params:Array? {\n        text = stringParser(text)\n        if (_.isString(text)) {\n            text = text.trim()\n        }\n        return { output: text, params }\n    }\n\nVariable \"variable\" = name:([\\$:]? [a-zA-Z_0-9]+) { \n        return text() \n    }\n\nVariableName\n    = Variable {\n        return { variable : text() }\n    } \n\n// Execute Fonction\n\nExecuteFunction\n    = name:(GetObject / Variable) \"\\n\"* '(' _ params:Params* _ ')' {\n        return { type: 'executeFn', name, params }\n    }\n\nParams\n    = val:Value _ ','? _ {\n        return val\n    }\n\n// Decorator\n\nDecoratorList\n    = decorators:Decorator* {\n        return decorators\n    }\n    \n\nDecorator 'decorator' \n    = '@' name:DecoratorName _ '(' _ params:Params* _ ')' _ instructions:('{' _ DecoratorInstruction* _ '}')? Nl* {\n        let obj = { name, params }\n        if (instructions) obj.instructions = instructions[2]\n        return obj\n    }\n\nDecoratorName = [A-Z][a-z]+ {\n    return text()\n}\n\n\nDecoratorInstruction\n    = _ ins:(InstructionFunction) _ Nl* {\n        return ins\n    }\n\n// Types\n\nFunction 'function'\n    = name:Variable _ '(' _ params:FunctionParameters? _ ')' _ '{' _  instructions:InstructionFunction* _ '}' {\n        instructions = normalizeIns(instructions)\n        return { name, params, type: 'function', instructions }\n    }\n\nFunctionParameters 'function parameters'\n    = params:(_ Variable _ ','?)+ {\n        return params.map(p => p[1])\n    }\n\nFunctionReturn 'function return'\n    = 'return' _ functionReturn:Value? {\n        return { 'return': functionReturn }\n    }\n\nInstructionFunction\n    = _ ins:(Instruction / InstructionText / FunctionReturn) Nl* _ {\n        if (pushIns.length > 0) {\n            let multiIns = [...pushIns, ins]\n            pushIns = []\n            return multiIns\n        }\n        return ins\n    }\n\nInstructionText\n    = _ decorators:DecoratorList? _ output:(Text / Group) {\n        if (decorators) {\n            output.decorators = decorators\n        }\n        return output\n    }\n\nObject 'object'\n    = '{' _ keys:( _ Variable _ ':' _ Value _ ','?)* _ '}' { \n        const realObject = {}\n        for (let object of keys) {\n            let key = object[1]\n            let val = object[5]\n            realObject[key] = val\n            if (!realObject[DEEP_NAME]) realObject[DEEP_NAME] = []\n            if (val[DEEP_NAME] && val[DEEP_NAME].length !== 0) {\n                realObject[DEEP_NAME] = [...realObject[DEEP_NAME], ...val[DEEP_NAME].map(d => key + '.' + d)]\n            }\n            else {\n                realObject[DEEP_NAME].push(key)\n            }\n        }\n        return realObject\n    }\n\nArray 'array'\n    = '[' _ array:(_ Value _ ','?)* _ ']' { \n        const realArray = []\n        for (let val of array) {\n            realArray.push(val[1])\n        }\n        return realArray\n    }\n\nInteger 'integer'\n    = [-+]? _ [0-9]+ S ( Dot [0-9]+)? { \n        return +text() \n    }\n\nVariableString\n    = '{' _ value:Value _ '}' {\n        return { value }\n    }\n\nStringInExpression 'string in expression'\n    = str: String {\n        const withQuote = text => `\"${text}\"`\n        if (str.variables) {\n            return withQuote(str.text)\n        }\n        return withQuote(str)\n    }\n\nString 'string'\n  = Quote text: NotQuote* Quote { \n      return stringParser(text)\n  }\n\nStringBackQuote 'string not parsed'\n  = BackQuote t: NotBackQuote* BackQuote { \n      return t.join('')\n  }\n\nRegExp 'Regular Expression'\n    = Slash _  regexp: NotSlash* _ Slash flags:[gimuy]* {\n        return { regexp: regexp.join(''), flags }\n    }\n\nBoolean = bool:('true' / 'false') { \n    return bool == 'true' ? true : false\n}\n\nNull = 'null' {\n    return null\n}\n\n// Comment\n\nComment\n    = MultiComment / SingleComment\n\nMultiComment\n    = '/*' (!'*/' .)* '*/'  {\n        return \n    }\n\nSingleComment = '//' [^\\n]* {\n        return \n    }\n\n// Characters\n\nCharText\n  = char:(VariableString / [^\\n\\[]) { return char }\nNotQuote\n  = !Quote char:(VariableString / .) { return char }\n\nQuote = [']\n\nSlash = [/]\nNotSlash = !Slash char:(.) { return char }\n\nBackQuote = '`'\n\nNotBackQuote = !BackQuote char:. { return char }\n\nDot = '.'\n\nNl = \"\\n\"\n\nS = [ \\t]*\n\n_ 'whitespace' = [ \\t\\n\\r]*\n"}]);